<html>
<!-- Mirrored from nnc3.com/mags/Networking2/fire/ch27_04.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 28 Jul 2017 17:51:41 GMT -->
<head><title>Planning Your Response (Building Internet Firewalls, 2nd Edition)</title><link rel="stylesheet" type="text/css" href="../style/style1.css" />

<meta name="DC.Creator" content="Elizabeth D. Zwicky, Simon Cooper and D. Brent Chapman" /><meta name="DC.Format" content="text/xml" scheme="MIME" /><meta name="DC.Language" content="en-US" /><meta name="DC.Publisher" content="O'Reilly &amp; Associates, Inc." /><meta name="DC.Source" scheme="ISBN" content="1565928717L" /><meta name="DC.Subject.Keyword" content="stuff" /><meta name="DC.Title" content="Building Internet Firewalls, 2nd Edition" /><meta name="DC.Type" content="Text.Monograph" />

</head><body bgcolor="#ffffff">

<img alt="Book Home" border="0" src="gifs/smbanner.gif" usemap="#banner-map" /><map name="banner-map"><area shape="rect" coords="1,-2,616,66" href="index-2.html" alt="Building Internet Firewalls" /><area shape="rect" coords="629,-11,726,25" href="jobjects/fsearch.html" alt="Search this book" /></map>

<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch27_03.html"><img alt="Previous" border="0" src="../gifs/txtpreva.gif" /></a></td><td align="center" valign="top" width="228"></td><td align="right" valign="top" width="228"><a href="ch27_05.html"><img alt="Next" border="0" src="../gifs/txtnexta.gif" /></a></td></tr></table><div>



<h2 class="sect1">27.4. Planning Your Response</h2>





All of the actions we've outlined in the previous sections
sound fine in theory, but you can't actually do any of them
reliably without an incident response plan. You may personally be
able to mount a sensible response to an attack, but you aren't
necessarily going to be the person who discovers one. You may not
even be available at the time. How will your organization react if
someone attacks your system? Unless you have an incident response
plan in place, the people involved will waste valuable time trying to
figure out what to do first.</p><p>





If you already have a plan in place for disaster or emergency
response of any kind (e.g., fire, earthquake, electrical problems),
you're probably not going to have to change it significantly to
meet your security needs. If you don't have such a plan
already, you can probably use your security incident response plan
with only minor modifications for most emergencies.</p><p>





Your incident response plan need not be an elaborate document, but
you need to have <em class="emphasis">something</em>, even if it's
only an email message that records and confirms the details
you've all worked out over lunch at the local sushi bar.
You'll be better off than many sites even if you do nothing
more than think about the issues and discuss them with the relevant
people.</p><p>





What's in your plan?</p><p>





The response plan is primarily concerned with two issues: authority
and communication. For each part of the incident response, the plan
should say who's in charge and who they're supposed to
talk to. Although you'll specify a few steps people will take,
incidents vary so much that the response plan mostly specifies
who's going to make decisions, and who they're going to
contact after they've decided  --  not what they're
going to decide. This section summarizes the different parts of a
response plan.</p><p>





<a name="ch27-21930" /><div class="sect2">
<h3 class="sect2">27.4.1. Planning for Detection </h3>





<a name="INDEX-2345" />An incident starts when somebody detects
an intruder or attacker. That person might be a system administrator,
but more often it's someone with no official responsibility. If
you've properly educated the people who use your computers,
they know they're supposed to report weird events. Somebody
then needs to sort run-of-the-mill peculiarities from a security
incident in progress. Who are the users going to report to? Who are
those people going to report to if they're still not sure? What
are they authorized to do if they are sure?</p><p>





The two cases you really want to plan for are these:</p><p>





<ul><li>Somebody notices a real security incident in progress at 3 A.M.</p><p></li><li>Somebody notices one of your perfectly legitimate users who happens
to be doing vital work from halfway across the globe at 3 A.M. local
time. (In Australia, where the user is consulting at the moment,
it's a reasonable 5 P.M.)</p><p></li></ul>
In the first case, you need a procedure that is going to reliably
start a full incident response immediately. Don't waste any
time. It's going to be embarrassing and expensive if you
don't actually get around to doing anything until your senior
security person arrives in the next morning, takes in enough caffeine
to become able to think, and gets around to looking at some report.
(And that's if there is a report in the first place; without a
response plan, it may be weeks before anyone actually tells someone
who can begin to do something about the situation.)</p><p>





In the second case, it's going to be embarrassing and expensive
if you disconnect the network and get five people out of bed, all to
prevent somebody from doing the work they're paid to do.</p><p>





Either way, it's not a decision you probably want made by a
night operator, or by a user acting alone because he or she
can't figure out how to call somebody who knows how to tell a
real incident from a false alarm.</p><p>





At a small site, you might want to simply post a number that users
can call to get help outside of office hours (for instance, a pager
number). Users might be encouraged to shut down personal machines if
they suspect an attack and know how to shut the machine down
gracefully. You want to be very cautious about this, however, because
an ungraceful shutdown, particularly of a multi-user machine, may be
more damaging than an intruder.</p><p>





At a larger site, one that has on-site support after hours, you
should instruct the on-site support people to call a senior person if
they see a possible security incident. They should be told explicitly
not to do anything more than that unless circumstances are extreme,
but to keep trying to contact senior personnel until they get
somebody who can take a look at what's going on.</p><p>
</div>
















<a name="ch27-21950" /><div class="sect2">
<h3 class="sect2">27.4.2. Planning for Evaluation of the Incident</h3>





<a name="INDEX-2346" />Who's going to decide that you
don't just have a suspicious situation  --  you actually
have a security problem? You need to designate one specific person
who will have responsibility for making the important decisions.
It's tempting to pick one specific person in advance and put
his or her name in your plan. But, what if that person isn't
available in the event of an actual incident? Who, then, will have
the responsibility?</p><p>





Teamwork is great, but emergencies call for leadership. You
don't want to have everybody doing their own thing and nobody
in charge, and you certainly can't afford to stand around
arguing about it. If your senior technical person is absent, do you
want someone less senior but more technical to do the evaluation, or
do you want someone more senior but less technical? How much time are
you going to spend searching for the senior technical person when you
have an emergency to deal with, before proceeding to your next
candidate for the hot seat?</p><p>





At a small site, you may not have a lot of options; if only one
person has the skills necessary to do something about an attack, your
policy will simply list that person as the one in charge in case of a
security incident. If that person is unavailable, authority should go
to somebody levelheaded and calm who can take stopgap actions and
arrange for assistance (for example, from a relevant response team).
In this situation, technical skills would be nice, but
resourcefulness and calm are more important.</p><p>





At a larger site, probably more than one person could be in charge.
Your plan may want to say that the most senior will be in charge by
default or that whoever is specified as being on call will be in
charge. Either way, the plan should state that if the default person
in charge is unavailable, the first of the other possible people to
respond is in charge. Specifying what order they're going to be
contacted in is probably overkill; let whoever is trying to reach
these people use his or her knowledge of the situation. If none of
those people are available, you'll usually want to work up the
organizational hierarchy rather than down. (A manager, particularly a
technical one, is probably better equipped to cope than an operator.)</p><p>





In a small organization, you will pick your fallback candidates by
name. In a large one, you will usually specify fallbacks by job
title. If job title is your criterion, it's important to base
your decision on the characteristics of the job, not of the person
currently in it. Don't write into your plan that the janitor
should decide, on the theory that the current janitor also is the
most sensible and technical of those who aren't system
administrators. The next janitor might be an airhead with a mop.</p><p>
</div>
















<a name="ch27-21960" /><div class="sect2">
<h3 class="sect2">27.4.3. Planning for Disconnecting or Shutting Down Machines</h3>





<a name="INDEX-2347" /><a name="INDEX-2348" /><a name="INDEX-2349" /><a name="INDEX-2350" />Your
response plan needs to specify what kind of situation warrants
disconnecting or shutting down, and who can make the decision to do
it. Most importantly, as we've discussed in "Pursuing and
Capturing the Intruder", are you ever willing to allow a known
intruder to remain connected to your systems? If you're not,
are you going to take down the system, or are you going to disconnect
from the network altogether?</p><p>





If you are at a site with multiple computer facilities, do you want
to take the entire site off the Internet if one facility has been
compromised, or is it better (or even possible) to take just that
facility off the Internet?</p><p>





At most sites, the reasonable plan is to disconnect the site as a
whole from the network as soon as you know for sure that you have an
intruder connected to your systems. You may have a myriad of internal
connections, with a triply redundant, diversely cabled, UPS-protected
routing mesh, which can make "disconnecting" a daunting
prospect (the system keeps "fixing" itself). On the other
hand, you probably have only one (or a small handful) of connections
to the outside world, which can be more easily severed.</p><p>





<a name="INDEX-2351" />
<a name="INDEX-2352" />Your plan needs to say how to disconnect
the network, and how the machines should be shut down. Be very
careful about this. You do not want to tell people to respond to a
mildly suspicious act by hitting the circuit breakers and powering
off every machine in the machine room. On the other hand, if an
intruder is currently removing all the files on the machine, you
don't want them to give that intruder a 15-minute warning for a
graceful shutdown.</p><p>





This is one case in which you need clear, security-specific
instructions in your plan. Here's what we recommend you do:</p><p>





<ul><li>In most security emergencies, the correct way to shut down the
machine is to do an immediate but graceful shutdown, with no
explanations or warnings sent. Your plan should state that and
specify the appropriate commands to issue.</p><p></li><li>If the intruder is actively destroying things, you want people to
shut the machine down by the fastest method possible. If they are
physically near the machine, cutting off the power to the machine or
the disk drive is completely appropriate, despite the damage it may
cause. This implies that the relevant power switches must be easy to
locate; a master switch for each machine is a good idea.</p><p></li></ul>
Whoever is going to disconnect the network needs to know how to do
that. The safest and easiest way often is to unplug cables and clean
up the side effects afterwards. With networks, this tends to result
in voluminous error messages but to cause no actual damage. You do
have to unplug the <em class="emphasis">relevant</em>  cables, however,
and the voluminous error messages may make it difficult to determine
whether or not the cables that were unplugged were actually the
correct ones. Your plan needs to tell people what to unplug and how
to make things functional afterwards.</p><p>
</div>
















<a name="ch27-21988" /><div class="sect2">
<h3 class="sect2">27.4.4. Planning for Notification of People Who Need to Know</h3>





<a name="INDEX-2353" /><a name="INDEX-2354" />Your incident response plan needs to
specify who you're going to notify, who's going to do the
notification, when they're going to do it, and what method
they're going to use. As we described earlier in this chapter,
you may need to notify:</p><p>





<ul><li>People within your own organization</p><p></li><li>CERT-CC or other incident response teams</p></li><li><p>Vendors and service providers</p></li><li><p>People at other sites</p></li></ul>
<a name="ch27-22006" /><div class="sect3">
<h3 class="sect3">27.4.4.1. Your own organization</h3>





To start with, you need to notify the people who are going to be
involved in the response. You'll have an urgent need to get
hold of them, so you need telephone and pager numbers. Be sure you
have all the relevant phone numbers; in addition to home and work
numbers, check to see if people have mobile phones at which they
might be reached. This list includes anybody who manages computers
within your site and anybody who manages those people, plus anybody
else who might be needed to provide resources (to sign off on
emergency purchases or to unlock doors, for example). Ideally, the
list  --  or at least the key portions of it  --  should be
reduced down so it's small enough to carry easily (for example,
it might be laser-printed onto business card-sized stock). Obviously,
the list isn't much use unless it's kept up to date.</p><p>





If many people must be notified, you may wish to use a phone tree or
an alert tree. In such a tree, shown in <a href="ch27_04.html#ch27-22011">Figure 27-2</a>,
each person notifies two or three other people; it is a geometric
progression, so a large number of people can be rapidly notified with
relatively little work to any one person. Everybody should have a
copy of the entire tree, so that if people are unavailable, their
calls can be taken over by someone else (usually the person above
them on the tree). It's best to set it up so that as many calls
as possible are toll-free, and so that people are notifying other
people they know relatively well (which increases their chances of
knowing how to get through). There's no need for an alert tree
to reflect an organizational chart or a chain of command.</p><p>





<a name="ch27-22011" /><div class="figure"><img height="249" alt="Figure 27-2" src="figs/fire2.2702.gif" width="434" /></div><h4 class="objtitle">Figure 27-2. An alert tree</h4>

Next, you're going to notify other people within your
organization who need to know, starting with the users of your
computer facility. For that, you'll use whatever your
organization normally uses for relatively urgent notifications to
everybody, whether that's memos or electronic mail. Your plan
should specify how to do it (system administrators rarely send memos
to all personnel and may not know how).</p><p>





Your plan should also show a sample notification message for the
users of your systems, which can sometimes be tricky. Your message
needs to contain enough information so that legitimate users
understand what's happening. They need to know:</p><p>





<ul><li>What has been taken out of service</p><p></li><li>Why you're making their lives miserable</p></li><li><p>Exactly which things that they normally do aren't going to work</p></li><li><p>When service will be restored</p></li><li><p>What they're supposed to do (including leave you alone so that
you can concentrate on the response)</p><p></li><li>That you realize you're making life unpleasant for them</p></li><li>That you're doing everything possible to improve matters</p></li><li><p>That you're going to tell them the details later</p></li></ul>
Things that are obvious to you may not be obvious to your users
(e.g., they might not even understand why it's so bad to have
an intruder). Writing an appropriate message (see <a href="ch27_04.html#ch27-22035">Figure 27-3</a>) is not easy, particularly if you're
busy and tired.</p><p>





<a name="ch27-22035" /><div class="figure"><img height="274" alt="Figure 27-3" src="figs/fire2.2703.gif" width="496" /></div><h4 class="objtitle">Figure 27-3. A notification message</h4>

For the remaining people within your organization  --  people from
other computer facilities, legal, audit, public relations, or
security  --  the plan needs to specify who gets notified. Do you
need to call the legal department? If so, who should you talk to? Who
are the administrators for other sites within your organization?
During the Morris worm incident in 1988, at least one large
government lab was reduced to having the guards hand out flyers at
the gate to people as they came to work, asking "Are you a
system administrator?" because they had no idea who all the
system administrators were, much less how to contact them.</p><p>





Think about <em class="emphasis">how</em> you are going to send your
message. If you send it via electronic mail, remember that the
intruder may see it. Even if you know that your own systems are
clean, don't assume that other people's are. Don't
say anything in your message that you don't want the attacker
to know. Even better yet, use a telephone.</p><p>





Some sites use a simple code phrase to announce a system attack that
they can include in electronic mail. This can rapidly degenerate into
bad spy fiction, but if you have an agreed-upon phrase that
isn't going to alert an intruder (and isn't going to
cause people who don't know it or don't remember it to
give the game away by asking what on earth you're talking
about), it can be effective. Something like "We're having
a pizza party; call 3-4357 to RSVP" should serve the purpose.</p><p>





Should you contact your organization's security department? At
some organizations, the security department is responsible only for
physical security. You'll want to have a contact number for
them in case you need doors unlocked, for example, but they are
unlikely to be trained in helping with an emergency of this kind, so
you probably won't need to notify them routinely of every
computer security incident. However, if a group within your
organization is responsible for computer security, you are probably
required to notify that group. Find out ahead of time when the
members of the group want to be notified and how, and put that
information in the plan. Even if that group cannot help you respond
to your particular type of incident (perhaps because they may be
personal computer specialists or government security specialists),
it's advisable to at least brief them on the incident after you
have finished responding to it.</p><p>
</div>









<a name="ch27-22044" /><div class="sect3">
<h3 class="sect3">27.4.4.2. CERT-CC and other incident response teams</h3>





<a name="INDEX-2355" /><a name="INDEX-2356" />Your plan should also specify what
emergency response team, if any, you're served by and how to
contact them. CERT-CC and many teams in the FIRST have 24-hour
numbers, and they prefer to be called immediately if a security
incident occurs.</p><p>
</div>









<a name="ch27-22053" /><div class="sect3">
<h3 class="sect3">27.4.4.3. Vendors and service providers</h3>





<a name="INDEX-2357" /><a name="INDEX-2358" />Your plan should also
contain the contact numbers for your vendors and Internet service
providers. These people probably do not need to be called
immediately, unless you need their help. However, if you have any
reason to suspect that your Internet provider itself has been
compromised, you should contact them immediately.</p><p>





any vendors and service providers have special contact procedures
for security incidents. Using these procedures will yield much faster
results than going through normal support channels. Be sure to
research these procedures ahead of time and include the necessary
information in your response plan.</p><p>
</div>









<a name="ch27-22063" /><div class="sect3">
<h3 class="sect3">27.4.4.4. Other sites</h3>





You will not ordinarily need to talk to other sites as part of the
immediate incident response. Instead, you'll call them after
the immediate emergency is over, when you have time to work without
needing everything written down in the plan. In addition, no plan
could cover all the information needed to find out what other sites
were involved and to contact them. Therefore, your plan doesn't
need to say much about informing other sites.</p><p>





If you are providing Internet service for other sites, however, or
have special network connections to other sites, you should have
contact information in the plan and should contact them promptly.
They need to know what happened to their service and to check that
the attacker didn't reach them through your site.</p><p>
</div>
</div>
















<a name="ch27-22067" /><div class="sect2">
<h3 class="sect2">27.4.5. Planning for Snapshots</h3>





<a name="INDEX-2359" /><a name="INDEX-2360" /><a name="INDEX-2361" /><a name="INDEX-2362" />Your incident response plan should specify
how you're going to do snapshots of the compromised system.
ake sure that your plan contains the answers to these questions:</p><p>





<ul><li>Where are the necessary supplies and what program are you going to
use?</p><p></li><li>How should the snapshot be labeled and where should it be stored?</p></li><li>How should snapshots be preserved against tampering, for possible
later use in legal proceedings?</p><p></li></ul>
</div>
















<a name="ch27-22090" /><div class="sect2">
<h3 class="sect2">27.4.6. Planning for Restoration and Recovery</h3>





<a name="INDEX-2363" /><a name="INDEX-2364" /><a name="INDEX-2365" />Different incidents are going to require
different amounts of recovery. Your response plan should provide some
general guidelines.</p><p>





Reinstalling an operating system from scratch is time consuming,
unpleasant, and often exposes underlying problems. For example, you
may discover that you no longer know where some of your programs came
from. For this reason, people are extremely reluctant to do it.
Unless your incident response plan says explicitly that they need to
reinstall the operating system, they probably won't. The
problem is, this leads to situations where you have to get rid of the
same intruder over and over again because the system hasn't
been properly cleaned up. Your response plan should specify
what's acceptable proof that the operating system hasn't
been tampered with (for instance, a comparison against cryptographic
checksums of an operating system known to be uncompromised). If you
don't have those tools, which are discussed in <a href="ch10_01.html">Chapter 10, "Bastion Hosts"</a>, or if you can't pass the inspection,
then you must install a clean operating system, and the plan should
say so.</p><p>





The plan should also provide the information needed to reinstall the
operating system; for example:</p><p>





<ul><li>Where are the distribution media kept?</p><p></li><li>How do you find out how to install the operating system?</p></li><li><p>Where are the backups, and how do you restore from them?</p></li><li><p>Where are the records that will let you reconstruct third-party or
locally written programs?</p><p></li></ul>
</div>
















<a name="ch27-22116" /><div class="sect2">
<h3 class="sect2">27.4.7. Planning for Documentation</h3>





<a name="INDEX-2366" />Your plan should include the basic
instructions on what documentation methods you intend to use and
where to find the supplies. If you might pursue legal action, your
plan should also include the instructions on dating, labeling,
signing, and protecting the documentation. Remember that you
aren't likely to know when you start out whether or not there
will be legal action, so you will always need to document if you ever
want to be able to take legal steps; this is not something you can go
back and "fix" later on.</p><p>
</div>
















<a name="ch27-22122" /><div class="sect2">
<h3 class="sect2">27.4.8. Periodic Review of Plans</h3>





<a name="INDEX-2367" /><a name="INDEX-2368" />However solid your
security incident response plans may seem to be, make sure to review
them periodically. Changes  --  in requirements, priorities,
personnel, systems, data, and other resources  --  are inevitable,
and you need to be sure that your response plans keep up with these
changes. The right question to ask about each item isn't
"Has it changed?," but "<em class="emphasis">How</em>
has it changed?"</p><p>





A good time to review your incident response plan is after a live
drill, which may have exposed weaknesses or problems in the plan.
(See <a href="ch27_05.html#ch27-22268">Section 27.5.7, "Doing Drills"</a> at the end of
this chapter.) For example, a live drill may uncover any of the
following:</p><p>





<ul><li>That you've changed all your storage since the plan was written</p><p></li><li>That you can't actually restore your operating system from
scratch</p><p></li><li>That your plan relies on the ability to use the network to reach
external sites, but at the same time instructs you to disconnect the
network</p><p></li></ul>
</div>


<hr width="684" align="left" />
<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch27_03.html"><img alt="Previous" border="0" src="../gifs/txtpreva.gif" /></a></td><td align="center" valign="top" width="228"><a href="index-2.html"><img alt="Home" border="0" src="../gifs/txthome.gif" /></a></td><td align="right" valign="top" width="228"><a href="ch27_05.html"><img alt="Next" border="0" src="../gifs/txtnexta.gif" /></a></td></tr><tr><td align="left" valign="top" width="228">27.3. Pursuing and Capturing the Intruder</td><td align="center" valign="top" width="228"><a href="index/index.html"><img alt="Book Index" border="0" src="../gifs/index.gif" /></a></td><td align="right" valign="top" width="228">27.5. Being Prepared </td></tr></table><div>
<hr width="684" align="left" />

<img alt="Library Navigation Links" border="0" src="../gifs/navbar.gif" usemap="#library-map" />
<p><font size="-1"><a href="copyrght.html">Copyright &copy; 2002</a> O'Reilly &amp; Associates. All rights reserved.</font></p><p>

<map name="library-map"><area shape="rect" coords="1,0,84,90" href="../index.html" /><area shape="rect" coords="86,-7,176,90" href="../ssh/index.html" /><area shape="rect" coords="178,0,265,101" href="../tcp/index.html" /><area shape="rect" coords="266,0,333,90" href="../nfs/index.html" /><area shape="rect" coords="334,-1,429,93" href="../snmp/index.html" /><area shape="rect" coords="431,0,529,116" href="../tshoot/index.html" /><area shape="rect" coords="534,0,594,104" href="../dns/index.html" /><area shape="rect" coords="595,1,704,108" href="index-2.html" /></map>

</body>
<!-- Mirrored from nnc3.com/mags/Networking2/fire/ch27_04.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 28 Jul 2017 17:51:42 GMT -->
</html>