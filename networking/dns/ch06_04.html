<html>
<!-- Mirrored from nnc3.com/mags/Networking2/dns/ch06_04.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 28 Jul 2017 17:57:25 GMT -->
<head><title>Vendor -Specific Options (DNS and BIND, 4th Edition)</title><link rel="stylesheet" type="text/css" href="../style/style1.css" />

<meta name="DC.Creator" content="Paul Albitz and Cricket Liu" /><meta name="DC.Format" content="text/xml" scheme="MIME" /><meta name="DC.Language" content="en-US" /><meta name="DC.Publisher" content="O'Reilly &amp; Associates, Inc." /><meta name="DC.Source" scheme="ISBN" content="0596001584L" /><meta name="DC.Subject.Keyword" content="stuff" /><meta name="DC.Title" content="DNS and BIND, 4th Edition" /><meta name="DC.Type" content="Text.Monograph" />

</head><body bgcolor="#ffffff">

<img alt="Book Home" border="0" src="gifs/smbanner.gif" usemap="#banner-map" /><map name="banner-map"><area shape="rect" coords="1,-2,616,66" href="index.html" alt="DNS and BIND" /><area shape="rect" coords="629,-11,726,25" href="jobjects/fsearch.html" alt="Search this book" /></map>

<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch06_03.html"><img alt="Previous" border="0" src="../gifs/txtpreva.gif" /></a></td><td align="center" valign="top" width="228"></td><td align="right" valign="top" width="228"><a href="ch07_01.html"><img alt="Next" border="0" src="../gifs/txtnexta.gif" /></a></td></tr></table><div>



<h2 class="sect1">6.4. Vendor -Specific Options</h2>


<a name="INDEX-842" /> <a name="INDEX-843" />Unix <a name="INDEX-844" />is <a name="INDEX-845" />ostensibly a standard operating
system, but there are almost as many Unix standards as flavors of
Unix. Likewise, there are almost as many different styles of resolver
configuration as there are versions of Unix. Almost all support the
original Berkeley syntax, but most add nonstandard enhancements or
variations, too. We'll cover as many of the major styles of
resolver configuration as we can.</p><p>


<a name="dns4-CHP-6-SECT-4.1" /><div class="sect2">
<h3 class="sect2">6.4.1. Sun's SunOS 4.x</h3>


<a name="INDEX-846" />Configuring <a name="INDEX-847" /> <a name="INDEX-848" />a host running
SunOS can be a challenge. The behavior of the SunOS resolver is
arguably as different from that of standard BIND as major vendors
get -- primarily because SunOS's resolver is integrated with
Sun's Network Information Service, or NIS (n&eacute;e
<a name="INDEX-849" />Yellow Pages).</p><p>


Briefly, NIS provides a mechanism for keeping important files
synchronized between hosts on a network. This includes not just
<em class="filename">/etc/hosts</em> but also
<em class="filename">/etc/services</em>, <em class="filename">/etc/passwd</em>,
and others. Sun positions DNS as a backup option to NIS; if the NIS
resolver can't find a host name (or IP address) in the NIS
<em class="emphasis">hosts</em> map, you can configure it to query a name
server.</p><p>


Note that the resolver functionality is implemented as part of the
<a name="INDEX-850" /><em class="filename">ypserv</em> program,
which also handles other types of NIS queries. So if
<em class="filename">ypserv</em> isn't running, neither is your
resolver! (Mercifully, the resolver in Solaris 2 doesn't
require that you run <em class="filename">ypserv</em>.) One benefit of
using <em class="filename">ypserv</em> to resolve all queries is that you
don't need to configure the resolvers on NIS clients, only on
NIS servers.<a href="#FOOTNOTE-43">[43]</a> The NIS clients
will query an NIS server for host data, and the NIS server will query
DNS, if necessary.</p><blockquote class="footnote">

<a name="FOOTNOTE-43" />[43]Actually, you also need to configure the
resolver on hosts on which you use <em class="filename">sendmail.mx</em>,
Sun's MX record-smart version of
<em class="filename">sendmail</em>.</p><p>

</blockquote>


If you run SunOS 4.x (Solaris 1), you can either (1) follow the party
line and configure your resolver to use DNS as a backup to NIS, (2)
choose to run NIS without the <em class="emphasis">hosts</em> map, or (3)
buck convention and recompile your resolver to use DNS
exclusively -- or you can pick up free copies of modified
resolvers on the Internet. However, we must warn you that, according
to our sources, Sun will <em class="emphasis">not</em> support the
modified resolver option.</p><p>


If you run Solaris 2, you can simply configure the resolver like a
normal human being and use the <em class="filename">nsswitch.conf</em>
file to specify that you want to use DNS for name resolution.</p><p>


<a name="dns4-CHP-6-SECT-4.1.1" /><div class="sect3">
<h3 class="sect3">6.4.1.1. Modified resolvers</h3>


We won't go into much detail about this option here, primarily
because this process was well-documented and nearly automated in the
BIND 4 distributions. The process itself usually involves creating a
new <em class="filename">libc.so -- </em>the standard, shared C
library -- by pulling out routines that call NIS and replacing
them with pure DNS versions. Although Sun generously provides the
necessary replacement routines, they don't support them. Worse,
the routines supplied with SunOS 4.x were based on BIND 4.8.1.</p><p>


BIND 4 source distributions contained instructions on installing the
BIND resolver routines under SunOS 4.x in the package's
<em class="emphasis">shres/sunos</em> subdirectory in a file called
<em class="emphasis">INSTALL</em>. As of BIND 8, however, the instructions
don't work (and as of BIND 8.2.2, they're not included).
You can still get older BIND source distributions via anonymous FTP
from ftp.isc.org in
<em class="filename">/isc/bind/src</em>, though. If you want to build a
replacement SunOS 4.x resolver from the source code, we recommend
using the source code from BIND 4.9.7, available from ftp.isc.org in
<em class="filename">/isc/bind/src/4.9.7/bind-4.9.7-REL.tar.gz</em>.</p><p>


If you'd rather skip the potentially edifying experience of
creating your own shared C library and leverage someone else's
efforts, you can check out <a name="INDEX-851" /><em class="filename">resolv+</em>, which is
based on the BIND 4.8.3 resolver. <em class="filename">resolv+</em> is an
enhanced version of the 4.8.3 resolver routines for SunOS. It was
written by Bill <a name="INDEX-852" />Wisner and allows administrators to choose
the order in which NIS and DNS are queried (much like the extensions
other vendors have added to Unix, which we'll discuss later).
The new routines are available, with instructions on how to build
them into the file <em class="filename">libc.so</em>, from ftp.uu.net as the file
<em class="filename">/networking/ip/dns/resolv+2.1.1.tar.Z</em>. For more
information on the functionality <em class="filename">resolv+</em>
provides, see the Linux section later in this chapter.</p><p>
</div>



<a name="dns4-CHP-6-SECT-4.1.2" /><div class="sect3">
<h3 class="sect3">6.4.1.2. Using DNS with NIS</h3>


<a name="INDEX-853" />If you go the socially acceptable route,
though, you'll need to make NIS and DNS coexist peacefully.
That's a little tricky, so let's go over it in some
detail. We won't cover how to set up NIS -- that's
already been covered in gory detail in Hal Stern's
<em class="citetitle">Managing NFS and NIS</em> (O'Reilly). Note
that these instructions apply only to versions of SunOS after 4.1. If
you run an older version of SunOS, consider the replacement libraries
on ftp.uu.net. Or upgrade.</p><p>


<a name="INDEX-854" />First, you'll need to modify the
<em class="filename">Makefile</em> NIS uses to build its maps -- the
files that it distributes to other hosts on the network. You should
make this modification on the master NIS server, not on the slaves.</p><p>


The NIS <em class="filename">Makefile</em> lives in
<em class="filename">/var/yp/Makefile</em> on a SunOS host. The change you
need to make is simple: you need to uncomment one line and comment
another. Find the lines that read:</p><p>


<blockquote><pre class="code">#B=-b
B=</pre></blockquote>


and change them to read:</p><p>


<blockquote><pre class="code">B=-b
#B=</pre></blockquote>


Then rebuild your NIS hosts map:</p><p>


<blockquote><pre class="code"># <tt class="userinput"><b>cd /var/yp</b></tt>
# <tt class="userinput"><b>rm hosts.time</b></tt>
# <tt class="userinput"><b>make hosts.time</b></tt>
updated hosts
pushed hosts</pre></blockquote>


This will insert a "<a name="INDEX-855" />magic cookie" into the
<em class="filename">hosts </em>map that instructs NIS to query DNS if it
can't find a host name in the <em class="filename">hosts</em> map.
Now, when the <em class="filename">ypserv</em> program looks up a name, it
checks the appropriate <em class="filename">hosts</em> map for the local
<a name="INDEX-856" />NIS domain,
and if it can't find the name there, it queries a name server.
The search list <em class="filename">ypserv</em> uses when it queries the
name server is derived from either the local NIS
<em class="emphasis">domainname</em> or from the
<em class="emphasis">domain</em> directive in
<em class="filename">resolv.conf</em>.</p><p>


Next, you should create a
<em class="filename">resolv.conf</em><a name="INDEX-857" /> file, if
you need one. The rules for configuring the resolver change slightly
with SunOS:</p><p>


<ul><li>You can't set the <em class="filename">hostname</em> to a domain
name and have the resolver infer the local domain.</p></li><li>You also can't use the <em class="emphasis">search</em> directive in
<em class="filename">resolv.conf</em>, since the SunOS 4.x resolver is
based on BIND 4.8.1. The resolver will silently ignore it.</p></li><li>You <em class="emphasis">can</em> set the NIS
<em class="emphasis">domainname</em> to a domain name (you have to set it
to the name of your NIS domain if you're using NIS), and the
resolver will derive the name of the local DNS domain from it.
However, this doesn't work in quite the same way it does with
BIND; if you set <em class="emphasis">domainname</em> to <em class="emphasis">fx.movie.edu</em>, for example, the search
list will include only <em class="emphasis">movie.edu</em>. Why doesn't the search
list include <em class="emphasis">fx.movie.edu</em>?
Because NIS assumes it's already checked an authoritative
source of <em class="emphasis">fx.movie.edu</em> host
data -- the <em class="emphasis">fx.movie.edu</em>
<em class="filename">hosts</em> map.</p></li><li>If you want to set the local domain name to the same name as your NIS
<em class="emphasis">domainname</em>, you can prepend a dot or a plus sign
(+) to the <em class="emphasis">domainname</em>. To set your local domain
name to <em class="emphasis">fx.movie.edu</em>, you
could set <em class="emphasis">domainname</em> to either
<em class="emphasis">+fx.movie.edu</em> or
<em class="emphasis">.fx.movie.edu</em>.</p></li><li>You can also override NIS's normal behavior by setting the
local domain name with the <em class="emphasis">domain</em> directive in
<em class="filename">resolv.conf</em>. So if you wanted to force the
resolver to include <em class="emphasis">fx.movie.edu</em>in the search list, you could add <em class="emphasis">domain
fx.movie.edu</em> to <em class="filename">resolv.conf</em>.</p></li><li>You can even set the <em class="emphasis">domain</em> directive in
<em class="filename">resolv.conf</em> to a DNS domain name totally
unrelated to your NIS <em class="emphasis">domainname</em>. In some
unfortunate situations, the local NIS <em class="emphasis">domainname</em>
isn't the same as, or even similar to, the local DNS domain
name. Say the Information Technology Department at Movie U. had
originally set up the NIS domain <em class="emphasis">it.dept.movieu</em>, and still uses it. To
prevent spurious DNS queries in the nonexistent <em class="emphasis">dept.movieu</em> domain, hosts in this NIS
domain should be configured with <em class="emphasis">domain</em>
<em class="emphasis">movie.edu</em> (or something
similar) in <em class="filename">resolv.conf</em>.</p></li></ul>
Finally, Sun's <em class="filename">resolv.conf</em> treats the
<em class="emphasis">nameserver</em> directive just as vanilla BIND does.
So once you're done with inserting magic cookies and
configuring your NIS <em class="emphasis">domainname</em> and possibly
your local DNS domain name, you can add any name servers to
<em class="filename">resolv.conf</em> and be done.<a name="INDEX-858" /></p><p>
</div>



<a name="dns4-CHP-6-SECT-4.1.3" /><div class="sect3">
<h3 class="sect3">6.4.1.3. Ignoring NIS</h3>


If you want to retain Sun's support but would rather not use
icky NIS, you still have an option: you can run NIS with an empty
<em class="filename">hosts</em> map. First, set up your
<em class="filename">resolv.conf</em> file, insert the magic cookie into
the NIS <em class="filename">Makefile</em> as we described in the last
section, and create an empty <em class="filename">hosts</em> map. Creating
an empty <em class="filename">hosts</em> map just requires moving the
<a name="INDEX-859" />NIS master
server's<a name="INDEX-860" />
<a name="INDEX-861" /><em class="filename">/etc/hosts</em>
file aside temporarily, generating your NIS
<em class="emphasis">hosts</em> map, then replacing the
<em class="filename">/etc/hosts</em> file:</p><p>


<blockquote><pre class="code">% <tt class="userinput"><b>mv /etc/hosts /etc/hosts.tmp</b></tt>
% <tt class="userinput"><b>touch /etc/hosts # to keep make from complaining</b></tt>
% <tt class="userinput"><b>cd /var/yp</b></tt>
% <tt class="userinput"><b>make hosts.time</b></tt>
updated hosts
pushed hosts
% <tt class="userinput"><b>mv /etc/hosts.tmp /etc/hosts</b></tt></pre></blockquote>


Now, when the resolver checks NIS, it doesn't find anything and
goes directly to querying a name server.</p><p>


If you periodically rebuild your NIS maps, you should make sure the
<em class="filename">hosts</em> map doesn't accidentally get rebuilt
from <em class="filename">/etc/hosts</em>. The best way to do this is to
remove the <em class="emphasis">hosts</em> target from the NIS
<em class="filename">Makefile</em>. You can just comment out everything in
the <em class="filename">Makefile</em> from the line that begins with:</p><p>


<blockquote><pre class="code">hosts.time: $(DIR)/hosts</pre></blockquote>


to the next<a name="INDEX-862" /> blank<a name="INDEX-863" /> line.<a name="INDEX-864" /></p><p>
</div>
</div>




<a name="dns4-CHP-6-SECT-4.2" /><div class="sect2">
<h3 class="sect2">6.4.2. Sun's Solaris 2.x</h3>


<a name="INDEX-865" /> <a name="INDEX-866" />The resolver in Solaris 2 through 2.5.1 is based
on the BIND 4.8.3 resolver. The Solaris 2.6, 7, and 8 resolvers are
based on BIND 4.9.4-P1. Interestingly, Sun chose not to follow RFC
1535's advice and trim the search list to just the local domain
name, so even the BIND 2.6 and later resolvers include the names of
all parent domains with at least two labels in the search list.
Patches are available to upgrade Solaris 2.5 and 2.5.1 resolvers to
BIND 4.9.3.<a href="#FOOTNOTE-44">[44]</a></p><blockquote class="footnote">

<a name="FOOTNOTE-44" />[44]Check
<a href="http://sunsolve.sun.com/pub-cgi/show.pl?target=patches/patch-access">http://sunsolve.sun.com/pub-cgi/show.pl?target=patches/patch-access</a>
for current patch numbers.</p><p>

</blockquote>


All Solaris 2.x resolvers support extensions to give you the ability
to determine the order in which the resolver consults various
<a name="INDEX-867" />sources of host information, including
DNS, NIS, NIS+, and <em class="filename">/etc/hosts</em>. This service
order is configured in a file called
<em class="filename">nsswitch.conf</em>, which lives in the
<em class="filename">/etc</em> directory.</p><p>


Actually, <a name="INDEX-868" /><em class="filename">nsswitch.conf</em> is used
to configure the order in which a number of different sources are
checked. You select the database you want to configure by specifying
a keyword. For naming services, the database name is
<em class="firstterm">hosts</em>. The possible sources for the
<em class="emphasis">hosts</em> database are <em class="firstterm">dns</em>,
<em class="firstterm">nis</em>, <em class="firstterm">nisplus</em>, and
<em class="firstterm">files</em> (which refers to
<em class="filename">/etc/hosts</em> in this case). Configuring the order
in which the sources are consulted is a simple matter of listing them
after the database name in that order. For example:</p><p>


<blockquote><pre class="code">hosts:  dns files</pre></blockquote>


has the resolver try DNS (i.e., query a name server) first, then
check <em class="filename">/etc/hosts</em>. By default, resolution moves
from one source to the next (e.g., falls back to
<em class="filename">/etc/hosts</em> from DNS) if the first source
isn't available or the name being looked up isn't found.
You can modify this behavior by specifying a
<em class="firstterm">condition</em><a name="INDEX-869" /> and an
<em class="firstterm">action</em><a name="INDEX-870" /> in
square brackets between the sources. The possible conditions are:</p><p>


<dl>
<dt><i>UNAVAIL</i></dt>
<dd><a name="INDEX-871" />The source
hasn't been configured (in DNS's case, there is no
<em class="filename">resolv.conf</em> file and there is no name server
running on the local host).</p></dd>

</dl>


<dl>
<dt><i>NOTFOUND</i></dt>
<dd><a name="INDEX-872" />The
source can't find the name in question (for DNS, the name
looked up or the type of data looked up doesn't exist).</p></dd>

</dl>


<dl>
<dt><i>TRYAGAIN</i></dt>
<dd><a name="INDEX-873" />The
source is busy, but might respond next time (for example, the
resolver has timed out while trying to look up a name).</p></dd>

</dl>


<dl>
<dt><i>SUCCESS</i></dt>
<dd><a name="INDEX-874" />The
requested name was found in the specified source.</p></dd>

</dl>


For each of these criteria, you can specify that the resolver should
either <em class="emphasis">continue</em> and fall back to the next source
or simply <em class="emphasis">return</em>. The default action is
<em class="emphasis">return</em> for <em class="emphasis">SUCCESS</em> and
<em class="emphasis">continue</em> for all the other conditions.</p><p>


For example, if you want your resolver to stop looking up a domain
name if it receives an NXDOMAIN (no such domain name) answer, but to
check <em class="filename">/etc/hosts </em>if DNS isn't available,
you could use:</p><p>


<blockquote><pre class="code">hosts:  dns [NOTFOUND=return] files</pre></blockquote>


The default Solaris <em class="filename">nsswitch.conf </em>configuration,
by the way, is determined by the answers you give
<em class="filename">SunInstall</em>. Believe it or not, though, none of
the default <em class="filename">nsswitch.conf</em> configurations
includes <em class="emphasis">dns</em> as a source. This from the dot in
<em class="emphasis">.com</em> ?</p><p>


<a name="dns4-CHP-6-SECT-4.2.1" /><div class="sect3">
<h3 class="sect3">6.4.2.1. nscd</h3>


In Solaris 2.x, Sun introduced a name service cache daemon called
<a name="INDEX-875" /><em class="filename">nscd</em>.
<em class="filename">nscd</em> caches the results of lookups in the
<em class="filename">passwd</em>, <em class="filename">group</em>, and
<em class="filename">hosts</em> sources. You can think of
<em class="filename">nscd</em> as very similar to a caching-only name
server, except that it also works for information in
<em class="filename">passwd</em> and <em class="filename">group</em> sources.
Sun's intent with <em class="filename">nscd</em> was to speed up
performance by caching frequently looked-up names. Unfortunately,
word on the street is that <em class="filename">nscd</em> sometimes
actually slows DNS lookups, so many people disable it. Moreover,
<em class="filename">nscd</em> interferes with <a name="INDEX-876" />round robin (<em class="filename">nscd</em>
caches records in one order and doesn't rotate them).</p><p>


<em class="filename">nscd</em> is started by default during a multiuser
bootup and reads the configuration file
<em class="filename">/etc/nscd.conf</em>. Administrators can tune a number
of parameters in <em class="filename">nscd.conf</em>. The most important
of these are:</p><p>


<dl>
<dt><i>enable-cache hosts (yes | no)</i></dt>
<dd>Determines whether or not <em class="filename">nscd</em> caches the
results of host lookups</p></dd>

</dl>


<dl>
<dt><i>positive-time-to-live hosts value</i></dt>
<dd>Determines how long <em class="filename">nscd</em> caches positive results
(e.g., addresses), in seconds</p></dd>

</dl>


<dl>
<dt><i>negative-time-to-live hosts value</i></dt>
<dd>Determines how long <em class="filename">nscd</em> caches negative results
(e.g., NXDOMAIN), in seconds</p></dd>

</dl>


But if you're not convinced of <em class="filename">nscd
</em>'s usefulness, at least with DNS lookups, you can
use:</p><p>


<blockquote><pre class="code">enable-cache hosts no</pre></blockquote>


to turn caching off for the <em class="filename">hosts</em><a name="INDEX-877" />
source.<a name="INDEX-878" /></p><p>
</div>
</div>




<a name="dns4-CHP-6-SECT-4.3" /><div class="sect2">
<h3 class="sect2">6.4.3. HP's HP-UX</h3>


HP's resolver implementation is basically straight BIND; the
<a name="INDEX-879" />HP-UX 8.0 through 10.00 resolvers are based
on BIND 4.8.3 and support the standard <em class="emphasis">domain</em>,
<em class="emphasis">nameserver</em>, and <em class="emphasis">search</em>
directives. The order in which a host consults DNS, NIS, and the host
table is hard-wired. The host uses DNS if DNS is configured (i.e., if
there's a
<em class="filename">resolv.conf</em><a name="INDEX-880" /> file or a
name server is running locally). If DNS isn't configured and
NIS is running, the host uses NIS. If neither DNS nor NIS is running,
the host uses the host table. The host falls back to using the other
services only under the circumstances described earlier in the
chapter (i.e., the resolver uses only one name server -- either
listed in <em class="filename">resolv.conf</em> or on the local host by
default -- and four errors are received while contacting that name
server).</p><p>


The hard-wired algorithm is less flexible than what other vendors
provide, but it's easy to troubleshoot. When you can consult
DNS, NIS, and the host table in any order, diagnosing user problems
can be awfully difficult.</p><p>


The HP-UX 10.10 through 11.00 resolvers are based on BIND 4.9.x.
Therefore, they support the BIND 4.9.x search list behavior and the
<em class="emphasis">options ndots</em> directive.</p><p>


Patches are available for all versions of HP-UX 10.x and later to
upgrade the name server and ancillary programs to BIND 4.9.7. To gain
access to the patches, visit the HP-UX patch archive at
<a name="INDEX-881" />
<a name="INDEX-882" /><a href="http://us-support.external.hp.com/">http://us-support.external.hp.com</a> and
register. Then you can search the patch database for the latest
patches.</p><p>


The HP-UX 11.10 resolver is based on BIND 8.1.2. The configuration of
a BIND 8.1.2 resolver is nearly identical, from a configuration
perspective, to the previous BIND 4.9.x-based resolvers: they
understand the same configuration directives and derive their default
search list the same way.</p><p>


HP-UX 10.00 introduced Solaris's
<a name="INDEX-883" /><em class="filename">nsswitch.conf</em>
functionality; that is, you can use
<em class="filename">nsswitch.conf</em> to control the order in which the
resolver consults the various naming services.<a href="#FOOTNOTE-45">[45]</a> The syntax
is exactly the same as that used in Solaris's
<em class="filename">nsswitch.conf</em>. The default settings for the
hosts database under HP-UX are:</p><blockquote class="footnote">

<a name="FOOTNOTE-45" />[45]Before
HP-UX 10.10, you could only use <em class="filename">nsswitch.conf</em> to
configure the order of resolution for the <em class="emphasis">hosts</em>
source. From 10.10 on, you can also use
<em class="filename">nsswitch.conf</em> to configure resolution order for
the <em class="filename">services</em>, <em class="filename">networks</em>,
<em class="filename">protocols</em>, <em class="filename">rpc</em>, and
<em class="filename">netgroup</em> sources.</p><p>

</blockquote>


<blockquote><pre class="code">hosts: dns [NOTFOUND=return] nis [NOTFOUND=return] files</pre></blockquote>


The <em class="filename">nsswitch.conf</em> functionality, as well as the
BIND 4.9.7 name server upgrade, is also available in patches for
versions of HP-UX as old as 9.0. Check the web-based HP-UX patch
archive for these. You may need quite a few patches:</p><p>


<ul><li>One for the standard, shared C library, <em class="filename">libc.so</em>,
which contains the resolver routines in HP-UX</p></li><li>One for the <em class="filename">mount</em> command, which is statically
linked</p></li><li>One for <em class="filename">nslookup</em></p></li><li>One for the <em class="filename">ifconfig</em> and
<em class="filename">route</em> commands</p></li><li>One for HP's Visual User Environment (VUE) or the Common
Desktop Environment (CDE), which are shipped statically linked</p></li></ul>
</div>




<a name="dns4-CHP-6-SECT-4.4" /><div class="sect2">
<h3 class="sect2">6.4.4. IBM's AIX</h3>


<a name="INDEX-884" />
<a name="INDEX-885" />The
resolver shipped with the recent versions of AIX, including 4.3 and
4.2.1, is also relatively standard. The code is based on BIND 4.9.x,
so it understands the <em class="emphasis">domain</em>,
<em class="emphasis">search</em>, <em class="emphasis">nameserver</em>,
<em class="emphasis">options</em>, and <em class="emphasis">sortlist</em>
directives; AIX supports up to three <em class="emphasis">nameserver</em>
directives. AIX Versions 4 and 4.1 were based on BIND 4.8.3, so they
handle all the directives AIX 4.2.1's resolver does except
<em class="emphasis">options</em> and <em class="emphasis">sortlist</em>.</p><p>


One difference between AIX's behavior and the stock BSD
behavior is that AIX uses the existence of the
<em class="filename">resolv.conf</em><a name="INDEX-886" /> file to
determine whether to query a name server. If
<em class="filename">resolv.conf</em> doesn't exist on the local
host, the resolver reads <em class="filename">/etc/hosts</em>. This means
that on a host running a name server, you should create a zero-length
<em class="filename">/etc/resolv.conf</em> file even if you don't
intend to put any directives in it.</p><p>


<a name="dns4-CHP-6-SECT-4.4.1" /><div class="sect3">
<h3 class="sect3">6.4.4.1. AIX 4.3</h3>


The AIX 4.3 resolver also supports two environment variables,
<a name="INDEX-887" />RES_TIMEOUT and
<a name="INDEX-888" />RES_RETRY, that allow you to control
the resolver's initial timeouts (&agrave; la the
<em class="emphasis">options timeout</em> directive) and number of
attempts (&agrave; la <em class="emphasis">options attempts</em>). You can
set these in a shell startup script or on the command line, as in:</p><p>


<blockquote><pre class="code"># <tt class="userinput"><b>RES_TIMEOUT=2 /usr/sbin/sendmail -bd -q1h</b></tt></pre></blockquote>


AIX 4.3 supports a mechanism to control resolution order called
<em class="filename">irs.conf</em><a name="INDEX-889" />, similar to Solaris's
<em class="filename">nsswitch.conf</em>. The syntax is slightly different,
though. Like <em class="filename">nsswitch.conf</em>,
<em class="filename">irs.conf</em> calls the database
<em class="emphasis">hosts</em>. The names of the sources are nearly the
same (<em class="emphasis">dns</em>, <em class="emphasis">nis</em>, and
<em class="emphasis">local</em>, as opposed to <em class="emphasis">files</em>)
but AIX uses the keyword <em class="firstterm">continue</em> at the end
of a line to signal that the resolver should try the next source of
information, listed on the next line. To indicate that a source of
information is authoritative and that the resolver should not try the
next source if the previous returns a negative answer (like
<em class="emphasis">[NOTFOUND=return]</em> ), add the tag
<em class="emphasis">=auth</em> after the argument. So to tell the
resolver to try DNS and go on to try <em class="filename">/etc/hosts
</em>only if DNS isn't configured, you could use the
following <em class="filename">irs.conf</em> file:</p><p>


<blockquote><pre class="code">hosts dns=auth continue
hosts local</pre></blockquote>


If you need to specify the order on a user-by-user basis or override
the system's default, you can use the
<a name="INDEX-890" />NSORDER environment variable. NSORDER
takes the same arguments as <em class="filename">irs.conf</em> but
formatted as a comma-separated list, as in:</p><p>


<blockquote><pre class="code">NSORDER=dns,local</pre></blockquote>


As with<em class="filename"> irs.conf</em>, you can specify that a source
is authoritative using <em class="emphasis">=auth</em>:</p><p>


<blockquote><pre class="code">NSORDER=dns=auth,local</pre></blockquote>
</div>



<a name="dns4-CHP-6-SECT-4.4.2" /><div class="sect3">
<h3 class="sect3">6.4.4.2. AIX 4.2.1</h3>


The AIX 4.2.1 mechanism to control resolution order is similar but
more limited. AIX 4.2.1 uses a file called
<a name="INDEX-891" /><em class="filename">/etc/netsvc.conf</em>. The
<a name="INDEX-892" /><em class="filename">netsvc.conf</em> file also
calls the database <em class="emphasis">hosts</em>, but it uses an equals
sign between the database name and the sources instead of a colon,
uses commas between sources, and uses <em class="emphasis">bind</em> for
DNS and <em class="emphasis">local</em> for
<em class="emphasis">/etc/hosts</em>. So:</p><p>


<blockquote><pre class="code">hosts = local,nis,bind</pre></blockquote>


has the AIX resolver check the local <em class="filename">/etc/hosts
</em>first, then check the NIS <em class="filename">hosts</em> map,
and finally try DNS. As with AIX 4.3, individual users or processes
can override the systemwide resolution order configured with
<em class="filename">netsvc.conf</em> by setting the
<em class="emphasis">NSORDER</em> environment variable.</p><p>


We should also note that you can configure the resolver using
AIX's <a name="INDEX-893" /> <a name="INDEX-894" />System Management
Interface Tool (SMIT).</p><p>
</div>
</div>




<a name="dns4-CHP-6-SECT-4.5" /><div class="sect2">
<h3 class="sect2">6.4.5. Compaq's Tru64 Unix and Digital Unix</h3>


<a name="INDEX-895" />The resolver shipped with
<a name="INDEX-896" />
<a name="INDEX-897" />Tru64 Unix 5.0 is based on the BIND 8.1.2
resolver. The resolver shipped with <a name="INDEX-898" />Digital Unix 4.0 is
based on the BIND 4.9.x resolver. As such, both understand all five
main resolver directives covered in this chapter, but not BIND 8.2
additions such as <em class="emphasis">options timeout</em>.</p><p>


The Tru64 Unix 5.0 resolver does name checking but also lets you
specify certain otherwise-illegal characters that you want to allow
in domain names. To do this, simply list the characters,
backslash-quoted, after the
<em class="firstterm">allow_special</em>directive.
To allow underscores, for example, you could use:</p><p>


<blockquote><pre class="code">allow_special \_</pre></blockquote>


You can also specify the argument <em class="emphasis">all</em> to allow
any character, but that's probably not a good idea.</p><p>


Both of Compaq's versions of Unix allow you to configure the
order in which the resolver checks NIS, DNS, and the host table via a
file called <a name="INDEX-899" /><em class="filename">svc.conf</em> (check out
the <em class="emphasis">svc.conf(4)</em> manpage).<a href="#FOOTNOTE-46">[46]</a> <em class="filename">svc.conf</em> also allows you to
configure which services are consulted for other databases, including
mail aliases, authentication checks (mapping from IP address to host
or domain names), password and group information, and a slew of other
things.</p><blockquote class="footnote">

<a name="FOOTNOTE-46" />[46]Poor
old Ultrix also supports <em class="filename">svc.conf</em>.</p><p>

</blockquote>


To configure the resolver with <em class="filename">svc.conf</em>, use the
database name <em class="emphasis">hosts</em>, followed by an equals sign
and the keywords for the services you want checked, separated by
commas in the order you want them checked. The legal keywords for the
<em class="emphasis">hosts</em> database are <em class="emphasis">local
</em>(<em class="filename">/etc/hosts</em>), <em class="emphasis">yp</em>
(for "<a name="INDEX-900" />Yellow Pages," the old name for
NIS), and <em class="emphasis">bind</em> (for DNS).
<em class="emphasis">local</em> must be the first service listed for
<em class="emphasis">hosts</em>. Don't use any whitespace on the
line, except (optionally) after commas and at the end of the line.
For example, the line:</p><p>


<blockquote><pre class="code">hosts=local,bind</pre></blockquote>


instructs the resolver to check <em class="filename">/etc/hosts</em> for
host names first and, if no match is found, to use domain name
service. This is very useful when the host has a small local host
table that includes the local host's domain name and IP
address, the host's default router, and any other hosts
referenced during startup. Checking the local host table first avoids
any problems using domain name service during startup, when
networking and <em class="filename">named</em> may not have started.</p><p>


Compaq's Unixes also include a utility called
<a name="INDEX-901" /><em class="filename">svcsetup</em> (see the
<em class="filename">svcsetup(8) </em>manpage), which allows you to set up
the <em class="filename">svc.conf</em> file interactively, without the aid
of an editor. Typing <em class="filename">svcsetup</em> will throw you
into a mode where you can choose the database you'd like to
configure. <em class="filename">svcsetup</em> will prompt you for the
order of the services you want checked.</p><p>
</div>




<a name="dns4-CHP-6-SECT-4.6" /><div class="sect2">
<h3 class="sect2">6.4.6. Silicon Graphics' IRIX</h3>


As of <a name="INDEX-902" /> <a name="INDEX-903" />IRIX 6.5, IRIX has a
BIND 4.9.x resolver and name server. The resolver understands the
<em class="emphasis">domain</em>, <em class="emphasis">search</em>,
<em class="emphasis">nameserver</em>, <em class="emphasis">options</em>, and
<em class="emphasis">sortlist</em> directives. The previous version of
IRIX, 6.4, had a BIND 4.9.x-based name server, but a 4.8.3-based
resolver. There are also patches available for versions of IRIX as
old as 5.3 to bring the name server up to BIND 4.9.7. For the current
patch numbers, see <a name="INDEX-904" />
<a name="INDEX-905" /><a href="http://support.sgi.com/colls/patches/tools/browse">http://support.sgi.com/colls/patches/tools/browse</a>.</p><p>


In IRIX 6.x, the <em class="emphasis">resolv.conf</em> file moved from
<em class="filename">/usr/etc/resolv.conf</em>, its former location, to
the more standard <em class="filename">/etc/resolv.conf</em>. (For
compatibility with software compiled under older versions of IRIX,
you may need to create a link from
<em class="filename">/usr/etc/resolv.conf</em> to
<em class="filename">/etc/resolv.conf</em>.)</p><p>


Like Solaris 2.x and HP-UX, IRIX 6.5 supports the
<em class="filename">nsswitch.conf </em>file. IRIX's
<em class="filename">nsswitch.conf </em>has the same format as
Solaris's, but adds <em class="firstterm">noperm</em> (no
permission to use the service) to the list of conditions. The default
for the <em class="emphasis">hosts</em> database is:</p><p>


<blockquote><pre class="code">hosts: nis dns files</pre></blockquote>


The IRIX name service daemon,
<em class="filename">nsd</em><a name="INDEX-906" />, reads
<em class="filename">nsswitch.conf</em>. Like Sun's
<em class="filename">nscd</em>, <em class="filename">nsd</em> maintains a
systemwide cache of previously looked-up data, including host
information derived from DNS and NIS. <em class="filename">nsd
</em>supports many attribute settings in
<em class="filename">nsswitch.conf</em> that Solaris and HP-UX don't
support. For example, you can also add a timeout setting in
parentheses to determine how long <em class="filename">nsd</em> will cache
records learned from DNS:</p><p>


<blockquote><pre class="code">hosts: files dns (timeout=600)      # cache timeout of 10 minutes</pre></blockquote>


You can also specify a negative caching timeout with
<em class="firstterm">negative_timeout</em><a name="INDEX-907" />. For a complete list of attributes, see
the <em class="emphasis">nsd(1m)</em> manpage.</p><p>


Older IRIX resolvers (until 6.4) support a
<a name="INDEX-908" /><em class="firstterm">hostresorder
</em>directive instead of <em class="filename">nsswitch.conf</em>.
Like <em class="filename">nsswitch.conf</em>, the
<em class="emphasis">hostresorder</em> directive allows the administrator
to determine the order in which NIS, DNS, and the local host table
are searched. Individual users can set the environment variable
<a name="INDEX-909" /><em class="emphasis">HOSTRESORDER</em> to
determine the order in which the services are used for their
commands. The IRIX 6.5 resolver ignores the <em class="emphasis">hostresorder
</em>directive.</p><p>


<em class="emphasis">hostresorder</em> takes one or more of the keywords
<em class="emphasis">nis</em>, <em class="emphasis">bind</em>, and
<em class="emphasis">local</em> as arguments. (The keywords correspond to
the obvious services.) The keywords may be separated by either
whitespace or a slash. Whitespace indicates that the next service
should be tried if the previous service doesn't return an
answer (e.g., the name isn't found in the host table or the
name server returns "no such domain name") or isn't
available (e.g., the name server isn't running). A slash
indicates that the preceding service is authoritative, and if no
answer is returned, resolution should stop. The next service is tried
only if the previous isn't available.</p><p>
</div>




<a name="dns4-CHP-6-SECT-4.7" /><div class="sect2">
<h3 class="sect2">6.4.7. Linux</h3>


Since we first published this book,
<a name="INDEX-910" />Linux has taken the computing world by
storm. A couple of the reasons are that Linux is freeware and that it
does a better job of keeping up with developments in the Unix and
Internet communities than any vendor's version of Unix.
Attesting to that is the fact that Red Hat Linux 7.0, the latest
version of one of the predominant strains of Linux, ships with a BIND
8.2.2-P5 name server. The resolver, however, is still based on the
BIND 4.9.x resolver. It supports the
<em class="filename">nsswitch.conf</em><a name="INDEX-911" /> file.</p><p>


However, some older Linux resolvers are based on Bill Wisner's
<a name="INDEX-912" /><em class="firstterm">resolv+</em> library,
which is in turn based on BIND 4.8.3. Consequently, the
<em class="filename">resolv.conf</em><a name="INDEX-913" /> file can
include any legit 4.8.3 resolver directives
(<em class="emphasis">domain</em>, <em class="emphasis">search</em>, and
<em class="emphasis">nameserver</em>, but not <em class="emphasis">options</em>
or <em class="emphasis">sortlist</em>) and has the older default search
list described in this chapter.</p><p>


<em class="emphasis">resolv+</em>, as the name suggests, also provides
several enhancements over the standard 4.8.3 resolver. These include
the ability to determine the order in which DNS, NIS, and
<em class="filename">/etc/hosts</em> are consulted (replaced by the more
standard <em class="emphasis">nsswitch.conf</em> in newer versions), the
ability to detect certain types of DNS spoofing, and the ability to
reorder address records in replies to favor local subnets.</p><p>


All of these enhancements are controlled by the
<a name="INDEX-914" /><em class="filename">/etc/host.conf</em> file.
The most interesting keywords that <em class="filename">host.conf</em>
accepts are:</p><p>


<dl>
<dt><i>order</i></dt>
<dd>Controls the order in which the various name services are consulted;
the valid arguments are <em class="emphasis">bind</em>,
<em class="emphasis">hosts</em>, and <em class="emphasis">nis</em>, at least
one of which must follow the keyword. Multiple arguments must be
separated by commas.</p></dd>

</dl>


<dl>
<dt><i>nospoof</i></dt>
<dd>Takes the single argument <em class="emphasis">on</em> or
<em class="emphasis">off</em>. <em class="emphasis">nospoof</em> instructs the
resolver to check any reverse-mapping (PTR) information it gets from
remote name servers by issuing a forward (address) query for the
domain name in the reply. If the address returned by the address
query isn't the same as the address the resolver originally
tried to reverse map, the PTR record is ignored.</p></dd>

</dl>


<dl>
<dt><i>reorder</i></dt>
<dd>Takes the single argument <em class="emphasis">on</em> or
<em class="emphasis">off</em>. With reorder on, the resolver sorts the
addresses of multihomed hosts so that any address on a local subnet
appears first.</p></dd>

</dl>
</div>




<a name="dns4-CHP-6-SECT-4.8" /><div class="sect2">
<h3 class="sect2">6.4.8. Windows 95</h3>


<a name="INDEX-915" /> <a name="INDEX-916" />Windows 95 includes its own TCP/IP stack
with a DNS resolver. In fact, Windows 95 actually includes
<em class="emphasis">two</em> TCP/IP stacks: one for TCP/IP over LANs and
another for TCP/IP over dialup connections. Configuration of the
resolver in Windows 95 is, naturally enough, graphical. To get to the
main DNS configuration panel, go to the Control Panel, select
<em class="emphasis">Network</em>, then choose <em class="emphasis">TCP/IP
protocol</em>. This brings up a new dialog, which looks similar
to the one in <a href="ch06_04.html#dns4-CHP-6-FIG-1">Figure 6-1</a>. Choose the tab labeled
<em class="emphasis">DNS Configuration</em>.</p><p>


<a name="dns4-CHP-6-FIG-1" /><div class="figure"><img height="334" alt="Figure 6-1" src="figs/dns4_0601.gif" width="248" /></div><h4 class="objtitle">Figure 6-1. Resolver configuration under Windows 95</h4>

Configuration using this panel is fairly self-explanatory: you check
<em class="emphasis">Enable DNS</em> to turn on DNS resolution, then fill
in the PC's hostname (in this case, the first label of its
domain name) in the <em class="emphasis">Host</em> field and the local
domain name (everything after the first dot) in the
<em class="emphasis">Domain</em> field. You add the IP addresses of up to
three name servers you want to query, in the order in which you want
to query them, under <em class="emphasis">DNS Server Search Order</em>.
Finally, you fill in the domain names in the search list under
<em class="emphasis">Domain Suffix Search Order</em> in the order in which
you want them appended. If you leave out the <em class="emphasis">Domain Suffix
Search Order</em>, the Windows 95 resolver derives a search
list from the local domain name in the same way a BIND 4.8.3 resolver
would.</p><p>


One interesting note about the current version of Windows 95: you can
configure a different set of name servers for each dialup connection
you might have to an Internet service provider (ISP) in the
<a name="INDEX-917" /> <a name="INDEX-918" />Dial-up Networking
(DUN) configuration. To configure DUN-specific resolver settings,
double-click on the <em class="emphasis">My Computer</em> icon on your
desktop, then double-click on <em class="emphasis">Dial-up
Networking</em>, right-click on the name of the connection
whose resolver settings you'd like to configure, then select
<em class="emphasis">Properties</em>. Select the <em class="emphasis">Server
Types</em> tab and click on <em class="emphasis">TCP/IP
Settings</em>. You'll see the window shown in <a href="ch06_04.html#dns4-CHP-6-FIG-2">Figure 6-2</a>.</p><p>


<a name="dns4-CHP-6-FIG-2" /><div class="figure"><img height="328" alt="Figure 6-2" src="figs/dns4_0602.gif" width="232" /></div><h4 class="objtitle">Figure 6-2. DUN resolver configuration under Windows 95</h4>

If you leave the <em class="emphasis">Server assigned name server
addresses</em> radio button checked, the resolver will retrieve
the name servers it should query from the server you dial into. If
you check <em class="emphasis">Specify name server addresses</em> and
specify the addresses of one or two name servers, Windows 95 will try
to use those name servers when the DUN connection is active.</p><p>


This is really useful if you use multiple ISPs and each has its own
name servers. However, configuring name servers in the
<em class="emphasis">TCP/IP Properties</em> panel overrides the
DUN-specific name servers. To use the DUN-specific name server
feature, you must leave the <em class="emphasis">TCP/IP Properties</em>
panel blank except for enabling DNS and specifying the local
hostname. This limitation is due to a lack of integration between the
dialup and LAN TCP/IP stacks and is corrected in DUN 1.3. See
Knowledge Base article Q191494 for details.<a href="#FOOTNOTE-47">[47]</a><a name="INDEX-919" /></p><blockquote class="footnote">

<a name="FOOTNOTE-47" />[47]To access
a Microsoft Knowledge Base article by article ID number, go to
<a href="http://search.support.microsoft.com/kb">http://search.support.microsoft.com/kb</a>and check the <em class="emphasis">Specific article ID
number</em> radio button, then type the article ID number in
the search field.</p><p>

</blockquote>
</div>




<a name="dns4-CHP-6-SECT-4.9" /><div class="sect2">
<h3 class="sect2">6.4.9. Windows 98</h3>


The resolver in <a name="INDEX-920" />Windows 98 is almost identical to Windows
95's resolver. (Graphically, in fact, it
<em class="emphasis">is</em> identical, so we won't show you any
screen shots.) The major differences between the two resolvers are
due to the fact that Windows 98 ships with Winsock 2.0.<a href="#FOOTNOTE-48">[48]</a></p><blockquote class="footnote">

<a name="FOOTNOTE-48" />[48]The version of Winsock in Windows 95 can be upgraded to 2.0;
see Knowledge Base article Q182108.</p><p>

</blockquote>


<a name="INDEX-921" />Winsock 2.0, for
example, sorts responses according to the local routing table. So if
a name server returns multiple addresses in a response and one of
those addresses is on a network that the local host has an explicit
(not default) route to, the resolver sorts that address to the
beginning of the response. For details, see Knowledge Base article
Q182644.</p><p>


Configuring <a name="INDEX-922" />DUN-specific name servers also works with
Windows 98. The resolver queries both the name servers listed in the
<em class="emphasis">TCP/IP Properties</em> panel and the DUN-specific
name servers simultaneously, and takes the first positive answer it
receives from either set. If the resolver receives only negative
answers, it returns that.</p><p>
</div>




<a name="dns4-CHP-6-SECT-4.10" /><div class="sect2">
<h3 class="sect2">6.4.10. Windows NT 4.0</h3>


<a name="INDEX-923" />In Windows NT, LAN resolver configuration
is done from a single panel that looks remarkably similar to Windows
95's since NT 4.0 incorporated the Windows 95
"shell." In fact, other than the new <em class="emphasis">Edit
</em>button and the presence of handy little arrows that allow
you to reorder name servers and elements of the search list,
there's really no semantic difference between them, as shown in
<a href="ch06_04.html#dns4-CHP-6-FIG-3">Figure 6-3</a>.</p><p>


<a name="dns4-CHP-6-FIG-3" /><div class="figure"><img height="373" alt="Figure 6-3" src="figs/dns4_0603.gif" width="299" /></div><h4 class="objtitle">Figure 6-3. Resolver configuration under Windows NT</h4>

To get to the <em class="emphasis">DNS Configuration</em> panel, go to the
Control Panel, click on <em class="emphasis">Network</em>, and select the
<em class="emphasis">Protocols</em> tab. Double-click on <em class="emphasis">TCP/IP
Protocol</em>, then select the tab for DNS.</p><p>


Windows NT also allows the user to configure resolver settings
specific to particular dialup networking connections. To configure
these, click on the <em class="emphasis">My Computer</em> icon, select
<em class="emphasis">Dial-Up Networking</em>, pull down the top selection
box, and choose the name of the DUN connection whose resolver
you'd like to configure. Then click on the
<em class="emphasis">More</em> pull-down and select <em class="emphasis">Edit
Entry</em> and <em class="emphasis">Modem Properties</em>. Select
the <em class="emphasis">Server</em> tab on the resulting window, and
click on the <em class="emphasis">TCP/IP Settings</em> button.
You'll see the very same window you'd see in Windows 95
(shown earlier). If you leave the <em class="emphasis">Server assigned name
server addresses</em> radio button checked, the resolver
retrieves the name servers it should query from the server you dial
into. If you check <em class="emphasis">Specify name server addresses</em>
and specify the addresses of one or two name servers, Windows NT uses
those name servers when the DUN connection is active. When you drop
the DUN connection, NT reverts to using the LAN resolver's
settings.</p><p>


The Windows NT 4.0 resolver caches name-to-address mappings on a
per-process basis, according to the time to live on the returned
address records. Good for Microsoft!</p><p>


Microsoft updated the resolver fairly extensively in Windows NT 4.0,
Service Pack 4. The SP4 resolver supports a sortlist, like a BIND
4.9.x resolver does, though the sortlist isn't configurable.
Instead, the sortlist is based on the computer's routing table:
addresses on networks that the computer has direct routes to are
sorted to the beginning of responses. If you don't like this
behavior -- for example, because it interferes with round
robin -- you can disable it using a new registry value. See
Microsoft Knowledge Base article Q196500 for details.</p><p>


The SP4 resolver also gives you the ability to turn off caching in
the resolver using (guess what?) a registry value. For details, see
Knowledge Base article Q187709.</p><p>


The SP4 resolver sports a new retransmission algorithm, too. The
resolver still sends its first query to the first name server in the
<em class="emphasis">DNS Server Search Order</em>. However, the resolver
waits only one second before retransmitting the query, and it
retransmits to <em class="emphasis">all</em> of the name servers it knows
about -- name servers it has learned about via static
configuration, DHCP, and RAS. If none of these name servers responds
in two seconds, the resolver retransmits to all the name servers
again. It keeps doubling the timeout and retransmitting for a total
of four retransmissions and 15 seconds. See Knowledge Base article
Q198550 for details.</p><p>


For you name server administrators, this behavior may mean
significantly higher load on your name servers, so take care that the
first name server listed in your SP4 resolvers' <em class="emphasis">DNS
Server Search Order</em> is fast (usually responds in less than
a second) and that you don't unnecessarily configure an SP4
resolver to query a name server (i.e., trim the <em class="emphasis">DNS Server
Search Order</em> down to the minimum).<a name="INDEX-924" /></p><p>
</div>




<a name="dns4-CHP-6-SECT-4.11" /><div class="sect2">
<h3 class="sect2">6.4.11. Windows 2000</h3>


<a name="INDEX-925" />The resolver in Windows 2000 is a
little tough to find. To get to it, click on
<em class="emphasis">Start</em>, then <em class="emphasis">Settings,
</em>then <em class="emphasis">Network and Dial-up Connections</em>.
This brings up the window shown in <a href="ch06_04.html#dns4-CHP-6-FIG-4">Figure 6-4</a>.</p><p>


<a name="dns4-CHP-6-FIG-4" /><div class="figure"><img height="138" alt="Figure 6-4" src="figs/dns4_0604.gif" width="431" /></div><h4 class="objtitle">Figure 6-4. Windows 2000 Network and Dial-up Connections</h4>

Right-click on <em class="emphasis">Local Area Connection</em> and choose
<em class="emphasis">Properties</em>. This brings up a window like the one
shown in <a href="ch06_04.html#dns4-CHP-6-FIG-5">Figure 6-5</a>.</p><p>


<a name="dns4-CHP-6-FIG-5" /><div class="figure"><img height="348" alt="Figure 6-5" src="figs/dns4_0605.gif" width="296" /></div><h4 class="objtitle">Figure 6-5. Windows 2000 Local Area Connection Properties</h4>

Double-click on <em class="emphasis">Internet Protocol (TCP/IP)</em>. This
posts the basic resolver configuration window shown in <a href="ch06_04.html#dns4-CHP-6-FIG-6">Figure 6-6</a>.</p><p>


<a name="dns4-CHP-6-FIG-6" /><div class="figure"><img height="361" alt="Figure 6-6" src="figs/dns4_0606.gif" width="327" /></div><h4 class="objtitle">Figure 6-6. Basic Windows 2000 resolver configuration</h4>

If you check the <em class="emphasis">Obtain DNS server address automatically
</em>radio button, the resolver queries the name servers that
the local DHCP server tells it to use. If you check the <em class="emphasis">Use
the following DNS server addresses</em> radio button, the
resolver queries the name servers you specify in the
<em class="emphasis">Preferred DNS server</em> and <em class="emphasis">Alternate DNS
server</em> fields.<a href="#FOOTNOTE-49">[49]</a></p><blockquote class="footnote">

<a name="FOOTNOTE-49" />[49]More kudos to Microsoft for
clarifying their labels. In previous versions of Windows, name
servers were sometimes labeled <em class="emphasis">Primary DNS</em> and
<em class="emphasis">Secondary DNS</em>. This sometimes misled users into
listing the primary master and slave (secondary master) name servers
for some zone or another in those fields. Besides, "DNS"
is an abbreviation for "Domain Name System," not
"domain name server."</p><p>

</blockquote>


To get at more advanced resolver configuration, click on (what else?)
the <em class="emphasis">Advanced...</em> button. Click on the
<em class="emphasis">DNS</em> tab and you'll see the window in <a href="ch06_04.html#dns4-CHP-6-FIG-7">Figure 6-7</a>.</p><p>


<a name="dns4-CHP-6-FIG-7" /><div class="figure"><img height="388" alt="Figure 6-7" src="figs/dns4_0607.gif" width="327" /></div><h4 class="objtitle">Figure 6-7. Advanced Windows 2000 resolver configuration</h4>

If you've specified the addresses of name servers to query in
the basic resolver configuration window, you'll see them again
at the top of this window, under <em class="emphasis">DNS server addresses, in
order of use:</em>. As in the Windows NT 4.0 resolver
configuration window, the buttons allow you to add, edit, remove, and
reorder the name servers listed. There doesn't seem to be a
limit to the number of name servers you can list, but it
doesn't make much sense to list more than three.</p><p>


The Windows 2000 resolver uses the same retransmission algorithm that
the Windows NT 4.0 SP4 resolver does: it retransmits to all of the
name servers configured. And since you can have a different set of
name servers configured for each network interface (or adapter, in
Microsoft's parlance), that can be quite a few name servers.
For details, see Knowledge Base article Q217769.</p><p>


Since it's possible, in these days of split namespaces, to get
two different answers from two different name servers, the Windows
2000 resolver temporarily ignores negative answers (no such domain
name and no such data) while querying multiple name servers. Only if
it receives a negative answer from a name server configured for each
interface does it return a negative answer. If the resolver receives
even a single positive answer from a name server, it returns that.</p><p>


Checking the <em class="emphasis">Append primary and connection specific DNS
suffixes</em> radio button has the resolver use the primary DNS
suffix and the connection-specific DNS suffixes as the search list.
The DNS suffix specific to this connection is set in this window, in
the field to the right of <em class="emphasis">DNS suffix for this
connection</em>. The primary DNS suffix, on the other hand, is
set in the Control Panel by clicking on <em class="emphasis">System</em>,
choosing the <em class="emphasis">Network Identification</em> tab,
clicking on the <em class="emphasis">Properties</em> button, and then
clicking on <em class="emphasis">More....</em> This brings up the window
shown in <a href="ch06_04.html#dns4-CHP-6-FIG-8">Figure 6-8</a>.</p><p>


<a name="dns4-CHP-6-FIG-8" /><div class="figure"><img height="184" alt="Figure 6-8" src="figs/dns4_0608.gif" width="320" /></div><h4 class="objtitle">Figure 6-8. Configuring the primary DNS suffix in Windows 2000</h4>

To set the <em class="emphasis">Primary DNS suffix of this computer</em>,
enter it in the field below that label.</p><p>


The checkbox labeled <em class="emphasis">Append parent suffixes of the primary
domain suffix</em> (see <a href="ch06_04.html#dns4-CHP-6-FIG-7">Figure 6-7</a>)
configures the resolver to use a BIND 4.8.3-style search list derived
from the primary DNS suffix. So if your primary DNS suffix is
<em class="emphasis">fx.movie.edu</em>, the search
list will contain <em class="emphasis">fx.movie.edu</em>and <em class="emphasis">movie.edu</em>.
Note that the connection-specific DNS suffix isn't
"devolved" (in Microsoft's words) into a search
list, but if it's configured, the connection-specific suffix is
included in the search list.</p><p>


Checking the <em class="emphasis">Append these DNS suffixes (in
order)</em> button configures the resolver to use the search
list specified in the fields below. As with the list of name servers,
you can add, edit, remove, and reorder these with the buttons and
arrows.</p><p>


Finally, it's worth mentioning the two checkboxes at the bottom
of the window. <em class="emphasis">Register this connection's addresses
in DNS</em> determines whether or not this client will try to
use dynamic update to add an address record mapping its name to the
address of this connection. <em class="emphasis">Use this connection's
suffix in DNS registration</em> controls whether that update
will use the domain name associated with this connection or the
primary DNS suffix for this computer.</p><p>


This feature -- automatic registration -- is designed to ensure
that the domain name of your Windows 2000 client always points to its
current IP address, even if that address was delivered by a DHCP
server. (The DHCP server actually adds the PTR record mapping the
client's IP address back to its domain name.) It's also
the death knell of WINS, the Windows Internet Name Service, the
proprietary -- and much maligned -- Microsoft NetBIOS naming
service. Once all of your clients are running Windows 2000,
they'll all use dynamic update to keep their name-to-address
mappings current, and you can drive a wooden stake through the heart
of WINS.</p><p>


Allowing clients to dynamically update zones presents certain, er,
challenges, though, which we'll explore in the last chapter
of<a name="INDEX-926" />
this<a name="INDEX-927" />
book<a name="INDEX-928" />
<a name="INDEX-929" />.<a name="INDEX-930" /> <a name="INDEX-931" /> <a name="INDEX-932" /> <a name="INDEX-933" /></p><p>
</div>


<hr width="684" align="left" />
<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch06_03.html"><img alt="Previous" border="0" src="../gifs/txtpreva.gif" /></a></td><td align="center" valign="top" width="228"><a href="index.html"><img alt="Home" border="0" src="../gifs/txthome.gif" /></a></td><td align="right" valign="top" width="228"><a href="ch07_01.html"><img alt="Next" border="0" src="../gifs/txtnexta.gif" /></a></td></tr><tr><td align="left" valign="top" width="228">6.3. Minimizing Pain and Suffering</td><td align="center" valign="top" width="228"><a href="index/index.html"><img alt="Book Index" border="0" src="../gifs/index.gif" /></a></td><td align="right" valign="top" width="228">7. Maintaining BIND</td></tr></table><div>
<hr width="684" align="left" />

<img alt="Library Navigation Links" border="0" src="../gifs/navbar.gif" usemap="#library-map" />
<p><font size="-1"><a href="copyrght.html">Copyright &copy; 2002</a> O'Reilly &amp; Associates. All rights reserved.</font></p><p>

<map name="library-map"><area shape="rect" coords="1,0,84,90" href="../index.html" /><area shape="rect" coords="86,-7,176,90" href="../ssh/index.html" /><area shape="rect" coords="178,0,265,101" href="../tcp/index.html" /><area shape="rect" coords="266,0,333,90" href="../nfs/index.html" /><area shape="rect" coords="334,-1,429,93" href="../snmp/index.html" /><area shape="rect" coords="431,0,529,116" href="../tshoot/index.html" /><area shape="rect" coords="534,0,594,104" href="index.html" /><area shape="rect" coords="595,1,704,108" href="../fire/index-2.html" /></map>

</body>
<!-- Mirrored from nnc3.com/mags/Networking2/dns/ch06_04.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 28 Jul 2017 17:57:27 GMT -->
</html>