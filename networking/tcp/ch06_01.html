<html>
<!-- Mirrored from nnc3.com/mags/Networking2/tcp/ch06_01.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 28 Jul 2017 17:52:54 GMT -->
<head><title>Configuring the Interface  (TCP/IP Network Administration, 3rd Edition)</title><link rel="stylesheet" type="text/css" href="../style/style1.css" />

<meta name="DC.Creator" content="Craig Hunt" /><meta name="DC.Format" content="text/xml" scheme="MIME" /><meta name="DC.Language" content="en-US" /><meta name="DC.Publisher" content="O'Reilly &amp; Associates, Inc." /><meta name="DC.Source" scheme="ISBN" content="0596002971L" /><meta name="DC.Subject.Keyword" content="stuff" /><meta name="DC.Title" content="TCP/IP Network Administration, 3rd Edition" /><meta name="DC.Type" content="Text.Monograph" />

</head><body bgcolor="#ffffff">

<img alt="Book Home" border="0" src="gifs/smbanner.gif" usemap="#banner-map" /><map name="banner-map"><area shape="rect" coords="1,-2,616,66" href="index.html" alt="TCP/IP Network Administration" /><area shape="rect" coords="629,-11,726,25" href="jobjects/fsearch.html" alt="Search this book" /></map>

<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch05_05.html"><img alt="Previous" border="0" src="../gifs/txtpreva.gif" /></a></td><td align="center" valign="top" width="228" /><td align="right" valign="top" width="228"><a href="ch06_02.html"><img alt="Next" border="0" src="../gifs/txtnexta.gif" /></a></td></tr></table></div>




<h1 class="chapter">Chapter 6. Configuring the Interface </h1>
<div class="htmltoc"><h4 class="tochead">Contents:</h4>
  <p> <a href="#tcp3-CHP-6-SECT-1">The ifconfig Command </a><br />
<a href="ch06_02.html">TCP/IP Over a Serial Line </a><br />
<a href="ch06_03.html">Installing PPP </a><br />
<a href="ch06_04.html">Summary </a><br /></p></div>


<p>When networking protocols work only with a single kind of physical
network, there is no need to identify the network interface to the
software. The software knows what the interface
<em class="emphasis">must</em> be; no configuration issues are left for
the administrator. However, one important strength of TCP/IP is its
flexible use of different physical networks. This flexibility adds
complexity to the system administrator's task, because you must
tell TCP/IP which interfaces to use, and you must define the
characteristics of each interface.
</p>

<p>Because TCP/IP is independent of the underlying physical network, IP
addresses are implemented in the network software -- not in the
network hardware. Unlike Ethernet addresses, which are determined by
the Ethernet hardware, the system administrator assigns an IP address
to each network interface.
</p>

<p>In this chapter, we use the <tt class="literal">ifconfig</tt> (interface
configure) command to identify the network interface to TCP/IP and to
assign the IP address, subnet mask, and broadcast address to the
interface. We also configure a network interface to run
Point-to-Point Protocol (PPP), which is the standard Network Access
Layer protocol used to run TCP/IP over modem connections.
</p>

<p>During a real installation the system administrator is isolated from
most of the details of the network configuration. The installation
program prompts the administrator for information, places that
information in script files, and then uses the scripts to configure
the interface at every boot. In this chapter we look beyond the
superficial to see how things actually work by examining the details
of the <tt class="literal">ifconfig</tt> command and the scripts that
invoke the command. Let's begin with a discussion of
<tt class="literal">ifconfig</tt>.
</p>


<div class="sect1"><a name="tcp3-CHP-6-SECT-1" /></a>
<h2 class="sect1">6.1. The ifconfig Command </h2>

<p>The <tt class="literal">ifconfig</tt>
<a name="INDEX-1118" /></a>
<a name="INDEX-1119" /></a> <a name="INDEX-1120" /></a>
<a name="INDEX-1121" /></a>command sets, or checks,
configuration values for network interfaces. Regardless of the vendor
or version of Unix, the <tt class="literal">ifconfig</tt> command sets the
IP address, the subnet mask, and the broadcast address for each
interface. Its most basic function is assigning the IP address.
</p>

<p>Here is the <tt class="literal">ifconfig</tt> command that configures the
<a name="INDEX-1122" /></a>
<a name="INDEX-1123" /></a> <a name="INDEX-1124" /></a>Ethernet
interface on a Solaris system:
</p>

<blockquote><pre class="code"># <b class="emphasis-bold">ifconfig dnet0 172.16.12.2 netmask 255.255.255.0 broadcast 172.16.12.255</b></pre></blockquote>

<p>Many other arguments can be used with the <tt class="literal">ifconfig</tt>
command; we discuss several of these later. But a few important
arguments provide the basic information required by TCP/IP for every
network <a name="INDEX-1125" /></a> <a name="INDEX-1126" /></a>interface.
These are:
</p>

<dl>
<a name="INDEX-1127" /></a><dt><i><em class="emphasis">interface</em></i></dt>
<dd>
<p>The name of the network interface that you want to configure for
TCP/IP. In the example above, this is the Ethernet interface dnet0.
</p>
</dd>


<a name="INDEX-1128" /></a><dt><i><em class="emphasis">address</em></i></dt>
<dd>
<p>The IP address
<a name="INDEX-1129" /></a> <a name="INDEX-1130" /></a>assigned to this interface. Enter the
address as either an IP address (in dotted decimal form) or as a
hostname. If you use a hostname, place the hostname and its address
in the <em class="emphasis">/etc/hosts</em> <a name="INDEX-1131" /></a>file. Your system must be able to find the
hostname in <em class="emphasis">/etc/hosts</em> because
<tt class="literal">ifconfig</tt> usually executes before DNS starts. The
example uses the numeric IP address 172.16.12.2 as the
<tt class="literal">address</tt> value.
</p>
</dd>


<a name="INDEX-1132" /></a><dt><i>netmask mask</i></dt>
<dd>
<p>The address mask for this interface. Ignore this argument only if
you're using the default mask derived from the traditional
address class structure. The address mask chosen for our imaginary
network is 255.255.255.0, so that is the value assigned to interface
dnet0. See <a href="ch02_01.html">Chapter 2, "Delivering the Data"</a> and <a href="ch04_01.html">Chapter 4, "Getting Started"</a> for information on address masks.
</p>
</dd>


<a name="INDEX-1133" /></a><dt><i>broadcast address</i></dt>
<dd>
<p>The broadcast address for the network. Most systems default to the
standard broadcast address, which is an IP address with all host bits
set to 1. In the <tt class="literal">ifconfig</tt> example we explicitly
set the broadcast address to 172.16.12.255 to avoid any confusion,
despite the fact that a Solaris 8 system will set the correct
broadcast address by default. Every system on the subnet must agree
on the broadcast address.
</p>
</dd>

</dl>

<p>In the example above, we use <a name="INDEX-1134" /></a>keyword/value pairs because this
makes explaining and understanding the syntax easier. However,
Solaris does not require that syntax. The following (much shorter)
command <a name="INDEX-1135" /></a>does exactly the same thing as
the previous one:
</p>

<blockquote><pre class="code"># <b class="emphasis-bold">ifconfig dnet0 172.16.12.2/24</b></pre></blockquote>

<p>In this command the network mask is defined with an address prefix
and the broadcast address is allowed to default. A prefix length of
24 is the same as 255.255.255.0. The default broadcast address given
that prefix length is 172.16.12.255.
</p>

<p>The network administrator provides the values for the address, subnet
mask, and broadcast address. The values in our example are taken
directly from the plans we developed in <a href="ch04_01.html">Chapter 4, "Getting Started"</a>.
But the name of the interface, the first argument on every
<tt class="literal">ifconfig</tt> command line, is determined by the system
during startup.
</p>

<a name="tcp3-CHP-6-SECT-1.1" /></a><div class="sect2">
<h3 class="sect2">6.1.1. The Interface Name </h3>

<p>In <a href="ch05_01.html">Chapter 5, "Basic Configuration "</a>, we <a name="INDEX-1136" /></a> <a name="INDEX-1137" /></a>saw that Ethernet network interfaces
come in many varieties and that different Ethernet cards usually have
different interface names. You can usually determine which interface
is used on a system from the messages displayed on the console during
a boot. On many systems these messages can be examined with the
<tt class="literal">dmesg</tt><a name="INDEX-1138" /></a> command. The
following example shows the output of the <tt class="literal">dmesg</tt>
command on two different systems:
</p>

<blockquote><pre class="code">$ <b class="emphasis-bold">dmesg | grep ether</b>
Oct  1 13:07:23 crab gld: [ID 944156 kern.info] dnet0: DNET 21x4x:
 type "ether" mac address 00:00:c0:dd:d4:da
 
$ <b class="emphasis-bold">dmesg | grep eth</b> 
eth0: SMC EtherEZ at 0x240, 00 00 C0 9A 72 CA,assigned  IRQ 5 programmed-I/O mode.</pre></blockquote>

<p>The first <tt class="literal">dmesg</tt> command in the example shows the
message displayed when an Ethernet interface is detected during the
boot of a <a name="INDEX-1139" /></a>Solaris 8 system. The string
<tt class="literal">type</tt> <tt class="literal">"ether"</tt> makes it clear
that dnet0 is an Ethernet interface. The Ethernet address
(00:00:c0:dd:d4:da) is also displayed.
</p>

<p>The second <tt class="literal">dmesg</tt> example, which comes from a PC
running
<a name="INDEX-1140" /></a>Linux,
provides even more information. On Linux systems, the Ethernet
interface name starts with the string "eth", so we look
for a message containing that string. The message from the Linux
system displays the Ethernet address (00:00:c0:9a:72:ca) and the make
and model (SMC EtherEZ) of the network adapter card.
</p>

<p>It is not always easy to determine all available interfaces on your
system by looking at the output of <tt class="literal">dmesg</tt>. These
messages show only the physical hardware interfaces. In the TCP/IP
protocol architecture, the Network Access Layer encompasses all
functions that fall below the Internet Layer. This can include all
three lower layers of the OSI Reference Model: the Physical Layer,
the Data Link Layer, and the Network Layer. IP needs to know the
specific interface in the Network Access Layer where packets should
be passed for delivery to a particular network. This interface is not
limited to a physical hardware driver. It could be a software
interface into the network layer of another protocol suite. So what
other methods can help you determine the network interfaces available
on a system? Use the
<tt class="literal">netstat</tt><a name="INDEX-1141" /></a> and the <tt class="literal">ifconfig</tt>
commands. For example, to see all network interfaces that are already
configured, enter:
</p>

<blockquote><pre class="code"># <b class="emphasis-bold">netstat -in</b>
Name  Mtu  Net/Dest     Address      Ipkts Ierrs Opkts Oerrs Collis Queue
lo0   8232 127.0.0.0    127.0.0.1    4504  0     4504  0     0      0
dnet0 1500 172.16.12.0  172.16.12.1  366   0     130   0     0      0 </pre></blockquote>

<p>The <tt class="literal">-i</tt> option tells <tt class="literal">netstat</tt> to
display the status of all configured network interfaces, and the
<tt class="literal">-n</tt> tells <tt class="literal">netstat</tt> to display its
output in numeric form. In the Solaris 8 example shown above, the
<tt class="literal">netstat -in</tt><a name="INDEX-1142" /></a> command
displays the following fields:
</p>

<dl>
<dt><i><em class="emphasis">Name</em></i></dt>
<dd>
<p>The Interface <a name="INDEX-1143" /></a>Name field shows the actual name
assigned to the interface. This is the name you give to
<tt class="literal">ifconfig</tt> to identify the interface. An asterisk
(<tt class="literal">*</tt>) in this field indicates that the interface is
not enabled; i.e., the interface is not "up."
</p>
</dd>


<a name="INDEX-1144" /></a><dt><i><em class="emphasis">Mtu</em></i></dt>
<dd>
<p>The Maximum Transmission Unit shows the longest frame (packet) that
can be transmitted by this interface without fragmentation. The MTU
is displayed in bytes and is discussed in more detail later in this
chapter.
</p>
</dd>


<a name="INDEX-1145" /></a><dt><i><em class="emphasis">Net/Dest</em></i></dt>
<dd>
<p>The Network/Destination field shows the network or the destination
host to which the interface provides access. In our Ethernet
examples, this field contains a network address. The network address
is derived from the IP address of the interface and the subnet mask.
This field contains a host address if the interface is configured for
a point-to-point (host-specific) link. The destination address is the
address of the remote host at the other end of the point-to-point
link.<a href="#FOOTNOTE-50">[50]</a> A point-to-point link is a direct connection between two
computers. You can create a point-to-point link with the
<tt class="literal">ifconfig</tt> command. How this is done is covered
later in this chapter.
</p><blockquote class="footnote"> <a name="FOOTNOTE-50" /></a><p>[50]See the description of the H flag in <a href="ch02_04.html#tcp3-CHP-2-SECT-4">Section 2.4, "The Routing Table"</a>.</p>
</blockquote>
</dd>


<a name="INDEX-1146" /></a><dt><i><em class="emphasis">Address</em></i></dt>
<dd>
<p>The IP Address field shows the Internet address assigned to this
interface.
</p>
</dd>


<a name="INDEX-1147" /></a><dt><i><em class="emphasis">Ipkts</em></i></dt>
<dd>
<p>The Input Packets field shows how many packets this interface has
received.
</p>
</dd>


<a name="INDEX-1148" /></a><dt><i><em class="emphasis">Ierrs</em></i></dt>
<dd>
<p>The Input Errors field shows how many damaged packets the interface
has received.
</p>
</dd>


<a name="INDEX-1149" /></a><dt><i><em class="emphasis">Opkts</em></i></dt>
<dd>
<p>The Output Packets field shows how many packets were sent out by this
interface.
</p>
</dd>


<a name="INDEX-1150" /></a><dt><i><em class="emphasis">Oerrs</em></i></dt>
<dd>
<p>The Output Errors field shows how many of the packets caused an error
condition.
</p>
</dd>


<a name="INDEX-1151" /></a><dt><i><em class="emphasis">Collis</em></i></dt>
<dd>
<p>The Collisions field shows how many Ethernet collisions were detected
by this interface. Ethernet collisions are a normal condition caused
by Ethernet traffic contention. This field is not applicable to
non-Ethernet interfaces.
</p>
</dd>


<a name="INDEX-1152" /></a><dt><i><em class="emphasis">Queue</em></i></dt>
<dd>
<p>The Packets Queued field shows how many packets are in the queue,
awaiting transmission via this interface. Normally this is zero.
</p>
</dd>

</dl>

<p>The output of a <a name="INDEX-1153" /></a>
<a name="INDEX-1154" /></a><tt class="literal">netstat -in</tt> command
on a Linux system appears quite different:
</p>

<blockquote><pre class="code">$ <b class="emphasis-bold">netstat -in</b>
Kernel Interface table
Iface MTU Met RX-OK RX-ERR RX-DRP RX-OVR  TX-OK TX-ERR TX-DRP TX-OVR Flg
eth0 1500   0  2234    280      0      0   1829      0      0      0 BRU
lo  16436   0    10      0      0      0     10      0      0      0 LRU</pre></blockquote>

<p>This output appears different, but as is often the case, appearances
can fool you. Again we have the interface name, the MTU, and the
packet statistics.<a href="#FOOTNOTE-51">[51]</a> Here RX-OK is the total
number of input packets, while RX-ERR (errors), RX-DRP (drops), and
RX-OVR (overruns) added together give the total number of input
errors. The total number of output packets is TX-OK, and the TX-ERR,
TX-DRP, and TX-OVR counters provide the total number of output
errors. Only two fields, Net/Dest and Address, that are provided in
the Solaris output are not provided here. On the other hand, this
display has two fields not used in the Solaris output. The
<a name="INDEX-1155" /></a>Met field contains the routing metric
assigned to this interface. The Flg field shows the interface flags:
</p><blockquote class="footnote"> <a name="FOOTNOTE-51" /></a><p>[51]The packet statistics displayed by
<tt class="literal">netstat</tt> are used in <a href="ch13_01.html">Chapter 13, "
Troubleshooting TCP/IP"</a>.</p> </blockquote>

<ul><li>
<p>R means the interface is running.</p>
</li><li>
<p>U means the interface is up.</p>
</li><li>
<p>B means it is a broadcast-capable interface.</p>
</li><li>
<p>L means it is a loopback interface.</p>
</li></ul>
<p>This display shows that this workstation has only two network
interfaces. In this case it is easy to identify each network
interface. The lo0 interface is the <a name="INDEX-1156" /></a>
<a name="INDEX-1157" /></a>loopback interface, which
every TCP/IP system has. It is the same loopback device discussed in
<a href="ch05_01.html">Chapter 5, "Basic Configuration "</a>. eth0 is the Ethernet interface, also
discussed previously.
</p>

<p>On most systems, the loopback interface is part of the default
configuration, so you won't need to configure it. If you do
need to configure lo0 on a Solaris system, use the following command:
</p>

<blockquote><pre class="code"># <b class="emphasis-bold">ifconfig lo0 plumb 127.0.0.1 up</b></pre></blockquote>

<p>This example is specific to Solaris because it contains the
<a name="INDEX-1158" /></a>plumb option. This
option literally creates the "plumbing" required by the
network interface the first time it is configured. Subsequent
reconfigurations of this interface do not require the plumb option,
and other systems, such as Linux, do not use this option.
</p>

<p>The configuration of the Ethernet interface requires more attention
than the loopback interface. Many systems use an installation script
to install Unix. This script requests the host address, which it then
uses to configure the interface. Later we'll look at these
scripts and what to do when the user does not successfully set up the
interface with the installation script.
</p>

<p>The <tt class="literal">ifconfig</tt><a name="INDEX-1159" /></a> command can also be used to find out
what network interfaces are available on a system. The
<tt class="literal">netstat</tt> command shows only interfaces that are
configured. On some systems the <tt class="literal">ifconfig</tt> command
can be used to show all interfaces, even those that have not yet been
configured. On Solaris 8 systems, <tt class="literal">ifconfig -a</tt> does
this; on a Linux 2.0.0 system, entering <tt class="literal">ifconfig</tt>
without any arguments will list all of the network interfaces.
</p>

<p>While most hosts have only one real network interface, some hosts and
all gateways have multiple interfaces. Sometimes all interfaces are
the same type; e.g., a gateway between two Ethernets may have two
Ethernet interfaces. <tt class="literal">netstat</tt> on a gateway like
this might display lo0, eth0, and eth1. Deciphering a
<tt class="literal">netstat</tt> display with multiple interfaces of the
same type is still very simple. But deciphering a system with many
different types of network interfaces is more difficult. You must
rely on documentation that comes with optional software to choose the
correct interface. When installing new network software, always read
documentation carefully.
</p>

<p>This long discussion about determining the network interface is not
meant to overshadow the important <tt class="literal">ifconfig</tt>
functions of assigning the IP address, subnet mask, and broadcast
address. So let's return to these important <a name="INDEX-1160" /></a> <a name="INDEX-1161" /></a>topics.
</p>

</div>
<a name="tcp3-CHP-6-SECT-1.2" /></a><div class="sect2">
<h3 class="sect2">6.1.2. Checking the Interface with ifconfig </h3>

<p>As noted previously, the
<a name="INDEX-1162" /></a>
<a name="INDEX-1163" /></a>
<a name="INDEX-1164" /></a>Unix
installation script configures the network interface. However, this
configuration may not be exactly what you want. Check the
configuration of an interface with <tt class="literal">ifconfig</tt>. To
display the current values assigned to the interface, enter
<tt class="literal">ifconfig</tt> with an interface name and no other
arguments. For example, to check interface dnet0:
</p>

<blockquote><pre class="code">% <b class="emphasis-bold">ifconfig dnet0</b> 
dnet0: flags=1000843&lt;UP,BROADCAST,NOTRAILERS,RUNNING,MULTICAST,IPv4&gt; mtu 1500 index 2
inet 172.16.12.2 netmask ffff0000 broadcast 172.16.255.255</pre></blockquote>

<p>When used to check the status of an interface on a
<a name="INDEX-1165" /></a>Solaris system, the
<tt class="literal">ifconfig</tt> command displays two lines of output. The
first line shows the interface name, the flags that define the
interface's characteristics, and the Maximum Transmission Unit
(MTU) of this interface.<a href="#FOOTNOTE-52">[52]</a> In our example
the interface name is dnet0, and the MTU is 1500 bytes. The flags are
displayed as both a numeric value and a set of keywords.
</p><blockquote class="footnote"> <a name="FOOTNOTE-52" /></a><p>[52]<tt class="literal">index</tt> is
an interface characteristic that is specific to Solaris. It is an
internal number used to uniquely identify the interface. The number
does not have meaning to TCP/IP.</p> </blockquote>

<p>The interface's flags have the numeric value 1000843, which
corresponds to:
</p>

<dl>
<a name="INDEX-1166" /></a><dt><i>UP </i></dt>
<dd>
<p>The interface is enabled for use.</p>
</dd>


<a name="INDEX-1167" /></a><dt><i>BROADCAST</i></dt>
<dd>
<p>The interface supports broadcasts, which means it is connected to a
network that supports broadcasts, such as an Ethernet.
</p>
</dd>


<a name="INDEX-1168" /></a><dt><i>NOTRAILERS</i></dt>
<dd>
<p>This interface does not support trailer encapsulation. </p>
</dd>


<a name="INDEX-1169" /></a><dt><i>RUNNING</i></dt>
<dd>
<p>This interface is operational.</p>
</dd>


<a name="INDEX-1170" /></a><dt><i>MULTICAST</i></dt>
<dd>
<p>This interface supports multicasting. </p>
</dd>


<a name="INDEX-1171" /></a><dt><i>IPv4</i></dt>
<dd>
<p>This interface supports TCP/IP version 4, which is the standard
version of TCP/IP used on the Internet and described in this book.
</p>
</dd>

</dl>

<p>The second line of <tt class="literal">ifconfig</tt> output displays
information that directly relates to TCP/IP. The keyword
<tt class="literal">inet</tt> is followed by the Internet address assigned
to this interface. Next comes the keyword <tt class="literal">netmask</tt>,
followed by the address mask written in hexadecimal. Finally, the
keyword <tt class="literal">broadcast</tt> and the broadcast address are
displayed.
</p>

<p>On a <a name="INDEX-1172" /></a>Linux system the
<tt class="literal">ifconfig</tt> command displays up to seven lines of
information for each interface instead of the two lines displayed by
the Solaris system. The additional information includes the Ethernet
address, the PC IRQ, I/O Base Address and memory address, and packet
statistics. The basic TCP/IP configuration information is the same on
both systems.
</p>

<blockquote><pre class="code">&gt; <b class="emphasis-bold">ifconfig eth0</b> 
eth0  Link encap:Ethernet  HWaddr 00:00:C0:9A:D0:DB 
      inet addr:172.16.55.106  Bcast:172.16.55.255  Mask:255.255.255.0 
      UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1 
      RX packets:844886 errors:0 dropped:0 overruns:0 frame:0
      TX packets:7668 errors:0 dropped:0 overruns:0 carrier:0
      collisions:0 txqueuelen:100
      Interrupt:11 Base address:0x7c80 Memory:c0000-c2000</pre></blockquote>

<p>Refer to the Solaris <tt class="literal">ifconfig</tt>
<tt class="literal">dnet0</tt> example at the beginning of this section,
and check the information displayed in that example against the
subnet configuration planned for our imaginary network. You'll
see that the interface needs to be reconfigured. The configuration
done by the user during the Unix installation did not provide all of
the values we planned. The address (172.16.12.2) is correct, but the
address mask (ffff0000 or 255.255.0.0) and the broadcast address
(172.16.0.0) are incorrect. Let's look at the various ways
values are assigned, and how to correct them.
</p>

</div>
<a name="tcp3-CHP-6-SECT-1.3" /></a><div class="sect2">
<h3 class="sect2">6.1.3. Assigning an Address</h3>

<p>The IP address <a name="INDEX-1173" /></a> <a name="INDEX-1174" /></a>can be assigned directly on the
<tt class="literal">ifconfig</tt> command line or indirectly from a file.
The <tt class="literal">ifconfig</tt> examples seen earlier in this chapter
had an IP address written in standard dotted decimal notation
directly on the command line. An alternative is to use a hostname
from the <em class="emphasis">/etc/hosts</em> file on the
<tt class="literal">ifconfig</tt> command line to provide the address. For
example:
</p>

<blockquote><pre class="code"># <b class="emphasis-bold">ifconfig dnet0 crab netmask 255.255.255.0</b></pre></blockquote>

<p>Most administrators are very comfortable with using hostnames in
place of addresses. Vendor configurations, however, tend to take
address assignment to another level of indirection. The
<tt class="literal">ifconfig</tt> command in the startup script references
a file. The file contains a hostname and the hostname maps to an
address. Solaris systems place the hostname in a file named
<tt class="literal">/etc/hostname.</tt><a name="INDEX-1175" /></a>
<a name="INDEX-1176" /></a><em class="replaceable">interface</em>,
where <em class="replaceable">interface</em> is the name of the
interface being configured. On our sample system the file is called
<em class="emphasis">/etc/hostname.dnet0</em>. The
<em class="emphasis">hostname.dnet0</em> file created by a standard
Solaris installation contains only a simple hostname:
</p>

<blockquote><pre class="code">$ <b class="emphasis-bold">cat /etc/hostname.dnet0</b>
crab
$ <b class="emphasis-bold">grep crab /etc/hosts</b>
172.16.12.1    crab    crab.wrotethebook.com       loghost</pre></blockquote>

<p>The example shows that the Solaris configuration created the
<em class="emphasis">hostname.dnet0</em> file and the necessary entry in
the <em class="emphasis">/etc/hosts</em> file to map the name from
<em class="emphasis">hostname.dnet0</em> to an IP address. The Solaris
boot first gets the hostname from a file and then gets the address
associated with that hostname from a second file. Both of these
entries are required for the configuration.
</p>

<p>Linux also uses indirection
<a name="INDEX-1177" /></a>
<a name="INDEX-1178" /></a>for the
<tt class="literal">ifconfig</tt> configuration. Several Linux systems,
including Red Hat, Mandrake, and Caldera, place the values used to
configure the network interface in a file named
<tt class="literal">ifcfg.</tt><a name="INDEX-1179" /></a><em class="replaceable">interface</em>,
where <em class="replaceable">interface</em> is the name of the
interface.<a href="#FOOTNOTE-53">[53]</a></p><blockquote class="footnote"> <a name="FOOTNOTE-53" /></a><p>[53]Our sample Red Hat system places the file
<em class="emphasis">ifcfg.eth0</em> in the directory
<em class="emphasis">/etc/sysconfig/network-scripts</em>.</p>
</blockquote> 

<p>For example, <em class="emphasis">ifcfg.eth0</em> contains the
configuration values for the Ethernet interface eth0.
</p>

<blockquote><pre class="code">$ <b class="emphasis-bold">cat /etc/sysconfig/network-scripts/ifcfg-eth0</b>
DEVICE=eth0
ONBOOT=yes
BOOTPROTO=none
BROADCAST=172.16.12.255
NETWORK=172.16.12.0
NETMASK=255.255.255.0
IPADDR=172.16.12.2
USERCTL=no</pre></blockquote>

<p>This file makes the configuration very easy to see.</p>

<ul><li>
<p><a name="INDEX-1180" /></a>DEVICE defines the device name, in this
case eth0.
</p>
</li><li>
<p><a name="INDEX-1181" /></a>ONBOOT specifies whether the interface is
initialized when the system boots. Normally an Ethernet interface is
brought up and running every time the system boots.
</p>
</li><li>
<p><a name="INDEX-1182" /></a>BOOTPROTO identifies the configuration
service used to configure the interface. In this case it is
<tt class="literal">none</tt>, meaning that the interface is configured
locally. Alternates are <tt class="literal">bootp</tt> if an old-fashioned
BootP server is used, or <tt class="literal">dhcp</tt> if a DHCP server is
used. If either DHCP or BootP is used, the specific configuration
values listed below are not found in this file.
</p>
</li><li>
<p><a name="INDEX-1183" /></a>BROADCAST defines the broadcast address
used by <tt class="literal">ifconfig</tt>.
</p>
</li><li>
<p><a name="INDEX-1184" /></a>NETWORK defines the network address.
</p>
</li><li>
<p><a name="INDEX-1185" /></a>NETMASK defines the address mask used by
<tt class="literal">ifconfig</tt>.
</p>
</li><li>
<p><a name="INDEX-1186" /></a>IPADDR defines the IP address used by
<tt class="literal">ifconfig</tt>.
</p>
</li><li>
<p><a name="INDEX-1187" /></a>USERCTL specifies whether users can run
<tt class="literal">usernetctl</tt> to bring the interface up or down. The
<tt class="literal">usernetctl</tt> command is found on only a few versions
of Linux. In this case, the value <tt class="literal">no</tt> prevents the
user from downing the interface.
</p>
</li></ul>
<p>Most systems take advantage of
<a name="INDEX-1188" /></a>the fact that the IP
address, subnet mask, and broadcast address can be set indirectly to
reduce the extent that startup files need to be customized. Reducing
customization lessens the chance that a system might hang while
booting because a startup file was improperly edited, and it makes it
possible to preconfigure these files for all of the systems on the
network. Solaris systems have the added advantage that the
<em class="emphasis">hosts</em>, <em class="emphasis">networks</em>, and
<em class="emphasis">netmasks</em> files, which provide input to the
<tt class="literal">ifconfig</tt> command, all produce NIS maps that can be
centrally managed at sites using NIS.
</p>

<p>A disadvantage of setting the <tt class="literal">ifconfig</tt>
<a name="INDEX-1189" /></a>values indirectly is
that it can make troubleshooting more cumbersome. If all values are
set in the boot file, you only need to check the values there. When
network configuration information is supplied indirectly, you may
need to check several files to find the problem. An error in any of
these files could cause an incorrect configuration. To make debugging
easier, a few operating systems set the configuration values directly
on the <tt class="literal">ifconfig</tt> command line in the boot file.
</p>

<p>My advice is that you follow the standard model used on your system.
If you use a Solaris system, set the address in
<em class="emphasis">/etc/hostname.dnet0</em> and
<em class="emphasis">/etc/hosts</em>. If you use a Red Hat system, set the
address in the
<em class="emphasis">/etc/sysconfig/network-scripts/ifcfg.eth0</em> file.
If you use a Slackware system, set the address directly in the
<em class="emphasis">rc.inet</em> boot file. Following the standard
procedure for your system makes it easier for others to troubleshoot
your computer. We'll see more of these alternatives as we
assign the remaining interface configuration <a name="INDEX-1190" /></a> <a name="INDEX-1191" /></a>values.
</p>

</div>
<a name="tcp3-CHP-6-SECT-1.4" /></a><div class="sect2">
<h3 class="sect2">6.1.4. Assigning a Subnet Mask </h3>

<p>In order to <a name="INDEX-1192" /></a> <a name="INDEX-1193" /></a>
<a name="INDEX-1194" /></a>function properly, every interface on
a specific physical network segment must have the same address mask.
For <em class="emphasis">crab</em> and <em class="emphasis">rodent</em>, the
netmask value is 255.255.255.0 because both systems are attached to
the same subnet. However, although <em class="emphasis">crab</em>'s
local network interface and its external network interface are parts
of the same computer, they use different netmasks because they are on
different networks.
</p>

<p>To assign an address mask, write the mask value after the
<a name="INDEX-1195" /></a>
<a name="INDEX-1196" /></a>keyword
<tt class="literal">netmask</tt> on the <tt class="literal">ifconfig</tt> command
line or as a prefix attached to the address. When written as a
prefix, the address mask is a decimal number that defines the number
of bits in the address mask. For example, 172.16.12.2/24 defines a
24-bit address mask. When the subnet mask follows the keyword
<tt class="literal">netmask</tt>, it is usually written in the dotted
decimal form used for IP addresses.<a href="#FOOTNOTE-54">[54]</a></p><blockquote class="footnote"> <a name="FOOTNOTE-54" /></a><p>[54]Hexadecimal
notation can also be used for the address mask. To enter a netmask in
hexadecimal form, write the value as a single hex number starting
with a leading 0x. For example, the hexadecimal form of 255.255.255.0
is 0xffffff00. Choose the form that is easier for you to
understand.</p> </blockquote> 

<p>For example, the following command
assigns the correct subnet mask to the dnet0 interface on
<em class="emphasis">rodent</em>:
</p>

<blockquote><pre class="code"># <b class="emphasis-bold">ifconfig le0 172.16.12.2 netmask 255.255.255.0</b></pre></blockquote>

<p>Putting the netmask value directly on the <tt class="literal">ifconfig</tt>
command line is the most common, the simplest, and the best way to
assign the mask to an interface manually. But it is rare for the mask
to be assigned manually. Like addresses, address masks are made part
of the configuration during the initial installation. To simplify
configuration, <tt class="literal">ifconfig</tt> is able to take the
netmask value from a file instead of from the command line.
Conceptually, this is similar to using a hostname in place of an IP
address. The administrator can place the mask value in either the
<em class="emphasis">hosts</em> file or the <em class="emphasis">networks</em>
file and then reference it by name. For example, the
<em class="emphasis">books-net</em> administrator might add the following
entry to <em class="emphasis">/etc/networks</em>:
</p>

<blockquote><pre class="code"> books-mask 255.255.255.0</pre></blockquote>

<p>Once this entry has been added, you can use the name
<em class="emphasis">books-mask</em> on the <tt class="literal">ifconfig</tt>
command line instead of the actual mask. For example:
</p>

<blockquote><pre class="code"># <b class="emphasis-bold">ifconfig dnet0 172.16.5.2 netmask books-mask</b></pre></blockquote>

<p>The name <em class="emphasis">books-mask</em> resolves to 255.255.255.0,
which is the correct netmask value for our sample systems.
</p>

<p>Personally, I avoid setting the address mask value indirectly from a
file that is not primarily intended for this use. The
<em class="emphasis">hosts</em><a name="INDEX-1197" /></a>
file is a particularly bad choice for storing mask values. The
<em class="emphasis">hosts</em> file is heavily used by other programs,
and placing a mask value in this file might confuse one of these
programs. Setting the address mask directly on the command line or
from a file that is dedicated to this purpose is probably the best
approach.
</p>

<p>On Solaris systems, the
<em class="emphasis">/etc/inet/netmasks</em><a name="INDEX-1198" /></a>
<a name="INDEX-1199" /></a> file is specifically designed to set the
subnet mask.<a href="#FOOTNOTE-55">[55]</a> The
<em class="emphasis">/etc/inet/netmasks</em> file is a table of one-line
entries, each containing a network address separated from a mask by
whitespace.<a href="#FOOTNOTE-56">[56]</a></p><blockquote class="footnote"> <a name="FOOTNOTE-55" /></a><p>[55]<em class="emphasis">/etc/netmasks</em> is
symbolically linked to
<em class="emphasis">/etc/inet/netmasks</em>.</p> </blockquote><blockquote class="footnote"> <a name="FOOTNOTE-56" /></a><p>[56]Use the official network address, not a
subnet address.</p> </blockquote> 

<p>If a Solaris system on
<em class="emphasis">books-net</em> (172.16.0.0) has an
<em class="emphasis">/etc/inet/netmasks</em> file that contains the entry:
</p>

<blockquote><pre class="code"> 172.16.0.0 255.255.255.0</pre></blockquote>

<p>then the following <tt class="literal">ifconfig</tt> command can be used to
set the address mask:
</p>

<blockquote><pre class="code"># <b class="emphasis-bold">ifconfig dnet0 172.16.5.1 netmask +</b></pre></blockquote>

<p>The plus sign after the keyword <tt class="literal">netmask</tt> causes
<tt class="literal">ifconfig</tt> to take the mask value from
<em class="emphasis">/etc/inet/netmasks</em>. <tt class="literal">ifconfig</tt>
searches the file for a network address that matches the network
address of the interface being configured. It then extracts the mask
associated with that address and applies it to the interface.
</p>

<p>Most Linux systems also set the address mask indirectly from a file.
The <em class="emphasis">ifcfg-eth0</em><a name="INDEX-1200" /></a>
<a name="INDEX-1201" /></a> file shown in the previous section
contains the following line:
</p>

<blockquote><pre class="code">NETMASK=255.255.255.0</pre></blockquote>

<p>This line clearly defines the netmask value that is used by the
<tt class="literal">ifconfig</tt> command. To modify the address mask on
this Red Hat system, edit this line <a name="INDEX-1202" /></a> <a name="INDEX-1203" /></a> <a name="INDEX-1204" /></a>in the
<em class="emphasis">ifcfg-eth0</em> file.
</p>

</div>
<a name="tcp3-CHP-6-SECT-1.5" /></a><div class="sect2">
<h3 class="sect2">6.1.5. Setting the Broadcast Address </h3>

<p><a name="INDEX-1205" /></a>RFC 919,
<em class="emphasis">Broadcasting Internet Datagrams</em>, clearly
<a name="INDEX-1206" /></a> <a name="INDEX-1207" /></a>
<a name="INDEX-1208" /></a>defines the format of a broadcast
address as an address with all host bits set to 1. Since the
broadcast address is so precisely defined,
<tt class="literal">ifconfig</tt> is able to compute it automatically, and
you should always be able to use the default. Unfortunately, the user
in the example under <a href="ch06_01.html#tcp3-CHP-6-SECT-1.2">Section 6.1.2, "Checking the Interface with ifconfig "</a><em class="emphasis">"</em>
used a broadcast address with all host bits set to 0 and didn't
allow the broadcast address to be set by default.
</p>

<p>Correct this mistake by defining a broadcast address for the network
device with the <tt class="literal">ifconfig</tt> command. Set the
broadcast address in the <tt class="literal">ifconfig</tt> command using
the keyword <tt class="literal">broadcast</tt> followed by the correct
broadcast address. For example, the <tt class="literal">ifconfig</tt>
command to set the broadcast address for
<em class="emphasis">crab</em>'s dnet0 interface is:
</p>

<blockquote><pre class="code"># <b class="emphasis-bold">ifconfig dnet0 172.16.12.1 netmask 255.255.255.0</b> <b class="emphasis-bold">broadcast 172.16.12.255</b></pre></blockquote>

<p>Note that the broadcast address is relative to the local subnet.
<em class="emphasis">crab</em> views this interface as connected to
network 172.16.12.0; therefore, its broadcast address is
172.16.12.255. Depending on the implementation, a Unix system could
interpret the address 172.16.255.255 as host address 255 on subnet
255 of network 172.16.0.0, or as the broadcast address for
<em class="emphasis">books-net</em> as a whole. In neither case would it
consider 172.16.255.255 the broadcast address for subnet 172.16.12.0.
</p>

<p>Solaris <a name="INDEX-1209" /></a>systems can indirectly set
the broadcast address from the netmask value defined in
<em class="emphasis">/etc/inet/netmasks</em>, if that file is used. The
previous section showed that <tt class="literal">netmask</tt>
<tt class="literal">+</tt> takes the netmask value from a file. Likewise,
the <tt class="literal">broadcast +</tt> syntax calculates the correct
broadcast value using the netmask value from the
<em class="emphasis">netmasks</em> file:
</p>

<blockquote><pre class="code"># <b class="emphasis-bold">ifconfig dnet0 172.16.12.1 netmask + broadcast +</b></pre></blockquote>

<p>Assume that the netmask defined in <em class="emphasis">netmasks</em> is
255.255.255.0. This tells the Solaris system that the first three
bytes are network bytes and that the fourth byte contains the host
portion of the address. Since the standard broadcast address consists
of the network bits plus host bits of all 1s, Solaris can easily
calculate that the broadcast address in this case is 172.16.12.255.
</p>

<p>Linux <a name="INDEX-1210" /></a>makes it even easier. The
<em class="emphasis">ifcfg-eth0</em> file on our sample Red Hat system
clearly defines the broadcast address with the line:
</p>

<blockquote><pre class="code">BROADCAST=172.16.12.255</pre></blockquote>

<p>Modify the broadcast address by modifying this line in the
<em class="emphasis">ifcfg-eth0</em> file.
</p>

</div>
<a name="tcp3-CHP-6-SECT-1.6" /></a><div class="sect2">
<h3 class="sect2">6.1.6. The Other Command Options </h3>

<p>We've used <tt class="literal">ifconfig</tt> to set the interface
address, the subnet mask, and the broadcast address. These are
certainly the most important functions of
<tt class="literal">ifconfig</tt>, but it has other functions as well. It
can enable or disable the address resolution protocol and the
interface itself. <tt class="literal">ifconfig</tt> can set the routing
metric used by the Routing Information Protocol (RIP) and the maximum
transmission unit (MTU) used by the interface. We'll look at
examples of each of these functions.
</p>

<a name="tcp3-CHP-6-SECT-1.6.1" /></a><div class="sect3">
<h3 class="sect3">6.1.6.1. Enabling and disabling the interface </h3>

<p>The <tt class="literal">ifconfig</tt> <a name="INDEX-1211" /></a>
<a name="INDEX-1212" /></a>
<a name="INDEX-1213" /></a>command has two
arguments, <tt class="literal">up</tt> and <tt class="literal">down</tt>, for
enabling and disabling the network interface. The
<tt class="literal">up</tt> argument enables the network interface and
marks it ready for use. The <tt class="literal">down</tt> argument disables
the interface so that it cannot be used for network traffic.
</p>

<p>Use the <tt class="literal">down</tt> argument when interactively
reconfiguring an interface. Some configuration parameters -- for
example, the IP address -- cannot be changed unless the interface
is down. First, the interface is brought down. Then, the
reconfiguration is done, and the interface is brought back up. For
example, the following steps change the address for an interface:
</p>

<blockquote><pre class="code"># <b class="emphasis-bold">ifconfig eth0 down</b>
# <b class="emphasis-bold">ifconfig eth0 172.16.1.2 up</b></pre></blockquote>

<p>After these commands execute, the interface operates with the new
configuration values. The <tt class="literal">up</tt> argument in the
second <tt class="literal">ifconfig</tt> command is not always required
because it is the default on some systems. However, an explicit
<tt class="literal">up</tt> is commonly used after the interface has been
disabled, or when an <tt class="literal">ifconfig</tt> command is used in a
script file to avoid problems because <tt class="literal">up</tt> is not
the default on all systems.
</p>

</div>

<a name="tcp3-CHP-6-SECT-1.6.2" /></a><div class="sect3">
<h3 class="sect3">6.1.6.2. ARP </h3>

<p><a href="ch02_01.html">Chapter 2, "Delivering the Data"</a> discusses the <a name="INDEX-1214" /></a> <a name="INDEX-1215" /></a>Address Resolution Protocol (ARP),
an important protocol that maps IP addresses to physical Ethernet
addresses. Enable ARP with the <tt class="literal">ifconfig</tt> keyword
<tt class="literal">arp</tt> and disable it with the keyword
<tt class="literal">-arp</tt>. It is possible (though very unlikely) that a
host attached to your network cannot handle ARP. This would only
happen on a network using specialized equipment or developmental
hardware. In these very rare circumstances, it may be necessary to
disable ARP in order to interoperate with the nonstandard systems. By
default, <tt class="literal">ifconfig</tt> enables ARP. Leave ARP enabled
on all your systems.
</p>

</div>

<a name="tcp3-CHP-6-SECT-1.6.3" /></a><div class="sect3">
<h3 class="sect3">6.1.6.3. Promiscuous mode</h3>

<p>In <a href="ch13_01.html">Chapter 13, "
Troubleshooting TCP/IP"</a>, promiscuous
<a name="INDEX-1216" /></a>
<a name="INDEX-1217" /></a> <a name="INDEX-1218" /></a>mode is used to examine the packets
traveling on a local Ethernet. By default, an Ethernet interface
passes only frames that are addressed to the local host up to the
higher layer protocols. Promiscuous mode passes all frames up without
regard to the address in those frames.
</p>

<p>On a <a name="INDEX-1219" /></a>Linux
system, promiscuous mode is enabled using the
<tt class="literal">promisc</tt> option of the <tt class="literal">ifconfig</tt>
command. For example:
</p>

<blockquote><pre class="code">$ <b class="emphasis-bold">ifconfig eth0 promisc</b></pre></blockquote>

<p>Promiscuous mode is disabled by using
<tt class="literal">-promisc</tt>.<a href="#FOOTNOTE-57">[57]</a> By
default promiscuous mode is disabled. When it is enabled, the local
system is forced to process many packets that are normally discarded
by the Ethernet interface hardware. Promiscuous mode is enabled only
for certain troubleshooting applications.
</p><blockquote class="footnote"> <a name="FOOTNOTE-57" /></a><p>[57]On Solaris systems,
promiscuous mode is enabled by programs that need it. It is not set
by the <tt class="literal">ifconfig</tt> command.</p> </blockquote>

</div>

<a name="tcp3-CHP-6-SECT-1.6.4" /></a><div class="sect3">
<h3 class="sect3">6.1.6.4. Metric </h3>

<p>On some <a name="INDEX-1220" /></a> <a name="INDEX-1221" /></a> <a name="INDEX-1222" /></a>systems, the
<tt class="literal">ifconfig</tt> command creates an entry in the routing
table for every interface that is assigned an IP address. Each
interface is the route to a network. Even if a host isn't a
gateway, its interface is still its "route" to the local
network. <tt class="literal">ifconfig</tt> determines the route's
destination network by applying the interface's address mask to
the interface's IP address. For example, the dnet0 interface on
<em class="emphasis">crab</em> has an address of 172.16.12.1 and a mask of
255.255.255.0. Applying this mask to the address provides the
destination network, which is 172.16.12.0. The <tt class="literal">netstat
-in</tt> display shows the destination address:
</p>

<blockquote><pre class="code">% <b class="emphasis-bold">netstat -in</b> 
Name Mtu  Net/Dest    Address     Ipkts  Ierrs Opkts Oerrs Collis Queue 
le0  1500 172.16.12.0 172.16.12.1 1125826 16   569786  0    8914   0
lo0  1536 127.0.0.0   127.0.0.1   94280   0    94280   0    0      0</pre></blockquote>

<p>The <a name="INDEX-1223" /></a>Routing Information Protocol (RIP)
<a name="INDEX-1224" /></a>is a routing protocol
sometimes used by Unix. RIP does two things: it distributes routing
information to other hosts, and it uses incoming routing information
to build routing tables dynamically. The routes created by
<tt class="literal">ifconfig</tt> are one source of the routing information
distributed by RIP, and the <tt class="literal">ifconfig metric</tt>
argument can be used to control how RIP uses this routing
information.
</p>

<p>RIP makes routing decisions based on the cost of a route. The
route's <a name="INDEX-1225" /></a>cost is determined by a routing metric
associated with the route. A routing metric is just a number. The
lower the number, the lower the cost of the route; the higher the
number, the higher the cost. When building a routing table, RIP
favors low-cost routes over high-cost routes. Directly connected
networks are given a very low cost. Therefore, the default metric is
for a route through an interface to a directly attached network.
However, you can use the <tt class="literal">metric</tt> argument to supply
a different routing metric for an interface.
</p>

<p>To increase the cost of an interface to 3, so that RIP prefers routes
with values of 0, 1, or 2, use <tt class="literal">metric 3</tt> on the
<tt class="literal">ifconfig</tt> command line:
</p>

<blockquote><pre class="code"># <b class="emphasis-bold">ifconfig std0 10.104.0.19 metric 3</b></pre></blockquote>

<p>Use the metric option only if there is another route to the same
destination and you want to use it as the primary route. We did not
use this command on <em class="emphasis">crab</em> because it has only one
interface connected to the outside world. If it had a second
connection, say, through a higher-speed link, then the command shown
above could be used to direct traffic through the higher-performance
interface.
</p>

<p>A related <tt class="literal">ifconfig</tt> parameter is available on
<a name="INDEX-1226" /></a>Solaris systems. RIP builds the
routing table by choosing the most economical routes, and it
distributes the routing table information to other hosts. The
<tt class="literal">metric</tt> parameter controls which routes RIP selects
as the lowest cost. The <tt class="literal">private</tt> argument,
available on Solaris systems, controls the routes that RIP
distributes. If <tt class="literal">private</tt> is specified on the
<tt class="literal">ifconfig</tt> command line, the route created by that
<tt class="literal">ifconfig</tt> command is not distributed by RIP. The
default value is <tt class="literal">-private</tt>, which permits the route
to be distributed. The <tt class="literal">private</tt> parameter is not
universally supported.
</p>

<p>Additionally, not all systems make use of the
<tt class="literal">metric</tt> argument. A
<a name="INDEX-1227" /></a>Linux system doesn't create a
routing table entry when it processes the <tt class="literal">ifconfig</tt>
command. When configuring a Linux system, you add an explicit
<tt class="literal">route</tt> command for each interface. (The
<tt class="literal">route</tt> command is covered in the next chapter.)
Linux systems reject the <tt class="literal">metric</tt> argument, as this
example shows:
</p>

<blockquote><pre class="code"># <b class="emphasis-bold">ifconfig eth0 192.168.0.4 metric 3</b>
SIOCSIFMETRIC: Operation not supported</pre></blockquote>

<p>Set the routing metric in a routing configuration file instead of on
the <tt class="literal">ifconfig</tt> command line. This is the preferred
method of providing routing information for newer routing software.
We discuss the format of routing configuration files in the next
chapter.
</p>

</div>

<a name="tcp3-CHP-6-SECT-1.6.5" /></a><div class="sect3">
<h3 class="sect3">6.1.6.5. Maximum transmission unit </h3>

<p>A network has a <a name="INDEX-1228" /></a> <a name="INDEX-1229" /></a>maximum transmission
<a name="INDEX-1230" /></a>unit (MTU), which is the
largest packet that can be transported over that physical network. On
<a name="INDEX-1231" /></a>Ethernet,
the maximum size is 1500 bytes, which is defined as part of the
Ethernet standard. There is rarely any need to change the MTU on the
<tt class="literal">ifconfig</tt> command line. By default,
<tt class="literal">ifconfig</tt> chooses the optimum MTU, which is usually
the largest legal MTU for a given type of network hardware. A large
MTU is the default because it normally provides the best performance.
However, a smaller MTU is helpful to achieve the following goals:
</p>

<ul><li>
<p>To avoid
<a name="INDEX-1232" /></a>fragmentation. If the traffic travels
from <a name="INDEX-1233" /></a>a network with a large
MTU (such as an FDDI network with an MTU of 4500 bytes) through a
network with a smaller MTU (like an Ethernet), the smaller MTU size
may be best in order to avoid packet fragmentation. It is possible
that specifying an MTU of 1500 on the interface connected to the FDDI
may actually improve performance by avoiding fragmentation in the
routers. This would be done only if fragmentation actually appeared
to be the cause of a performance problem.
</p>
</li><li>
<p>To reduce <a name="INDEX-1234" /></a>buffer overruns or similar problems. On
serial line connections, it is possible to have equipment of such low
performance that it cannot keep up with standard 1006-byte packets.
In this case, it is possible to avoid buffer overruns or SILO
overflows by using a smaller MTU. However, such solutions are
temporary fixes. The real fix is to purchase the correct hardware for
the application.
</p>
</li></ul>
<p>To change the MTU, use the <tt class="literal">mtu</tt> command-line
argument:
</p>

<blockquote><pre class="code"># <b class="emphasis-bold">ifconfig fddi0 172.16.16.1 netmask 255.255.255.0 mtu 1500</b></pre></blockquote>

<p>This forces the FDDI interface on 172.16.16.1 to use an MTU of 1500
bytes.
</p>

</div>

<a name="tcp3-CHP-6-SECT-1.6.6" /></a><div class="sect3">
<h3 class="sect3">6.1.6.6. Point-to-point </h3>

<p>There are probably several more <tt class="literal">ifconfig</tt>
command-line arguments available on your system. Linux has parameters
to define the PC interrupt of the Ethernet hardware
(<tt class="literal">irq</tt>) and the Ethernet hardware address
(<tt class="literal">hw</tt>), and to enable multicasting
(<tt class="literal">multicast</tt>) and promiscuous mode
(<tt class="literal">promisc</tt>). Solaris has arguments to set up or tear
down the streams for an interface
(<tt class="literal">plumb</tt>/<tt class="literal">unplumb</tt>) and to use
Reverse ARP (RARP) to obtain the IP address for an interface
(<tt class="literal">auto-revarp</tt>). But most of these parameters are
not standardized between versions of Unix.
</p>

<p>One last feature that is available on
<a name="INDEX-1235" /></a>
<a name="INDEX-1236" /></a>most versions
of Unix is the ability to define point-to-point connections with the
<tt class="literal">ifconfig</tt> command. Point-to-point connections are
network links that directly connect only two computers. Of course the
computers at either end of the link could be gateways to the world,
but only two computers are directly connected to the link. Examples
of a point-to-point connection are two computers linked together by a
leased telephone line, or two computers in an office linked together
by a null modem cable.
</p>

<p>To define a point-to-point link on a
<a name="INDEX-1237" /></a>Solaris system:
</p>

<blockquote><pre class="code"># <b class="emphasis-bold">ifconfig zs0 172.16.62.1 172.16.62.2</b></pre></blockquote>

<p>This <tt class="literal">ifconfig</tt> command has two addresses
immediately following the interface name. The first is the address of
the local host. The second address, called the destination address,
is the address of the remote host at the other end of the
point-to-point link. The second address shows up as the Net/Dest
value in a <tt class="literal">netstat</tt> <tt class="literal">-ni</tt> display.
</p>

<p>On a Linux system, this same
<a name="INDEX-1238" /></a>configuration looks
slightly different:
</p>

<blockquote><pre class="code">$ <b class="emphasis-bold">ifconfig sl0 172.16.62.1 point-to-point 172.16.62.2</b></pre></blockquote>

<p>The syntax is different but the effect is the same. This enables the
interface to run in point-to-point mode and identifies the hosts at
both ends of the link.
</p>

<p>Does this set up the Point-to-Point Protocol (PPP) used for TCP/IP
serial line communication? No, it does not. These
<tt class="literal">ifconfig</tt> parameters sometimes confuse people about
how to set up PPP. There is much more to configuring PPP, which we
cover later in this chapter.
</p>

<p>Before moving on to PPP, you should note that the configuration
entered on an <tt class="literal">ifconfig</tt> command line will not
survive a <a name="INDEX-1239" /></a>system boot. For
a permanent configuration, put <tt class="literal">ifconfig</tt> in a
startup file.
</p>

</div>

<a name="tcp3-CHP-6-SECT-1.6.7" /></a><div class="sect3">
<h3 class="sect3">6.1.6.7. Putting ifconfig in the startup scripts</h3>

<p>The <tt class="literal">ifconfig</tt> command <a name="INDEX-1240" /></a>
<a name="INDEX-1241" /></a>
<a name="INDEX-1242" /></a>
<a name="INDEX-1243" /></a>is normally executed at boot time by a
startup file. The two basic Unix startup models, the BSD model and
the System V model, were explained in <a href="ch05_01.html">Chapter 5, "Basic Configuration "</a>.
On BSD Unix systems, the <tt class="literal">ifconfig</tt> commands are
usually located in <em class="emphasis">/etc/rc.boot</em> or
<em class="emphasis">/etc/rc.local</em>.
</p>

<p>To override a BSD system's default configuration, place a full
<tt class="literal">ifconfig</tt> command in the
<em class="emphasis">rc.local</em><a name="INDEX-1244" /></a>
<a name="INDEX-1245" /></a> script.
<em class="emphasis">rc.local</em> executes at the end of the startup
process. Any interface configuration values set in this file override
the earlier interface configuration. For example, the following line
placed in that file configures eth0 without regard to any earlier
configuration:
</p>

<blockquote><pre class="code">ifconfig eth0 172.16.12.1 broadcast 172.16.12.255 netmask 255.255.255.0</pre></blockquote>

<p>The BSD startup model is used on BSD systems and SunOS systems. Linux
and Solaris systems use the System V startup model. However, Red Hat
Linux systems have an <em class="emphasis">rc.local</em> script in the
<em class="emphasis">/etc/rc.d</em> directory. On a Red Hat system, place
the custom <tt class="literal">ifconfig</tt> command in the
<em class="emphasis">rc.local</em> file to override the default
configuration.
</p>

<p>Solaris does not have an <em class="emphasis">rc.local</em> script or a
central directory of scripts for all runlevels. If you want to use an
<em class="emphasis">rc.local</em> script on a
<a name="INDEX-1246" /></a>Solaris system, you need to create your
own and add it to the runlevel 3 directory. You need to name it
properly to ensure it executes at the end of the Solaris startup
process. For example, the file
<em class="emphasis">/etc/rc3.d/S99local</em> would execute at the end of
the standard Solaris runlevel 3 startup. Commands placed in this file
would override the previous configuration.
</p>

<p>If possible, however, configure the network with the standard tools
and procedures provided with your system. Directly modifying startup
scripts or adding nonstandard scripts can lead to lots of confusion
for the people who help you maintain your systems.
</p>

</div>
</div>
</div>








<hr width="684" align="left" />
<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch05_05.html"><img alt="Previous" border="0" src="../gifs/txtpreva.gif" /></a></td><td align="center" valign="top" width="228"><a href="index.html"><img alt="Home" border="0" src="../gifs/txthome.gif" /></a></td><td align="right" valign="top" width="228"><a href="ch06_02.html"><img alt="Next" border="0" src="../gifs/txtnexta.gif" /></a></td></tr><tr><td align="left" valign="top" width="228">5.5. Summary </td><td align="center" valign="top" width="228"><a href="index/index.html"><img alt="Book Index" border="0" src="../gifs/index.gif" /></a></td><td align="right" valign="top" width="228">6.2. TCP/IP Over a Serial Line </td></tr></table></div>
<hr width="684" align="left" />

<img alt="Library Navigation Links" border="0" src="../gifs/navbar.gif" usemap="#library-map" />
<p><p><font size="-1"><a href="copyrght.html">Copyright &copy; 2002</a> O'Reilly &amp; Associates. All rights reserved.</font></p>

<map name="library-map"><area shape="rect" coords="1,0,84,90" href="../index.html" /><area shape="rect" coords="86,-7,176,90" href="../ssh/index.html" /><area shape="rect" coords="178,0,265,101" href="index.html" /><area shape="rect" coords="266,0,333,90" href="../nfs/index.html" /><area shape="rect" coords="334,-1,429,93" href="../snmp/index.html" /><area shape="rect" coords="431,0,529,116" href="../tshoot/index.html" /><area shape="rect" coords="534,0,594,104" href="../dns/index.html" /><area shape="rect" coords="595,1,704,108" href="../fire/index-2.html" /></map>

</body>
<!-- Mirrored from nnc3.com/mags/Networking2/tcp/ch06_01.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 28 Jul 2017 17:52:55 GMT -->
</html>
