<html>
<!-- Mirrored from nnc3.com/mags/Networking2/tshoot/ch12_01.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 28 Jul 2017 17:54:59 GMT -->
<head><title>Troubleshooting Strategies (Network Troubleshooting Tools)</title><link rel="stylesheet" type="text/css" href="../style/style1.css" />

<meta name="DC.Creator" content="Joseph D. Sloan" /><meta name="DC.Format" content="text/xml" scheme="MIME" /><meta name="DC.Language" content="en-US" /><meta name="DC.Publisher" content="O'Reilly &amp; Associates, Inc." /><meta name="DC.Source" scheme="ISBN" content="059600186XL" /><meta name="DC.Subject.Keyword" content="stuff" /><meta name="DC.Title" content="Network Troubleshooting Tools" /><meta name="DC.Type" content="Text.Monograph" />

</head><body bgcolor="#ffffff">

<img alt="Book Home" border="0" src="gifs/smbanner.gif" usemap="#banner-map" /><map name="banner-map"><area shape="rect" coords="1,-2,616,66" href="index.html" alt="Network Troubleshooting Tools" /><area shape="rect" coords="629,-11,726,25" href="jobjects/fsearch.html" alt="Search this book" /></map>

<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch11_05.html"><img alt="Previous" border="0" src="../gifs/txtpreva.gif" /></a></td><td align="center" valign="top" width="228"><a href="index.html"></a></td><td align="right" valign="top" width="228"><a href="ch12_02.html"><img alt="Next" border="0" src="../gifs/txtnexta.gif" /></a></td></tr></table><div>




<h1 class="chapter">Chapter 12. Troubleshooting Strategies</h1>
<div class="htmltoc"><h4 class="tochead">Contents:</h4>
      <a href="#nettroubletools-CHP-12-SECT-1">Generic Troubleshooting</a><br />
<a href="ch12_02.html">Task-Specific Troubleshooting</a><br /></p><p></div>

While many of the tools described in this book are extremely
powerful, no one tool does everything. If you have been downloading
and installing these tools as you have read this book, you now have
an extensive, versatile set of tools. When faced with a problem, you
should be equipped to select the best tool or tools for the
particular job, augmenting your selection with other tools as needed.
</p><p>

This chapter outlines several strategies that show how these tools
can be used together. When troubleshooting, your approach should be
to look first at the specific task and then select the most
appropriate tool(s) based on the task. I do not describe the details
of using the tools or show output in this chapter. You should already
be familiar with these from the previous chapters. Rather, this
chapter focuses on the selection of tools and the overall strategy
you should take in using them. If you feel confident in your
troubleshooting skills, you may want to skip this chapter.
</p><p>

<div class="sect1"><a name="nettroubletools-CHP-12-SECT-1" /></a>
<h2 class="sect1">12.1. Generic Troubleshooting</h2>

<a name="INDEX-2853" /></a><a name="INDEX-2854" /></a><a name="INDEX-2855" /></a><a name="INDEX-2856" /></a>Any troubleshooting task is
basically a series of steps. The actual steps you take will vary from
problem to problem. Later steps in the process may depend on the
results from earlier steps. Still, it is worth thinking about and
mapping out the steps since doing this will help you remain focused
and avoid needless steps. In watching others troubleshoot, I have
been astonished at how often people perform tests with no goal in
mind. Often the test has no relation to the problem at hand. It is
just something easy to do. When your car won't start, what is
the point of checking the air pressure of the tires?
</p><p>

For truly difficult problems, you will need to become formal and
systematic. A somewhat general, standard series of steps you can go
through follows, along with a running example. Keep in mind, this set
of steps is only a starting point.
</p><p>

<ol><li>
<a name="INDEX-2857" /></a><a name="INDEX-2858" /></a><a name="INDEX-2859" /></a>Document.
Before you do anything else, start documenting what you are doing.
This is a real test of willpower and self-discipline. It is extremely
difficult to force yourself to sit down and write a problem
description or take careful notes when your system is down or
crackers are running rampant through your system.<a href="#FOOTNOTE-41">[41]</a> This is not just you; everyone has this problem. But it
is an essential step for several reasons.
</p><p><blockquote class="footnote">
<a name="FOOTNOTE-41" /></a>[41]Compromised hosts are a special problem requiring special
responses. Documentation can be absolutely essential, particularly if
you are contemplating legal action or have liability concerns.
Documentation used in legal actions has special requirements. For
more information you might look at Simson Garfinkel and Gene
Spafford's <em class="emphasis">Practical UNIX &amp; Internet
Security</em> or visit <a href="http://www.cert.org/nav/recovering.html">http://www.cert.org/nav/recovering.html</a>.</p><p>
</blockquote>

Depending on your circumstances, management may require a written
report. Even if this isn't the usual practice, if an outage
becomes prolonged or if there are other consequences, it might become
necessary. This is particularly true if there are some legal
consequences of the problem. An accurate log can be essential in such
cases.
</p><p>

If you have a complex problem, you are likely to forget at some point
what you have actually done. This often means starting over. It can
be particularly frustrating if you appear to have found a solution,
but you can't remember exactly what you did. A seemingly
insignificant step may prove to be a key element in a solution.
</p><p>
</li><li>
<a name="INDEX-2860" /></a><a name="INDEX-2861" /></a>Collect information and
identify symptoms. Actually, this step is two intertwined steps. But
they are often so intertwined that you usually can't separate
them. You must collect information while filtering that information
for indications of anomalous behavior. These two steps will be
repeated throughout the troubleshooting process. This is easiest when
you have a clear sense of direction.
</p><p>

As you identify symptoms, try to expand and clarify the problem. If
the problem was reported by someone else, then you will want to try
to recreate the problem so that you can observe the symptoms
directly. Keep in mind, if you can't recognize normal behavior,
you won't be able to recognize anomalous behavior. This has
been a recurring theme in this book and a reason you should learn how
to use these tools before you need them.
</p><p>

As an example, the first indication of a problem might be a user
complaining that she cannot<em class="filename"> telnet </em>from host
<em class="emphasis">bsd1</em> to host <em class="emphasis">lnx1</em>. To
expand and clarify the problem, you might try different applications.
Can you connect using <em class="filename">ftp </em>? You might look to
see if <em class="emphasis">bsd1</em> and <em class="emphasis">lnx1</em> are on
the same network or different networks. You might see if
<em class="emphasis">lnx1</em> can reach <em class="emphasis">bsd1</em>. You
might include other local and remote hosts to see the extent of the
problem.
</p><p>
</li><li>
<a name="INDEX-2862" /></a>Define the problem. Once you
have a clear idea, you can begin coming to terms with the problem.
This is not the same as identifying the symptoms but is the process
of combining the symptoms and making generalizations. You are looking
for common elements that allow you to succinctly describe the
anomalous behavior of a system.
</p><p>

Your problem definition may go through several refinements.
Continuing with the previous problem, you might, over time, generate
the following series of problem definitions:
</p><p>

<ul><li>
<em class="filename">bsd1</em> can't <em class="emphasis">telnet</em> to
<em class="filename">lnx1.</em>
</p><p>
</li><li>
<em class="filename">bsd1</em> can't connect to
<em class="filename">lnx1.</em>
</p><p>
</li><li>
<em class="filename">bsd1</em> can't connect to
<em class="filename">lnx1</em>, but <em class="filename">lnx1</em> can connect
to other hosts including <em class="filename">bsd1.</em>
</p><p>
</li><li>
Hosts on the same network as <em class="filename">lnx1</em> can't
connect to <em class="filename">lnx1.</em>
</p><p>
</li><li>
Hosts on the same network as <em class="filename">lnx1</em> can't
connect to <em class="filename">lnx1</em>, but hosts on remote networks
can connect to <em class="filename">lnx1.</em>
</p><p>
</li></ul>



(Yes, this was a real problem, and no, I didn't get that last
one backward.)
</p><p>

It is natural to try to define the problem as quickly as possible,
but you shouldn't be too tied to your definition. Try to keep
an open mind and be willing to redefine your problem as your
information changes.
</p><p>
</li><li>
<a name="INDEX-2863" /></a><a name="INDEX-2864" /></a>Identify systems or subsystems
involved. As you collect information, as seen in the previous
example, you will define and refine not only the nature of the
problem, but also the scope of the problem. This is the step in which
we divide and hopefully conquer our problem.
</p><p>

In this example, we have worked outward from one system to include a
number of systems. Usually troubleshooting tries to narrow the scope
of the problem, but as seen from this example, in networking just the
opposite may happen. You must discover the full scope of the problem
before you can narrow your focus. In this running example, realizing
that remote connections could connect was a key discovery.
</p><p>
</li><li>
<a name="INDEX-2865" /></a><a name="INDEX-2866" /></a>Develop a testable
hypothesis. Of course, what you can test will depend on what tools
you have, the rationale for this book. But don't let tools
drive your approach. With the definition of the problem and continual
refinement comes the generation of the hypotheses as to the cause or
nature of the problem. Such generalizations are relatively worthless
unless they can be verified. (Remember those lectures on the
scientific method in high school?) In this sense, developing a set of
tests is more important than having an exact definition of a problem.
In many instances, if you know the source of the problem, you can
correct it without fully understanding the problem. For example, if
you know an Ethernet card is failing, you can replace it without ever
worrying about which chip on the card malfunctioned. I'm not
suggesting that you don't want to understand the problem, but
that there are levels of understanding. Your hypotheses must be
guided by what you can test. As in science, an untestable hypothesis
is worthless.
</p><p>

In general, you want tests that will reduce the size of the search
space (i.e., identify subsystem involved), that are easy to apply,
that do not create further problems, and so on.
</p><p>

In our running example, a necessary first step in making a connection
is doing address resolution. This suggests that there might be some
problem with the ARP mechanism. Notice that this is not a full
hypothesis, but rather a point of further investigation. Having
expanded the scope of the problem, we are attempting to focus in on
subsystems to reduce the problem. Also notice that I haven't
used any fancy tools up to this point. Keep it simple as long as you
can.
</p><p>
</li><li>
Select and apply tests. Not all tests are created equally. Some will
be much easier to apply, while others will provide more information.
Determining the optimal order for a set of tests is largely a
judgment call. Clearly, the simple tests that answer questions
decisively are the best.
</p><p>

Returning to our example, there are several ways we could investigate
whether the ARP mechanism is functioning correctly. One way would be
to use <em class="filename">tcpdump</em> or <em class="filename">ethereal</em>
to capture traffic on the network to see if the ARP requests and
responses are present. A simpler test, however, is to use the
<em class="filename">arp</em> command to see if the appropriate entries
are in the ARP cache on the hosts that are trying to connect to
<em class="filename">lnx1</em>. In this instance, it was observed that the
entries were missing from all the hosts attempting to connect to
<em class="filename">lnx1</em>. The exception was the router on the
network that had a much longer cache timeout than did the local
hosts. This also explained why remote hosts could connect but local
hosts could not connect. The remote hosts always went through the
router, which had cached the Ethernet address bypassing the ARP
mechanism. Note that this was not a definitive test but was done
first because it was much easier.
</p><p>
</li><li>
<a name="INDEX-2867" /></a><a name="INDEX-2868" /></a><a name="INDEX-2869" /></a>Assess results. As you
perform tests, you will need to assess the results, refine your
tests, and repeat the process. You will want new tests that confirm
your results. This is clearly an iterative process.
</p><p>

With our extended example, two additional tests were possible. One
was to manually add the address of <em class="filename">lnx1</em> to
<em class="filename">bsd1</em>'s ARP table using the
<em class="filename">arp</em> command. When this was done, connectivity
was restored. When the entry was deleted, connectivity was lost. A
more revealing but largely unnecessary test using packet-capture
software to watch the exchange of packets between the
<em class="filename">bsd1</em> and <em class="filename">lnx1</em> revealed that
<em class="filename">bsd1</em>'s ARP requests were being ignored by
<em class="filename">lnx1</em>.
</p><p>
</li><li>
<a name="INDEX-2870" /></a><a name="INDEX-2871" /></a><a name="INDEX-2872" /></a>Develop and assess solutions.
Once you have clearly identified the problem, you must develop and
assess possible solutions. With many problems, there will be several
possible solutions to consider. You should not hastily implement a
solution until you have thought out the consequences. With
<em class="filename">lnx1</em>, solutions ranged from rebooting the system
to reinstalling software. I chose the simplest first and rebooted the
system.
</p><p>
</li><li>
<a name="INDEX-2873" /></a>Implement and evaluate your solution.
Once you have decided on a solution and have implemented it, you
should confirm the proper operation of your system. Depending on the
scope of the changes needed, this may mean extensive testing of the
system and all related systems.
</p><p>

With our running problem, this was not necessary. Connectivity was
fully restored when the system was rebooted. What caused the problem?
That was never fully resolved, but since the problem never recurred,
it really isn't an issue.
</p><p>

If restarting the system hadn't solved the problem, what would
have been the next step? In this case, the likely problem was
corrupted system software. If you are running an integrity checker
like <em class="filename">tripwire</em>, you might try locating anything
that has changed and do a selective reinstallation. Otherwise, you
may be faced with reinstalling the operating system.
</p><p>
</li></ol>
One last word of warning. It is often tempting to seize on an overly
complex explanation and ignore simpler explanations. Frequently,
problems really are complex, but not always. It is worth asking
yourself if there is a simpler solution. Often, this will save a
tremendous amount of time.<a name="INDEX-2874" /></a><a name="INDEX-2875" /></a><a name="INDEX-2876" /></a> 
</p><p>

</div>




<hr width="684" align="left" />
<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch11_05.html"><img alt="Previous" border="0" src="../gifs/txtpreva.gif" /></a></td><td align="center" valign="top" width="228"><a href="index.html"><img alt="Home" border="0" src="../gifs/txthome.gif" /></a></td><td align="right" valign="top" width="228"><a href="ch12_02.html"><img alt="Next" border="0" src="../gifs/txtnexta.gif" /></a></td></tr><tr><td align="left" valign="top" width="228">11.5. Microsoft Windows</td><td align="center" valign="top" width="228"><a href="index/index.html"><img alt="Book Index" border="0" src="../gifs/index.gif" /></a></td><td align="right" valign="top" width="228">12.2. Task-Specific Troubleshooting</td></tr></table><div>
<hr width="684" align="left" />

<img alt="Library Navigation Links" border="0" src="../gifs/navbar.gif" usemap="#library-map" />
<p><font size="-1"><a href="copyrght.html">Copyright &copy; 2002</a> O'Reilly &amp; Associates. All rights reserved.</font></p>

<map name="library-map"><area shape="rect" coords="1,0,84,90" href="../index.html" /><area shape="rect" coords="86,-7,176,90" href="../ssh/index.html" /><area shape="rect" coords="178,0,265,101" href="../tcp/index.html" /><area shape="rect" coords="266,0,333,90" href="../nfs/index.html" /><area shape="rect" coords="334,-1,429,93" href="../snmp/index.html" /><area shape="rect" coords="431,0,529,116" href="index.html" /><area shape="rect" coords="534,0,594,104" href="../dns/index.html" /><area shape="rect" coords="595,1,704,108" href="../fire/index-2.html" /></map>

</div></div></div></div></body>
<!-- Mirrored from nnc3.com/mags/Networking2/tshoot/ch12_01.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 28 Jul 2017 17:55:00 GMT -->
</html>