<html>
<!-- Mirrored from nnc3.com/mags/Networking2/tshoot/ch08_06.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 28 Jul 2017 17:57:14 GMT -->
<head><title>Microsoft Windows (Network Troubleshooting Tools)</title><link rel="stylesheet" type="text/css" href="../style/style1.css" />

<meta name="DC.Creator" content="Joseph D. Sloan" /><meta name="DC.Format" content="text/xml" scheme="MIME" /><meta name="DC.Language" content="en-US" /><meta name="DC.Publisher" content="O'Reilly &amp; Associates, Inc." /><meta name="DC.Source" scheme="ISBN" content="059600186XL" /><meta name="DC.Subject.Keyword" content="stuff" /><meta name="DC.Title" content="Network Troubleshooting Tools" /><meta name="DC.Type" content="Text.Monograph" />

</head><body bgcolor="#ffffff">

<img alt="Book Home" border="0" src="gifs/smbanner.gif" usemap="#banner-map" /><map name="banner-map"><area shape="rect" coords="1,-2,616,66" href="index.html" alt="Network Troubleshooting Tools" /><area shape="rect" coords="629,-11,726,25" href="jobjects/fsearch.html" alt="Search this book" /></map>

<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch08_05.html"><img alt="Previous" border="0" src="../gifs/txtpreva.gif" /></a></td><td align="center" valign="top" width="228"><a href="index.html"></a></td><td align="right" valign="top" width="228"><a href="ch09_01.html"><img alt="Next" border="0" src="../gifs/txtnexta.gif" /></a></td></tr></table><div>



<h2 class="sect1">8.6. Microsoft Windows</h2>

<a name="INDEX-2202" /><a name="INDEX-2203" /><a name="INDEX-2204" /><a name="INDEX-2205" /><a name="INDEX-2206" />Apart from
the basic text-based tools such as <em class="filename">netstat</em>,
Microsoft doesn't really include many useful utilities with the
consumer versions of Windows. But if you are using Windows NT or
Windows 2000, you have more options. The <em class="filename">netmon</em>
tool is included with the server versions. A brief description of how
this tool can be used to capture traffic was included in <a href="ch05_01.html">Chapter 5, "Packet Capture"</a>. <em class="filename">netmon</em> can also be used
to capture basic traffic information.
</p>

<a name="INDEX-2207" /><a name="INDEX-2208" /><a name="INDEX-2209" /><a name="INDEX-2210" /><a href="ch08_06.html#nettroubletools-CHP-8-FIG-9">Figure 8-9</a> shows <em class="filename">netmon</em>'s
basic capture screen. The upper-left pane shows five basic graphs for
real-time traffic -- network utilization, frames per second, bytes
per second, broadcasts per second, and multicasts per second. The
second pane on the left lists current connections between this and
other hosts. The details of these connections are provided in the
bottom pane. The pane on the right gives overall network statistics.
To use <em class="filename">netmon</em> in this fashion, just start the
program and select Capture <img alt="Figure 8.6" src="figs/U2192.gif" /> Start. In standalone mode,
<em class="filename">netmon</em> functions as a point-monitoring tool, but
as noted in <a href="ch05_01.html">Chapter 5, "Packet Capture"</a>, it can be used with agents
to collect traffic throughout the network.
</p>

<a name="nettroubletools-CHP-8-FIG-9" /><div class="figure"><img height="314" alt="Figure 8-9" src="figs/ntt_0809.gif" width="460" /></div><h4 class="objtitle">Figure 8-9. netmon traffic monitoring</h4>

<a name="INDEX-2211" /><a name="INDEX-2212" /><a name="INDEX-2213" /><a name="INDEX-2214" /><a name="INDEX-2215" /><a name="INDEX-2216" />For general systems monitoring,
<em class="filename">perfmon</em> (Performance Monitor) is a better
choice. It is also supplied with both the workstation and server
versions. <em class="filename">perfmon</em> is a general
performance-monitoring tool, not just a network-monitoring tool. You
can use it to measure system performance (including CPU utilization)
and I/O performance, as well as basic network performance. If
appropriately configured, it will also monitor remote machines.
</p>

<a name="INDEX-2217" />Data
collected is organized by object type, e.g., groups of counters. For
example, with the UDP object, there are counters for the number of
datagrams sent per second, datagrams received per second, datagrams
received errors, etc. For network monitoring, the most interesting
objects include ICMP, IP, Network Interface, RAS Ports, RAS Total,
TCP, and UDP.
</p>

<em class="filename">perfmon</em><a name="INDEX-2218" /><a name="INDEX-2219" /><a name="INDEX-2220" /><a name="INDEX-2221" />
provides four views -- alert, chart, log, and report. With alert
view you can set a threshold and be notified when a counter exceeds
or drops below it. Chart view gives a real-time graph for selected
counters. You can customize the sampling rate and scale. Log view
logs all the counters for an object to a file periodically. Finally,
report view displays numerical values in a window for selected
counters. Each view is independent of the others. <a href="ch08_06.html#nettroubletools-CHP-8-FIG-10">Figure 8-10</a> shows the process of adding a monitored object
to the chart view for the Windows NT version.
</p>

<a name="nettroubletools-CHP-8-FIG-10" /><div class="figure"><img height="324" alt="Figure 8-10" src="figs/ntt_0810.gif" width="460" /></div><h4 class="objtitle">Figure 8-10. Windows NT perfmon</h4>

The Windows 2000 version has received a slight face-lift but seems to
be the same basic program. <em class="filename">perfmon</em> can be
particularly useful if you aren't sure whether you have a host
problem or a network problem. Both <em class="filename">netmon</em> and
<em class="filename">perfmon</em> are described in the Windows help files
as well as several books described in <a href="appb_01.html">Appendix B, "Resources and References"</a>.
</p>

<a name="nettroubletools-CHP-8-SECT-6.1" /><div class="sect2">
<h3 class="sect2">8.6.1. ntop, mrtg, and cricket on Windows</h3>

<a name="INDEX-2222" /><a name="INDEX-2223" /><a name="INDEX-2224" />All
three major packages described in this
chapter -- <em class="filename">ntop</em>, <em class="filename">mrtg</em>,
and <em class="filename">cricket</em> -- are available for Windows
systems.
</p>

The developers of <em class="filename">ntop</em> have provided you with
two choices. You can compile it yourself for free. Both the Unix and
Windows versions share the same source tree. Or, if you can't
easily compile it, you can buy a precompiled binary directly from
them. Since <em class="filename">ntop</em> is basically a point-monitoring
tool, you'll likely want to run it on multiple machines if you
have a switched network or multiple subnetworks.
</p>

<a name="INDEX-2225" /><a name="INDEX-2226" />Since <em class="filename">mrtg</em> and
<em class="filename">cricket</em> are primarily written in Perl, it is not
surprising that they will run under Windows. You'll find
<em class="filename">mrtg</em> fairly straightforward to set up. While
<em class="filename">cricket</em> is said to work, at the time this was
written there were no published directions on how to set it up, and
the Unix directions don't generalize well.
</p>

<a name="INDEX-2227" /><a name="INDEX-2228" /><a name="INDEX-2229" />Setting up <em class="filename">mrtg</em> for
Windows is not that different from setting it up under Unix. To get
<em class="filename">mrtg</em> running, you'll need to download a
copy of <em class="filename">mrtg</em> with the binary for
<em class="filename">rateup</em>. This was included with the copy of
<em class="filename">mrtg</em> I downloaded, but the
<em class="filename">mrtg</em> web page for NT has a separate link should
you need it. You will need a copy of Perl along with anything else
you may need to get Perl running. The <em class="filename">mrtg</em> site
has links to the Active Perl site. Installing Active Perl requires an
updated version of the Windows Installer, available at their site.
You'll need to provide some mechanism for running
<em class="filename">mrtg</em> on a regular basis. The file
<em class="filename">fiveminute.zip</em> provided a program to add
<em class="filename">mrtg</em> to the Windows NT scheduler. Finally,
you'll want to provide some mechanism to view the output from
<em class="filename">mrtg</em>. This could be a web server or, at a
minimum, a web browser.
</p>

Once you have unpacked everything, you'll need to edit the
<em class="filename">mrtg</em> script so that NT rather than Unix is the
operating system. This amounts to commenting out the fourth line of
the script and uncommenting the fifth:
</p>

<blockquote><pre class="code">#$main::OS = 'UNIX';
$main::OS = 'NT';</pre></blockquote>

Also, make sure <em class="filename">rateup</em> is in the same directory
as <em class="filename">mrtg</em>.
</p>

<a name="INDEX-2230" /><a name="INDEX-2231" /><a name="INDEX-2232" />Creating the configuration file and
running the script is basically the same as with the Unix version.
You'll want to run <em class="filename">cfgmaker</em> and
<em class="filename">indexmaker</em>. And, as with the Unix version,
you'll need to edit the configuration file to set
<em class="filename">WorkDir :.</em> You will need to invoke Perl
explicitly and use explicit paths with these scripts. For example,
here are the commands to run <em class="filename">indexmaker</em> and
<em class="filename">mrtg</em> on my system:
</p>

<blockquote><pre class="code">D:\mrtg\run&gt;perl d:\mrtg\run\indexmaker d:\mrtg\run\mrtg.cfg &gt; d:\apache\htdocs\mrtg
D:\mrtg\run&gt;perl d:\mrtg\run\mrtg d:\mrtg\run\mrtg.cfg</pre></blockquote>

On my system, <em class="filename">D:\mrtg\run</em> is the directory where
<em class="filename">mrtg</em> is installed and
<em class="filename">D:\apache\htdocs\mrtg</em> is where the output is put
so it can be accessed by the web server.
</p>

Finally, you'll need to make some provision to run
<em class="filename">mrtg</em> periodically. As noted, you can use
supplied code to add it to the scheduler. Alternately, you can edit
the configuration file to have it run as a daemon. For example, you
could add the following to your configuration file:
</p>

<blockquote><pre class="code">RunAsDaemon: yes
Interval: 5</pre></blockquote>

You'll want to add <em class="filename">mrtg</em> to the startup
group so that it will be run automatically each time the system is
rebooted.
</p>

</div>
<a name="nettroubletools-CHP-8-SECT-6.2" /><div class="sect2">
<h3 class="sect2">8.6.2. getif revisited</h3>

<a name="INDEX-2233" /><a name="INDEX-2234" /><a name="INDEX-2235" /><a name="INDEX-2236" /><a name="INDEX-2237" /><a name="INDEX-2238" /><a name="INDEX-2239" /><a name="INDEX-2240" />In <a href="ch07_01.html">Chapter 7, "Device Monitoring with SNMP"</a>, we
introduced <em class="filename">getif</em> but did not discuss the graph
tab. Basically, the graph tab provides for two types of
graphs -- graphs of ping round-trip delays and graphs of SNMP
objects. The latter allows us to use <em class="filename">getif</em> as a
traffic-monitoring tool.
</p>

<a name="INDEX-2241" />Graphing SNMP objects is a three-step
process. First, you'll need to go back to the Parameters tab
and identify the remote system and set its SNMP community strings.
Next, you'll need to visit the MBrowser tab and select the
objects you want to graph. Locate the objects of interest by working
your way down the MIB tree in the large pane on the upper left of the
window. Visit the object by clicking the Walk button. The object and
its value should be added to the large lower pane. Finally, select
the item from the large pane and click on the Add to Graph button.
(Both of these tabs were described in <a href="ch07_01.html">Chapter 7, "Device Monitoring with SNMP"</a>.)
</p>

You can now go to the Graph tab. Each of the selected variables
should have been added to the legend to the right of the chart. You
can begin collecting data by clicking on the Start button. <a href="ch08_06.html#nettroubletools-CHP-8-FIG-11">Figure 8-11</a> shows one such graph.
</p>

<a name="nettroubletools-CHP-8-FIG-11" /><div class="figure"><img height="270" alt="Figure 8-11" src="figs/ntt_0811.gif" width="481" /></div><h4 class="objtitle">Figure 8-11. getif graph</h4>

The controls along the bottom of the page provide some control over
the appearance of the chart and over the sampling rate.<a name="INDEX-2242" /><a name="INDEX-2243" /><a name="INDEX-2244" /><a name="INDEX-2245" /><a name="INDEX-2246" />
</p>

</div>


<hr width="684" align="left" />
<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch08_05.html"><img alt="Previous" border="0" src="../gifs/txtpreva.gif" /></a></td><td align="center" valign="top" width="228"><a href="index.html"><img alt="Home" border="0" src="../gifs/txthome.gif" /></a></td><td align="right" valign="top" width="228"><a href="ch09_01.html"><img alt="Next" border="0" src="../gifs/txtnexta.gif" /></a></td></tr><tr><td align="left" valign="top" width="228">8.5. RMON</td><td align="center" valign="top" width="228"><a href="index/index.html"><img alt="Book Index" border="0" src="../gifs/index.gif" /></a></td><td align="right" valign="top" width="228">9. Testing Connectivity Protocols</td></tr></table><div>
<hr width="684" align="left" />

<img alt="Library Navigation Links" border="0" src="../gifs/navbar.gif" usemap="#library-map" />
<p><font size="-1"><a href="copyrght.html">Copyright &copy; 2002</a> O'Reilly &amp; Associates. All rights reserved.</font></p>

<map name="library-map"><area shape="rect" coords="1,0,84,90" href="../index.html" /><area shape="rect" coords="86,-7,176,90" href="../ssh/index.html" /><area shape="rect" coords="178,0,265,101" href="../tcp/index.html" /><area shape="rect" coords="266,0,333,90" href="../nfs/index.html" /><area shape="rect" coords="334,-1,429,93" href="../snmp/index.html" /><area shape="rect" coords="431,0,529,116" href="index.html" /><area shape="rect" coords="534,0,594,104" href="../dns/index.html" /><area shape="rect" coords="595,1,704,108" href="../fire/index-2.html" /></map>

</body>
<!-- Mirrored from nnc3.com/mags/Networking2/tshoot/ch08_06.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 28 Jul 2017 17:57:15 GMT -->
</html>