<html>
<!-- Mirrored from nnc3.com/mags/Networking2/tshoot/ch05_06.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 28 Jul 2017 17:57:04 GMT -->
<head><title>Packet Analyzers (Network Troubleshooting Tools)</title><link rel="stylesheet" type="text/css" href="../style/style1.css" />

<meta name="DC.Creator" content="Joseph D. Sloan" /><meta name="DC.Format" content="text/xml" scheme="MIME" /><meta name="DC.Language" content="en-US" /><meta name="DC.Publisher" content="O'Reilly &amp; Associates, Inc." /><meta name="DC.Source" scheme="ISBN" content="059600186XL" /><meta name="DC.Subject.Keyword" content="stuff" /><meta name="DC.Title" content="Network Troubleshooting Tools" /><meta name="DC.Type" content="Text.Monograph" />

</head><body bgcolor="#ffffff">

<img alt="Book Home" border="0" src="gifs/smbanner.gif" usemap="#banner-map" /><map name="banner-map"><area shape="rect" coords="1,-2,616,66" href="index.html" alt="Network Troubleshooting Tools" /><area shape="rect" coords="629,-11,726,25" href="jobjects/fsearch.html" alt="Search this book" /></map>

<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch05_05.html"><img alt="Previous" border="0" src="../gifs/txtpreva.gif" /></a></td><td align="center" valign="top" width="228"><a href="index.html"></a></td><td align="right" valign="top" width="228"><a href="ch05_07.html"><img alt="Next" border="0" src="../gifs/txtnexta.gif" /></a></td></tr></table><div>



<h2 class="sect1">5.6. Packet Analyzers</h2>

<a name="INDEX-1189" /><a name="INDEX-1190" />Even with the tools just described, the
real limitation with <em class="filename">tcpdump</em> is interpreting the
data. For many uses, <em class="filename">tcpdump</em> may be all you
need. But if you want to examine the data within packets, a packet
sniffer is not enough. You need a packet analyzer. A large number of
packet analyzers are available at tremendous prices. But before you
start spending money, you should consider
<em class="filename">ethereal</em>.
</p>

<a name="nettroubletools-CHP-5-SECT-6.1" /><div class="sect2">
<h3 class="sect2">5.6.1. ethereal</h3>

<em class="filename">ethereal</em><a name="INDEX-1191" /><a name="INDEX-1192" /><a name="INDEX-1193" /><a name="INDEX-1194" /> is
available both as an X Windows program for Unix systems and as a
Microsoft Windows program. It can be used as a capture tool and as an
analysis tool. It uses the same capture engine and file format as
<em class="filename">tcpdump,</em> so you can use the same filter syntax
when capturing traffic, and you can use <em class="filename">ethereal</em>
to analyze <em class="filename">tcpdump</em> files. Actually,
<em class="filename">ethereal</em> supports two types of filters, capture
filters based on <em class="filename">tcpdump</em> and display filters
used to control what you are looking at. Display filters use a
different syntax and are described later in this section.
</p>

<a name="nettroubletools-CHP-5-SECT-6.1.1" /><div class="sect3">
<h3 class="sect3">5.6.1.1. Using ethereal</h3>

<a name="INDEX-1195" />Usually <em class="filename">ethereal</em> will
be managed entirely from a windowing environment. While it can be run
with command-line options, I've never encountered a use for
these. (There is also a text-based version,
<em class="filename">tethereal</em>.) When you run
<em class="filename">ethereal</em>, you are presented with a window with
three initially empty panes. The initial screen is similar to <a href="ch05_06.html#nettroubletools-CHP-5-FIG-1">Figure 5-1</a> except the panes are empty. (These figures are
for the Windows implementation of <em class="filename">ethereal</em>, but
these windows are almost identical to the Unix version.) If you have
a file you want to analyze, you can select File <img alt="Figure 5.6.1.1" src="figs/U2192.gif" /> Open. You can
either load a <em class="filename">tcpdump</em> file created with the
<em class="filename">-w</em> option or a file previously saved from
<em class="filename">ethereal</em>.
</p>

<a name="nettroubletools-CHP-5-FIG-1" /><div class="figure"><img height="346" alt="Figure 5-1" src="figs/ntt_0501.gif" width="481" /></div><h4 class="objtitle">Figure 5-1. ethereal</h4>

<a name="INDEX-1196" /><a name="INDEX-1197" /><a name="INDEX-1198" /><a name="INDEX-1199" /><a name="INDEX-1200" /><a name="INDEX-1201" /><a name="INDEX-1202" /><a name="INDEX-1203" /><a name="INDEX-1204" /><a name="INDEX-1205" /><a name="INDEX-1206" /><a name="INDEX-1207" /><a name="INDEX-1208" />To capture data, select Capture <img alt="Figure 5.6.1.1" src="figs/U2192.gif" />
Start. You will be presented with a Capture Preferences screen like
the one shown in <a href="ch05_06.html#nettroubletools-CHP-5-FIG-2">Figure 5-2</a>. If you have multiple
interfaces, you can select which one you want to use with the first
field. The Count: field is used to limit the number of packets you
will collect. You can enter a capture filter, using
<em class="filename">tcpdump</em> syntax, in the Filter: field. If you
want your data automatically saved to a file, enter that in the File:
field. The fifth field allows you to limit the number of bytes you
collect from the packet. This can be useful if you are interested
only in header information and want to keep your files small. The
first of the four buttons allows you to switch between promiscuous
and nonpromiscuous mode. With the latter, you'll collect only
traffic sent to or from your machine rather than everything your
machine sees. Select the second button if you want to see traffic as
it is captured. The third button selects automatic scrolling.
Finally, the last button controls name resolution. Name resolution
really slows <em class="filename">ethereal</em> down. Don't enable
name resolution if you are going to display packets in real time!
Once you have everything set, click on OK to begin capturing data.
</p>

<a name="nettroubletools-CHP-5-FIG-2" /><div class="figure"><img height="285" alt="Figure 5-2" src="figs/ntt_0502.gif" width="214" /></div><h4 class="objtitle">Figure 5-2. ethereal Capture Preferences</h4>

<a name="INDEX-1209" /><a name="INDEX-1210" />While you are capturing traffic,
<em class="filename">ethereal</em> will display a Capture window that will
give you counts for the packets captured in real time. This window is
shown in <a href="ch05_06.html#nettroubletools-CHP-5-FIG-3">Figure 5-3</a>. If you didn't say how
many frames you wanted to capture on the last screen, you can use the
Stop button to end capture.
</p>

<a name="nettroubletools-CHP-5-FIG-3" /><div class="figure"><img height="230" alt="Figure 5-3" src="figs/ntt_0503.gif" width="141" /></div><h4 class="objtitle">Figure 5-3. ethereal Capture</h4>

<a name="INDEX-1211" /><a name="INDEX-1212" /><a name="INDEX-1213" /><a name="INDEX-1214" /><a name="INDEX-1215" />Once you have finished capturing
data, you'll want to go back to the main screen shown in <a href="ch05_06.html#nettroubletools-CHP-5-FIG-1">Figure 5-1</a>. The top pane displays a list of the captured
packets. The lower panes display information for the packet selected
in the top pane. The packet to be dissected is selected in the top
pane by clicking on it. The second pane then displays a protocol tree
for the packet, while the bottom pane displays the raw data in hex
and ASCII. The layout of <em class="filename">ethereal</em> is shown in
<a href="ch05_06.html#nettroubletools-CHP-5-FIG-1">Figure 5-1</a>. You'll probably want to scroll
through the top pane until you find the traffic of interest. Once you
have selected a packet, you can resize the windows as needed.
Alternately, you can select Display <img alt="Figure 5.6.1.1" src="figs/U2192.gif" /> Show Packet in New Window
to open a separate window, allowing you to open several packets at
once.
</p>

<a name="INDEX-1216" /><a name="INDEX-1217" />The protocol tree basically
displays the structure of the packet by analyzing the data and
determining the header type and decoding accordingly. Fields can be
expanded or collapsed by clicking on the plus or minus next to the
field, respectively. In the figure, the Internet Protocol header has
been expanded and the Type-Of-Service (TOS) field in turn has been
expanded to show the various values of the TOS flags. Notice that the
raw data for the field selected in the second pane is shown in bold
in the bottom pane. This works well for most protocols, but if you
are using some unusual protocol, like other programs,
<em class="filename">ethereal</em> will not know what to do with it.
</p>

<em class="emphasis">ethereal</em><a name="INDEX-1218" /><a name="INDEX-1219" /><a name="INDEX-1220" /><a name="INDEX-1221" /><a name="INDEX-1222" />
has several other useful features. For example, you can select a TCP
packet from the main pane and then select Tools <img alt="Figure 5.6.1.1" src="figs/U2192.gif" /> Follow TCP
Stream. This tool collects information from all the packets in the
TCP session and displays the information. Unfortunately, while
convenient at times, this feature makes it just a little too easy to
capture passwords or otherwise invade users' privacy.
</p>

<a name="INDEX-1223" />The Tools <img alt="Figure 5.6.1.1" src="figs/U2192.gif" /> Summary gives you
the details for data you are looking at. An example is shown in <a href="ch05_06.html#nettroubletools-CHP-5-FIG-4">Figure 5-4</a>. 
</p>

<a name="nettroubletools-CHP-5-FIG-4" /><div class="figure"><img height="393" alt="Figure 5-4" src="figs/ntt_0504.gif" width="234" /></div><h4 class="objtitle">Figure 5-4. ethereal Summary</h4>

There are a number of additional features that I haven't gone
into here. But what I described here is more than enough for most
simple tasks.
</p>

</div>

<a name="nettroubletools-CHP-5-SECT-6.1.2" /><div class="sect3">
<h3 class="sect3">5.6.1.2. Display filters</h3>

<a name="INDEX-1224" /><a name="INDEX-1225" /><a name="INDEX-1226" />Display filters allow you to
selectively display data that has been captured. At the bottom of the
window shown in <a href="ch05_06.html#nettroubletools-CHP-5-FIG-1">Figure 5-1</a>, there is a box for
creating display filters. As previously noted, display filters have
their own syntax. The <em class="filename">ethereal</em> documentation
describes this syntax in great detail. In this case, I have entered
<em class="emphasis">http</em> to limit the displayed traffic to web
traffic. I could just as easily enter any number of other different
protocols -- <em class="filename">ip</em>, <em class="filename">udp</em>,
<em class="filename">icmp</em>, <em class="filename">arp</em>,
<em class="filename">dns</em>, etc.
</p>

The real power of <em class="filename">ethereal </em>'s display
filters comes when you realize that you don't really need to
understand the syntax of display filters to start using them. You can
select a field from the center pane and then select Display <img alt="Figure 5.6.1.2" src="figs/U2192.gif" />
Match Selected, and <em class="filename">ethereal</em> will construct and
apply the filter for you. Of course, not every field is useful, but
it doesn't take much practice to see what works and what
doesn't work.
</p>

<a name="INDEX-1227" /><a name="INDEX-1228" /><a name="INDEX-1229" />The primary limitation of this approach
comes in constructing compound filters. If you want to capture all
the traffic to or from a computer, you won't be able to match a
single field. But you should be able to discover the syntax for each
of the pieces. Once you know that
<tt class="literal">ip.src==205.153.63.30</tt> matches all IP traffic with
<em class="filename">205.153.63.30</em> as its source and that
<tt class="literal">ip.dst==205.153.63.30</tt> matches all IP traffic to
<em class="filename">205.153.63.30</em>, it isn't difficult to come
up with the filter you need, <tt class="literal">ip.src==205.153.63.30</tt>
or <tt class="literal">ip.dst==205.153.63.30</tt>. Display filters are
really very intuitive, so you should have little trouble learning how
to use them.
</p>

Perhaps more than any other tool described in this book,
<em class="filename">ethereal</em> is constantly being changed and
improved. While this book was being written, new versions were
appearing at the rate of about once a month. So you should not be
surprised if <em class="filename">ethereal</em> looks a little different
from what is described here. Fortunately,
<em class="filename">ethereal</em> is a well-developed program that is
very intuitive to use. You should have little trouble going on from
here.<a name="INDEX-1230" /><a name="INDEX-1231" /><a name="INDEX-1232" /> 
</p>

</div>
</div>


<hr width="684" align="left" />
<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch05_05.html"><img alt="Previous" border="0" src="../gifs/txtpreva.gif" /></a></td><td align="center" valign="top" width="228"><a href="index.html"><img alt="Home" border="0" src="../gifs/txthome.gif" /></a></td><td align="right" valign="top" width="228"><a href="ch05_07.html"><img alt="Next" border="0" src="../gifs/txtnexta.gif" /></a></td></tr><tr><td align="left" valign="top" width="228">5.5. Analysis Tools</td><td align="center" valign="top" width="228"><a href="index/index.html"><img alt="Book Index" border="0" src="../gifs/index.gif" /></a></td><td align="right" valign="top" width="228">5.7. Dark Side of Packet Capture</td></tr></table><div>
<hr width="684" align="left" />

<img alt="Library Navigation Links" border="0" src="../gifs/navbar.gif" usemap="#library-map" />
<p><font size="-1"><a href="copyrght.html">Copyright &copy; 2002</a> O'Reilly &amp; Associates. All rights reserved.</font></p>

<map name="library-map"><area shape="rect" coords="1,0,84,90" href="../index.html" /><area shape="rect" coords="86,-7,176,90" href="../ssh/index.html" /><area shape="rect" coords="178,0,265,101" href="../tcp/index.html" /><area shape="rect" coords="266,0,333,90" href="../nfs/index.html" /><area shape="rect" coords="334,-1,429,93" href="../snmp/index.html" /><area shape="rect" coords="431,0,529,116" href="index.html" /><area shape="rect" coords="534,0,594,104" href="../dns/index.html" /><area shape="rect" coords="595,1,704,108" href="../fire/index-2.html" /></map>

</body>
<!-- Mirrored from nnc3.com/mags/Networking2/tshoot/ch05_06.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 28 Jul 2017 17:57:05 GMT -->
</html>