<html>
<!-- Mirrored from nnc3.com/mags/Networking2/tshoot/ch02_03.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 28 Jul 2017 17:57:02 GMT -->
<head><title>Microsoft Windows (Network Troubleshooting Tools)</title><link rel="stylesheet" type="text/css" href="../style/style1.css" />

<meta name="DC.Creator" content="Joseph D. Sloan" /><meta name="DC.Format" content="text/xml" scheme="MIME" /><meta name="DC.Language" content="en-US" /><meta name="DC.Publisher" content="O'Reilly &amp; Associates, Inc." /><meta name="DC.Source" scheme="ISBN" content="059600186XL" /><meta name="DC.Subject.Keyword" content="stuff" /><meta name="DC.Title" content="Network Troubleshooting Tools" /><meta name="DC.Type" content="Text.Monograph" />

</head><body bgcolor="#ffffff">

<img alt="Book Home" border="0" src="gifs/smbanner.gif" usemap="#banner-map" /><map name="banner-map"><area shape="rect" coords="1,-2,616,66" href="index.html" alt="Network Troubleshooting Tools" /><area shape="rect" coords="629,-11,726,25" href="jobjects/fsearch.html" alt="Search this book" /></map>

<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch02_02.html"><img alt="Previous" border="0" src="../gifs/txtpreva.gif" /></a></td><td align="center" valign="top" width="228"><a href="index.html"></a></td><td align="right" valign="top" width="228"><a href="ch03_01.html"><img alt="Next" border="0" src="../gifs/txtnexta.gif" /></a></td></tr></table><div>



<h2 class="sect1">2.3. Microsoft Windows</h2>

<a name="INDEX-388" /><a name="INDEX-389" /><a name="INDEX-390" /><a name="INDEX-391" />Networking with Windows can be quite
complicated, since it may involve Microsoft's proprietary
enhancements. Fortunately, Microsoft's approach to TCP/IP is
pretty standard. As with Unix, you can approach the various versions
of Windows by looking at configuration parameters or by using
utilities to examine the current configuration. For the most part,
you won't be examining files directly under Windows, at least
for versions later than Windows for Workgroups. Rather, you'll
use the utilities that Windows provides. (There are exceptions. For
example, like Unix, Windows has <em class="filename">hosts,</em>
<em class="filename">protocol</em>, and <em class="filename">services</em>
files.)
</p>

<a name="INDEX-392" /><a name="INDEX-393" />If you are looking for basic information
quickly, Microsoft provides one of two programs for this purpose,
depending on which version of Windows you use. The utility
<em class="filename">winipcfg</em> is included with Windows 95/98. A
command-line program, <em class="filename">ipconfig</em>, is included with
Windows NT and Windows 2000 and in Microsoft's TCP/IP stack for
Windows for Workgroups. Both programs provide the same information.
<em class="filename">winipcfg</em> produces a pop-up window giving the
basic parameters such as the Ethernet address, the IP address, the
default route, the name server's address, and so on (see <a href="ch02_03.html#nettroubletools-CHP-2-FIG-2">Figure 2-2</a>). You can invoke the program by entering the
program name from <em class="emphasis">Run</em> on the start menu or in a
DOS window. The most basic parameters will be displayed. Additional
information can be obtained by using the <em class="filename">/all</em>
option or by clicking on the More Info<em class="filename"> &gt;&gt;</em>
button.
</p>

<a name="nettroubletools-CHP-2-FIG-2" /><div class="figure"><img height="364" alt="Figure 2-2" src="figs/ntt_0202.gif" width="295" /></div><h4 class="objtitle">Figure 2-2. winipcfg</h4>

For <em class="filename">ipconfig</em>, start a DOS window. You can use
the command switch <em class="filename">/all</em> to get the additional
details.
</p>

<a name="INDEX-394" /><a name="INDEX-395" /><a name="INDEX-396" />As in Unix, the utilities
<em class="filename">arp</em>, <em class="filename">hostname</em>, and
<em class="filename">netstat</em> are available. All require a DOS window
to run. There are a few differences in syntax, but they work
basically the same way and provide the same sorts of information. For
example, <em class="filename">arp -a</em> will list all the entries in the
ARP table:
</p>

<blockquote><pre class="code">C:\&gt;arp -a

Interface: 205.153.63.30 on Interface 2
  Internet Address      Physical Address      Type
  205.153.63.1          00-00-a2-c6-28-44     dynamic
  205.153.63.239        00-60-97-06-22-22     dynamic</pre></blockquote>

<a name="INDEX-397" />The command <em class="filename">netstat
-r</em> gives the computer's routing table:
</p>

<blockquote><pre class="code">C:\&gt;netstat -r

Route Table
===========================================================================
Interface List
0x1 ........................... MS TCP Loopback interface
0x2 ...00 10 5a a1 e9 08 ...... 3Com 3C90x Ethernet Adapter
0x3 ...00 00 00 00 00 00 ...... NdisWan Adapter
===========================================================================
===========================================================================
Active Routes:
Network Destination        Netmask          Gateway       Interface  Metric
          0.0.0.0          0.0.0.0     205.153.63.1   205.153.63.30       1
        127.0.0.0        255.0.0.0        127.0.0.1       127.0.0.1       1
     205.153.63.0    255.255.255.0    205.153.63.30   205.153.63.30       1
    205.153.63.30  255.255.255.255        127.0.0.1       127.0.0.1       1
   205.153.63.255  255.255.255.255    205.153.63.30   205.153.63.30       1
        224.0.0.0        224.0.0.0    205.153.63.30   205.153.63.30       1
  255.255.255.255  255.255.255.255    205.153.63.30   205.153.63.30       1
===========================================================================

Active Connections

  Proto  Local Address          Foreign Address        State
  TCP    jsloan:1025            localhost:1028         ESTABLISHED
  TCP    jsloan:1028            localhost:1025         ESTABLISHED
  TCP    jsloan:1184            205.153.60.247:telnet  ESTABLISHED
  TCP    jsloan:1264            mail.lander.edu:pop3   TIME_WAIT</pre></blockquote>

As you can see, the format is a little different, but it supplies the
same basic information. (You can also use the command <em class="filename">route
print</em> to list the routing table.) You can use
<em class="filename">netstat -a</em> to get the active connections and
services. There really isn't an option that is analogous to
<em class="filename">-i</em> in Unix's <em class="filename">netstat</em>
(the option to display attached interfaces). For a listing of the
basic syntax and available commands, try <em class="filename">netstat
/?</em>.
</p>

<a name="INDEX-398" /><a name="INDEX-399" /><a name="INDEX-400" /><a name="INDEX-401" /><a name="INDEX-402" /><a name="INDEX-403" /><a name="INDEX-404" /><a name="INDEX-405" /><a name="INDEX-406" /><a name="INDEX-407" />While Windows does not provide
<em class="filename">ps</em>, both Windows NT and Windows 2000 provide the
Task Manager (<em class="filename">taskmgr.exe</em>), a utility that can
be used to see or control what is running. If you have the Windows
Resource Kit, three additional utilities, process viewer
(<em class="filename">pviewer.exe</em>), process explode
(<em class="filename">pview.exe</em>), and process monitor
(<em class="filename">pmon.exe</em>), are worth looking at. All four can
be started by entering their names at Start <img alt="Figure 2.3" src="figs/U2192.gif" /> Run. The Task
Manager can also be started by pressing Ctrl-Alt-Delete and selecting
Task Manager from the menu or by right-clicking on a vacant area on
the task bar at the bottom of the screen and selecting Task Manger
from the menu.
</p>

You won't need NT's administrator privileges to use the
DOS-based commands just described. If you want to reconfigure the
system or if you need additional details, you will need to turn to
the utilities provided by Windows. For NT, this will require
administrator privileges. (You'll also need administrative
privileges to make changes with <em class="filename">arp</em> or
<em class="filename">route</em>.) This is available from Start <img alt="Figure 2.3" src="figs/U2192.gif" />
Settings <img alt="Figure 2.3" src="figs/U2192.gif" /> Control Panel <img alt="Figure 2.3" src="figs/U2192.gif" /> Network or by following a
similar path from My Computer. Select the appropriate tab and fields
as needed.
</p>

<a name="INDEX-408" /><a name="INDEX-409" /><a name="INDEX-410" />If
you are interested in port scanners, a number are available. I have
already mentioned that the <em class="filename">Chesapeake Port
Scanner</em> will run under Windows. Scan the Internet for
others.
</p>

<a name="INDEX-411" /><a name="INDEX-412" />Finally, for the really brave of
heart, you can go into the registry. But that's a subject for
another book. (See Paul Robichaux's <em class="emphasis">Managing the
Windows 2000 Registry</em> or Steven Thomas's
<em class="emphasis">Windows NT 4.0 Registry</em>.)<a name="INDEX-413" /><a name="INDEX-414" />
</p>



<hr width="684" align="left" />
<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch02_02.html"><img alt="Previous" border="0" src="../gifs/txtpreva.gif" /></a></td><td align="center" valign="top" width="228"><a href="index.html"><img alt="Home" border="0" src="../gifs/txthome.gif" /></a></td><td align="right" valign="top" width="228"><a href="ch03_01.html"><img alt="Next" border="0" src="../gifs/txtnexta.gif" /></a></td></tr><tr><td align="left" valign="top" width="228">2.2. System Configuration Files</td><td align="center" valign="top" width="228"><a href="index/index.html"><img alt="Book Index" border="0" src="../gifs/index.gif" /></a></td><td align="right" valign="top" width="228">3. Connectivity Testing</td></tr></table><div>
<hr width="684" align="left" />

<img alt="Library Navigation Links" border="0" src="../gifs/navbar.gif" usemap="#library-map" />
<p><font size="-1"><a href="copyrght.html">Copyright &copy; 2002</a> O'Reilly &amp; Associates. All rights reserved.</font></p>

<map name="library-map"><area shape="rect" coords="1,0,84,90" href="../index.html" /><area shape="rect" coords="86,-7,176,90" href="../ssh/index.html" /><area shape="rect" coords="178,0,265,101" href="../tcp/index.html" /><area shape="rect" coords="266,0,333,90" href="../nfs/index.html" /><area shape="rect" coords="334,-1,429,93" href="../snmp/index.html" /><area shape="rect" coords="431,0,529,116" href="index.html" /><area shape="rect" coords="534,0,594,104" href="../dns/index.html" /><area shape="rect" coords="595,1,704,108" href="../fire/index-2.html" /></map>

</body>
<!-- Mirrored from nnc3.com/mags/Networking2/tshoot/ch02_03.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 28 Jul 2017 17:57:03 GMT -->
</html>