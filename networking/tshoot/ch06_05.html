<html>
<!-- Mirrored from nnc3.com/mags/Networking2/tshoot/ch06_05.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 28 Jul 2017 17:57:05 GMT -->
<head><title>Mapping or Diagramming (Network Troubleshooting Tools)</title><link rel="stylesheet" type="text/css" href="../style/style1.css" />

<meta name="DC.Creator" content="Joseph D. Sloan" /><meta name="DC.Format" content="text/xml" scheme="MIME" /><meta name="DC.Language" content="en-US" /><meta name="DC.Publisher" content="O'Reilly &amp; Associates, Inc." /><meta name="DC.Source" scheme="ISBN" content="059600186XL" /><meta name="DC.Subject.Keyword" content="stuff" /><meta name="DC.Title" content="Network Troubleshooting Tools" /><meta name="DC.Type" content="Text.Monograph" />

</head><body bgcolor="#ffffff">

<img alt="Book Home" border="0" src="gifs/smbanner.gif" usemap="#banner-map" /><map name="banner-map"><area shape="rect" coords="1,-2,616,66" href="index.html" alt="Network Troubleshooting Tools" /><area shape="rect" coords="629,-11,726,25" href="jobjects/fsearch.html" alt="Search this book" /></map>

<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch06_04.html"><img alt="Previous" border="0" src="../gifs/txtpreva.gif" /></a></td><td align="center" valign="top" width="228"><a href="index.html"></a></td><td align="right" valign="top" width="228"><a href="ch06_06.html"><img alt="Next" border="0" src="../gifs/txtnexta.gif" /></a></td></tr></table><div>



<h2 class="sect1">6.5. Mapping or Diagramming</h2>

<a name="INDEX-1504" /><a name="INDEX-1505" /><a name="INDEX-1506" /><a name="INDEX-1507" /><a name="INDEX-1508" /><a name="INDEX-1509" />At this point, you should
have a good idea of how to find out what is on your network. The next
step is to put together a picture of how everything interconnects.
This is usually referred to as <em class="emphasis">mapping</em> but may
go by other names such as <em class="emphasis">network drawing</em>
or <em class="emphasis">diagramming</em>. This can be
absolutely essential if you are dealing with topology-related
problems.
</p>

A wide spectrum of approaches may be taken. At one extreme, you could
simply use the collected data and some standard drawing utility to
create your map. Clearly, some graphics software is better suited
than others for this purpose. For example, special icons for
different types of equipment are particularly nice. But almost any
software should be usable to a degree. I have even put together
passable diagrams using the drawing features in Microsoft Excel.
</p>

Manual diagramming is usually practical only for a single segment or
a very small network. But there might be times when this will be
desirable for larger networks -- for example, you may be preparing
graphics for a formal presentation. This, however, should be an
obvious exception, not a routine activity.
</p>

In the middle of the spectrum are programs that will both discover
and draw the network. When using tools with automatic discovery, you
will almost certainly want to clean up the graphics. It is extremely
hard to lay out a graph in an aesthetically pleasing manner when
doing it manually. You can forget about a computer doing a good job
automatically.
</p>

<a name="INDEX-1510" />Another closely related possibility is to
use scripting tools to update the files used by a graphing utility.
The graphic utility can then display the new or updated map with
little or no additional interaction. While this is a wonderful
learning opportunity, it really isn't a practical solution for
most people with real time constraints.
</p>

At the other extreme, mapping tools are usually part of more
comprehensive management packages. Automatic discovery is the norm
for these. Once the map is created, additional management
functions -- including basic monitoring to ensure that devices and
connections still work and to collect performance data -- are
performed.
</p>

Ideally, these programs will provide a full graphic display that is
automatically generated, includes every device on the network,
provides details of the nature and state of the devices, updates the
map in real time, and requires a minimum of user input. Some tools
are well along the path to this goal.
</p>

<a name="INDEX-1511" /><a name="INDEX-1512" />There are problems with automatic
discovery. First, you'll want to be careful when you specify
the networks to be analyzed and keep an eye on things whenever you
change this. It is not that uncommon to make an error and find that
you are mapping devices well beyond your network. And, as explained
later in this chapter, not everyone will be happy about this.
</p>

<a name="INDEX-1513" /><a name="INDEX-1514" /><a name="INDEX-1515" /><a name="INDEX-1516" /><a name="INDEX-1517" /><a name="INDEX-1518" /><a name="INDEX-1519" /><a name="INDEX-1520" />Also, many mapping programs do a poor job
of recognizing topology. For example, in a virtual LAN, a single
switch may be logically part of two different networks. Apart from
proprietary tools, don't expect many map programs to recognize
and handle these devices correctly. Each logical device may be drawn
as a separate device. If you are relying solely on ICMP ECHO_REQUEST
packets, unmanaged hubs and switches will not be recognized at all,
while managed hubs and switches will be drawn as just another device
on the network without any indication of the role they play in the
network topology.
</p>

<a name="INDEX-1521" /><a name="INDEX-1522" /><a name="INDEX-1523" /><a name="INDEX-1524" /><a name="INDEX-1525" /><a name="INDEX-1526" /><a name="INDEX-1527" /><a name="INDEX-1528" />Even
with automatic discovery, network mapping and management tools may
presuppose that you know the basic structure of your network. At a
minimum, you must know the address range for your network. It seems
very unlikely that a legitimate administrator would not have this
information. If for some bizarre reason you don't have this
information, you might begin by looking at the routing tables and NAT
tables in your router, DNS files, DHCP configurations, or Internic
registration information. You might also use
<em class="filename">traceroute</em> to identify intermediate segments and
routers.
</p>

<a name="nettroubletools-CHP-6-SECT-5.1" /><div class="sect2">
<h3 class="sect2">6.5.1. tkined</h3>

<a name="INDEX-1529" /><a name="INDEX-1530" /><a name="INDEX-1531" />An excellent example of a noncommercial,
open source mapping program is <em class="filename">tkined</em>. This is a
network editor that can be used as a standalone tool or as a
framework for an extensible network management system. At its
simplest, it can be used to construct a network diagram. <a href="ch06_05.html#nettroubletools-CHP-6-FIG-1">Figure 6-1</a> is an example of a simple network map that has
been constructed using <em class="filename">tkined</em> tools. (Actually,
as will be explained, this map was "discovered" rather
than drawn, but don't worry about this distinction for now.)
</p>

<a name="nettroubletools-CHP-6-FIG-1" /><div class="figure"><img height="284" alt="Figure 6-1" src="figs/ntt_0601.gif" width="460" /></div><h4 class="objtitle">Figure 6-1. A network map constructed with tkined</h4>

<a name="nettroubletools-CHP-6-SECT-5.1.1" /><div class="sect3">
<h3 class="sect3">6.5.1.1. Drawing maps with tkined</h3>

<a name="INDEX-1532" /><a name="INDEX-1533" />Manually drawing a map like this is fairly
straightforward, although somewhat tedious for all but the smallest
networks. You begin by starting <em class="filename">tkined</em> under an
X Window session. (This discussion assumes you are familiar with
using an X Window application.) You should see the menu bar across
the top window just under the titlebar, a toolbar to the left, and a
large, initially blank work area called the canvas.
</p>

To create a map, follow these steps:</p>

<ol><li>
<a name="INDEX-1534" /><a name="INDEX-1535" />Add the devices to the canvas. Begin
by clicking<a href="#FOOTNOTE-28">[28]</a> on the <em class="filename">machine icon</em>
on the toolbar on the left. This is the icon with the question mark
in the middle. With this tool selected, each time you click over the
canvas, a copy of this icon will be inserted on the canvas at the
cursor.
</p><blockquote class="footnote"> <a name="FOOTNOTE-28" />[28]Unless otherwise noted,
<em class="emphasis">clicking</em> means clicking with the left mouse
button.</p> </blockquote>

You can change the appearance of each of these icons to reflect the
type of device it represents. First, click on Select on the toolbar
(not Select on the menu). Next, select the icon or icons you want to
change. You select single icons by clicking on them. Multiple icons
can be selected by Shift-clicking on each in turn. As you select
devices, small boxes are displayed at the corners of the icon. Once
you have selected the icons of interest, go to the
<em class="filename">icon</em> pull-down menu and select the icon you want
from the appropriate submenu. Notice that the icon on the toolbar
changes. (You could make this change before inserting devices if you
wish and insert the selected icon that way.)
</p>
</li><li>
<a name="INDEX-1536" />Label each device. Right-click on each
device in turn. From the pop-up menu, select Edit All Attributes...,
enter the appropriate name and IP address for each device, and then
select Set Values. Once you have done this, right-click on the icon
again and select Label with Attribute..., select either name or
address depending on your preference, and then click on Accept.
</p>
</li><li>
<a name="INDEX-1537" />Add the networks. This is
done with the tool below the machine icon (the thick bar). Select
this tool by clicking on it. Click where you want the bar to begin on
the canvas. Move the mouse to where you want the network icon to end
and click a second time. You can label networks in the same way you
label nodes.
</p>
</li><li>
<a name="INDEX-1538" />Connect devices to the networks. You can
join devices to a network using the next tool on the toolbar, the
thin line with little boxes at either end. Select this tool, click on
the device you want to join to the network, and then click on the
appropriate network icon. As you move the mouse, a line from the icon
to the mouse pointer will be shown. When you click on the network,
the line should be attached to both the device and the network. If it
disappears, your aim was off. Try again.
</p>

At this point, you will probably want to rearrange your drawing to
tidy things up. You can move icons by dragging them with the middle
mouse button. (If your mouse doesn't have three buttons, try
holding down both the left and right buttons simultaneously.)
</p>
</li><li>
<a name="INDEX-1539" /><a name="INDEX-1540" /><a name="INDEX-1541" /><a name="INDEX-1542" /><a name="INDEX-1543" />Group devices and networks. This
allows you to collapse a subnet into a single icon. You can open
whichever subnets you need to work with at the moment and leave the
rest closed. For large networks, this is essential. Otherwise, the
map becomes too cluttered to use effectively.
</p>

<a name="INDEX-1544" />To combine devices, use the Select tool
to select the devices and the network. Then select Structure <img alt="Figure 6.5.1.1" src="figs/U2192.gif" />
Group. You can use this same menu to select Ungroup, Expand, and
Collapse for your groups. You can edit the group label as desired in
the previously discussed manner.
</p>
</li></ol>
</div>

<a name="nettroubletools-CHP-6-SECT-5.1.2" /><div class="sect3">
<h3 class="sect3">6.5.1.2. Autodiscovery with tkined</h3>

<a name="INDEX-1545" /><a name="INDEX-1546" /><a name="INDEX-1547" />For a
small network, manually drawing a diagram doesn't take very
long. But for large networks, this can be a very tedious process.
Fortunately, <em class="filename">tkined</em> provides tools for the
automatic discovery of nodes and the automatic layout of maps.
</p>

<a name="INDEX-1548" /><a name="INDEX-1549" />You
begin with Tools <img alt="Figure 6.5.1.2" src="figs/U2192.gif" /> IP-Discover. What this does is add the IP
Discover menu to the menu bar. The first two items on this menu are
Discover IP Network and Discover Route. These tools will attempt to
discover either the devices on a network or the routers along a path
to a remote machine. When one of these is selected, a pop-up box
queries you for the network number or remote device of interest.
Unfortunately, <em class="filename">tkined</em> seems to support only
class-based discovery, so you must specify a class B or a class C
address (although you can specify a portion of a class B network by
giving a class C style subnet address, e.g., 172.16.1.0). It also
tends to be somewhat unpredictable or quirky when trying to discover
multiple networks. If you are using subnets on a class B address,
what seems to work best is to run separate discovery sessions and
then cut and paste the results together. This is a little bit of a
nuisance, but it is not too bad. This was what was actually done to
create <a href="ch06_05.html#nettroubletools-CHP-6-FIG-1">Figure 6-1</a>.
</p>

<a href="ch06_05.html#nettroubletools-CHP-6-FIG-2">Figure 6-2</a> shows the output generated in
discovering a route across the network and one of the subnets for the
network shown in <a href="ch06_05.html#nettroubletools-CHP-6-FIG-1">Figure 6-1</a>. This window is
automatically created by <em class="filename">tkined</em> and shows its
progress during the discovery process. Note that it is sending out a
flood of ICMP ECHO_REQUEST packets in addition to the
<em class="filename">traceroute</em>-style discovery packets, the ICMP
network mask queries, and the SNMP queries shown here.
</p>

<a name="nettroubletools-CHP-6-FIG-2" /><div class="figure"><img height="305" alt="Figure 6-2" src="figs/ntt_0602.gif" width="424" /></div><h4 class="objtitle">Figure 6-2. Route and network discovery with tkined</h4>

<a name="INDEX-1550" /><a name="INDEX-1551" />If
you do end up piecing together a network map, other previously
discussed tools, such as <em class="filename">traceroute</em>, can be very
helpful. You might also want to look at your routing tables with
<em class="filename">netstat</em>.
</p>

<a name="INDEX-1552" /><a name="INDEX-1553" /><a name="INDEX-1554" /><a name="INDEX-1555" /><a name="INDEX-1556" />There
are a couple of problems in using <em class="filename">tkined</em>.
Foremost is the problem of getting everything installed correctly.
You will need to install <em class="filename">Tcl</em>, then
<em class="filename">Tk</em>, and then <em class="filename">scotty</em>.
<em class="filename">scotty</em> can be very particular about which
version of <em class="filename">Tcl</em> and <em class="filename">Tk</em> are
installed. You will also need to make sure everything is in the
default location or that the environmental variables are correctly
set. Fortunately, packages are available for some systems, such as
Linux, that take care of most of these details automatically. Also,
<em class="filename">tkined</em> will not warn you if you exit without
saving any changes you have made.<a name="INDEX-1557" /><a name="INDEX-1558" /><a name="INDEX-1559" /><a name="INDEX-1560" /><a name="INDEX-1561" /><a name="INDEX-1562" /> 
</p>

</div>
</div>


<hr width="684" align="left" />
<div class="navbar"><table width="684" border="0"><tr><td align="left" valign="top" width="228"><a href="ch06_04.html"><img alt="Previous" border="0" src="../gifs/txtpreva.gif" /></a></td><td align="center" valign="top" width="228"><a href="index.html"><img alt="Home" border="0" src="../gifs/txthome.gif" /></a></td><td align="right" valign="top" width="228"><a href="ch06_06.html"><img alt="Next" border="0" src="../gifs/txtnexta.gif" /></a></td></tr><tr><td align="left" valign="top" width="228">6.4. Scripts</td><td align="center" valign="top" width="228"><a href="index/index.html"><img alt="Book Index" border="0" src="../gifs/index.gif" /></a></td><td align="right" valign="top" width="228">6.6. Politics and Security</td></tr></table><div>
<hr width="684" align="left" />

<img alt="Library Navigation Links" border="0" src="../gifs/navbar.gif" usemap="#library-map" />
<p><font size="-1"><a href="copyrght.html">Copyright &copy; 2002</a> O'Reilly &amp; Associates. All rights reserved.</font></p>

<map name="library-map"><area shape="rect" coords="1,0,84,90" href="../index.html" /><area shape="rect" coords="86,-7,176,90" href="../ssh/index.html" /><area shape="rect" coords="178,0,265,101" href="../tcp/index.html" /><area shape="rect" coords="266,0,333,90" href="../nfs/index.html" /><area shape="rect" coords="334,-1,429,93" href="../snmp/index.html" /><area shape="rect" coords="431,0,529,116" href="index.html" /><area shape="rect" coords="534,0,594,104" href="../dns/index.html" /><area shape="rect" coords="595,1,704,108" href="../fire/index-2.html" /></map>

</body>
<!-- Mirrored from nnc3.com/mags/Networking2/tshoot/ch06_05.htm by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 28 Jul 2017 17:57:06 GMT -->
</html>